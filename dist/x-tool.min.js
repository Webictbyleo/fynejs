"use strict";const t=Array.isArray,e=WeakMap,i=queueMicrotask,n=function(){const n=Array.from,s=t,o=Object.keys,r=()=>{},c="style",h="display",f="none",l="tagName",a="TEMPLATE",u="length";let d=1;const y="undefined"!=typeof document?document:null,p="contents",m=["click","input","change","keydown","keyup"];try{if(y&&y.head&&!y.getElementById("x-tool-initial-css")){const t=y.createElement(c);t.id="x-tool-initial-css",t.textContent="[x-show],[x-if],[x-else],[x-else-if],[x\\:show],[x\\:if],[x\\:else],[x\\:else-if]{display:none;}",y.head.appendChild(t)}}catch{}let w="x";const v=t=>`${w}-${t}`;class b{attachToParent(t){this.t=t,t.e(this)}get id(){return this.i}get framework(){return this.n}get element(){return this.s}set element(t){this.s=t}get isBound(){return this.o}set isBound(t){this.o=t}get isMounted(){return this.r}set isMounted(t){this.r=t}get isDestroyed(){return this.c}set isDestroyed(t){this.c=t}h(){for(const t of Array.from(this.f)){try{t()}catch{}this.f.delete(t)}}setFrozen(t){if(t!==this.l)if(this.l=t,t)this.a=this.u,this.u=1,this.h();else{this.u=null!==this.a?this.a:0,this.a=null;try{this.d()}catch{}}}y(t){t!==this.u&&(this.u=t,t&&this.h())}p(t,e){const i=this.m.get(t)||[];i.push(e),this.m.set(t,i)}constructor(t,i,n){this.w=0,this.v=0,this.s=null,this.o=0,this.r=0,this.c=0,this.b=0,this.x=[],this.t=null,this._={},this.g={},this.$=new Map,this.M=new Map,this.E=0,this.k=0,this.A=new Set,this.R=0,this.m=new Map,this.S=new Set,this.u=0,this.l=0,this.a=null,this.f=new Set,this.D=new Set,this.O=null,this.T=new Map,this.F=new Map,this.C=new Map,this.j={mutation:new Map,resize:new Map,intersection:new Map},this.P=[],this.z=new e,this.I=new Map,this.L=new Map,this.N=null,this.B=0,this.q=[],this.U=new e,this.K={},this.W=null,this.V=t=>{const e=this.X[t];"function"==typeof e&&this.Z(()=>this.G(e,[]))},this.J=t=>{if("function"!=typeof t)return;const e=()=>{try{t()}catch{}try{this.S.delete(e)}catch{}};return this.S.add(e),()=>{try{this.S.delete(e)}catch{}}},this.H=(t,e,i,n)=>{t.addEventListener(e,i,n),this.P.push({element:t,event:e,handler:i,options:n})},this.i=t,this.n=n,this.Q=i.methods||{},this._=i.computed||{},this.g=i.propEffects||{},this.R=!(!i.computed||!Object.keys(i.computed).length),this.X={mounted:i.mounted,unmounted:i.unmounted||i.destroyed,updated:i.updated,beforeMount:i.beforeMount,beforeUnmount:i.beforeUnmount||i.beforeDestroy},this.K=i.data||{},this.Y=this.tt(this.K||{}),this.et=this.it()}callBeforeMount(){this.b||(this.V("beforeMount"),this.b=1)}nt(t){if(this.isBound){const e=this,i=e.D,n=e.L.get(t);if(n)for(let t=0;t<n.length;t++)i.add(n[t]);e.LastBatchId&&cancelAnimationFrame(e.LastBatchId),e.LastBatchId=requestAnimationFrame(()=>{if(e.$.clear(),e.LastBatchId=null,!e.isDestroyed){for(const t of i)e.Z(t);i.clear(),!e.R&&d||e.d(),e.V("updated")}})}}it(){const t={};for(const e in this.Q){const i=this.Q[e];t[e]=(...t)=>{const n=this.k,s=this.O;this.k=1,this.O=e;try{return this.Z(()=>this.G(i,t))}finally{this.k=n,this.O=s}}}return t}st(t){if(this.ot(t),this.$.has(t))return this.$.get(t);try{const e=this._[t];this.E=1,this.M.set(t,new Set);const i=e.call(this.rt());return this.E=0,this.$.set(t,i),i}catch(t){return void(this.E=0)}}ot(t){if(!this.N)return;let e=this.L.get(t);e||(e=[],this.L.set(t,e)),e.includes(this.N)||e.push(this.N)}d(){this.u||this.l||this.B||(this.B=1,requestAnimationFrame(()=>{if(this.B=0,this.ct(),this.q&&this.q.length){const t=this.q.splice(0,this.q.length);for(const e of t)try{e()}catch{}}}))}Z(t,e){try{return t()}catch(t){return e}}bindToElement(t){this.o||(this.s=t,this.b||this.callBeforeMount(),this.completeBinding())}getContext(t=1){return this.rt(t)}ht(){if(this.s){try{this.ft(this.s)}catch{}this.d()}}completeBinding(){!this.o&&this.s&&(this.n.lt(this.s)||this.n.at(this.s,this),this.o=1,this.r=1,this.ft(this.s),this.ct(),this.V("mounted"))}e(t){this.x.includes(t)||this.x.push(t)}ut(t){const e=this.x.indexOf(t);e>-1&&this.x.splice(e,1)}G(t,e){try{const i=t+"";if(!/\[native code\]/.test(i)){let t=i.trim();return/^function[\s\(]/.test(t)||/^[\w\$_][\w\d\$_]*\s*=>/.test(t)||/^\(.*?\)\s*=>/.test(t)||(t="function "+t),Function("thisArg","argsArray","ctx","with(ctx){ const f = ("+t+"); return f.apply(thisArg, argsArray); }").call(void 0,this.rt(),e,this.dt(void 0,void 0))}}catch{}return t.apply(this.rt(),e)}destroy(){const t=this;if(!t.c){t.V("beforeUnmount");for(const e of t.x)e.isDestroyed||e.destroy();t.t&&t.t.ut(t);for(const[e,i]of t.m)for(const n of i)if("custom"===n.type&&n.customDirective?.unbind)try{n.customDirective.unbind(e,t)}catch{r()}t.m.clear();for(const{element:e,event:i,handler:n,options:s}of t.P)e.removeEventListener(i,n,s);t.P=[];for(const e of Array.from(t.S))try{e()}catch{r()}if(t.S.clear(),t.$.clear(),t.I.clear(),t.L.clear(),t.W&&t.yt)for(const e of t.W.L.values()){const i=e.indexOf(t.yt);i>-1&&e.splice(i,1)}t.s&&t.n.pt(t.s),t.V("unmounted"),t.c=1,t.r=0,t.o=0,t.x=[],t.t=null,this.mt=new e,this.D.clear(),t.s=null,i(()=>t.n.wt(t.i))}}vt(t,e){if(!t||!e)return;let i;this.W=e;try{i=Function("ctx","with(ctx){return ("+t+")}")}catch{return}const n=()=>{let t;e.N=n;try{const n=e.getContext(1);t=i(n)}catch{t=null}if(e.N=null,t&&"object"==typeof t){this.Y.$props=this.Y.$props||{},this.w=1;for(const e in t){const i=t[e];this.Y[e]!==i&&(this.Y[e]=i)}this.w=0}};this.yt=n,n()}ft(t){const e=this,i=(t,i=0)=>{if(!i&&(t.hasAttribute(v("data"))||this.n.lt(t)))return 0;const n="COMPONENT"===t[l],s=[];let o=0,r=null;for(const e of t.attributes){const t=e.name;(t.startsWith(w+"-")||t.startsWith(w+":"))&&(s.push(e),o||t!==v("text")&&t!==v("html")||(o=1),r||t!==v("for")||(r=e))}if(s.length>0){if(r)return e.bt(t,r.name,r.value),0;for(const i of s)e.bt(t,i.name,i.value)}return o||e.xt(t),i||!n};i(t,1),e._t(t,i)}xt(t){const e=Array.from(t.childNodes);for(const i of e){if(i.nodeType!==Node.TEXT_NODE)continue;const e=i,n=e.nodeValue||"";if(e.gt||-1===n.indexOf("{{"))continue;const s=(e.parentElement?.tagName||"").toLowerCase(),o="code"===s||"pre"===s,r=[];let c=0;for(;c<n.length;){const t=n.indexOf("{{",c);if(-1===t){r.push({literal:n.slice(c)});break}let e=0;for(let i=t-1;i>=0&&92===n.charCodeAt(i);i--)e++;if(e>0){const i=t-e;i>c&&r.push({literal:n.slice(c,i)}),e>1&&r.push({literal:"\\".repeat(e-1)});const s=n.indexOf("}}",t+2);if(-1===s){r.push({literal:n.slice(t,n.length)}),c=n.length;break}r.push({literal:n.slice(t,s+2)}),c=s+2;continue}{t>c&&r.push({literal:n.slice(c,t)});const e=n.indexOf("}}",t+2);if(-1===e){r.push({literal:n.slice(t)}),c=n.length;break}const i=n.slice(t+2,e).trim();r.push(i?{expr:i}:{literal:""}),c=e+2;continue}}const h=r.some(t=>t.expr),f=r.some(t=>t.literal&&t.literal.includes("{{"));if(!h&&!f)continue;e.gt=1;const l=h&&!o?r.filter(t=>t.expr).map(e=>this.$t(e.expr,t)):[];let a=0;const u=()=>{a=0;let t="";for(const e of r)if(null!=e.literal)t+=e.literal;else if(e.expr)if(o)t+="{{ "+e.expr+" }}";else{const e=l[a++]();t+=null==e?"":e+""}e.textContent!==t&&(e.textContent=t)},d={type:"text-interpolation",expression:n,update:void 0};this.p(t,d);const y=this.Mt(u,d);d.update=y}}_t(t,e){let i=t.firstElementChild;for(;i;){const t=i.nextElementSibling;e(i)&&this._t(i,e),i=t}}bt(t,e,i){const n=this,s=e.startsWith(w+":"),o=e.slice(w.length+1);if(s||"class"===o||o===c)return t.removeAttribute(e),n.Et(t,o,i);if("text"===o||"html"===o||"show"===o)return t.removeAttribute(e),n.kt(t,i,o);if(!("model"===o?(t.removeAttribute(e),n.At(t,i),1):"if"===o?(t.removeAttribute(e),n.Rt(t,i),1):"for"===o&&(t.removeAttribute(e),n.St(t,i),1))&&o.indexOf(":")>-1){const[s,r]=o.split(":",2),[c,...h]=r.split("."),f=h.reduce((t,e)=>(e&&(t[e]=1),t),{});if("on"===s){t.removeAttribute(e);const s=n.framework.Dt(c);return s?n.Ot(t,c,i,s,f):n.Tt(t,c,i,f)}return t.removeAttribute(e),n.Et(t,c,i)}}Mt(t,e){const i=()=>{this.N=i;try{t()}finally{this.N=null}};if(i(),this.A.add(i),d&&e&&void 0===e.Ft){let t=0;for(const e of this.L.values())if(e.includes(i)){t=1;break}e.Ft=!t}return i}kt(t,e,i){if("class"===i||i===c)return this.Et(t,i,e);const n=this.$t(e,t);let s,o;"show"===i&&(s=t.style[h]!==f?t.style[h]:void 0);const r={type:i,expression:e,update:void 0,originalDisplay:s};this.p(t,r);const l=this.Mt(()=>{const e=n(),r=t;switch(i){case"text":r.textContent=e+"";break;case"html":r.innerHTML=(e||"")+"";break;case"show":const t=!!e;if(o===t)return;o=t,r.style[h]=t?s||"":f}},r);r.update=l}At(t,e){const i="checkbox"===t.type,n="number"===t.type||"range"===t.type,s="SELECT"===t.tagName&&1==t.multiple;Reflect.has(this.Y,e)||Reflect.defineProperty(this.Y,e,{configurable:1,enumerable:1,writable:1});const o=this.$t(e,t),r=this.Ct(e+" = $value",1),c=i?(()=>{if(t.hasAttribute("value"))return t.value;const e=this.jt(t);if(e){const t=Object.keys(e);if(1===t.length)return e[t[0]]}return t.value})():void 0;this.Mt(()=>(e=>{if(i)if(Array.isArray(e)){const i=t.hasAttribute("value")?t.value:c;t.checked=null!=i?e.includes(i):0}else t.checked=!!e;else{if(s){const i=t,n=Array.isArray(e)?e:[];for(let t=0;t<i.options.length;t++){const e=i.options[t];e.selected=n.includes(e.value)}return}t.value=(e??(n?0:""))+""}})(o()));const h=this.dt(void 0,t),f=t.type;this.H(t,"SELECT"===t[l]||"checkbox"===f||"radio"===f||"file"===f?"change":"input",()=>{const e=(()=>{if(i)return Array.isArray(o())&&void 0!==c?t.checked?c:void 0:t.hasAttribute("value")?t.checked?t.value:void 0:t.checked;if(s){const e=t,i=[];for(let t=0;t<e.options.length;t++){const n=e.options[t];n.selected&&i.push(n.value)}return i}return n?parseFloat(t.value)||0:t.value})(),f=this.Z(()=>o());if(i&&Array.isArray(f)){const e=f,i=t.hasAttribute("value")?t.value:c;if(void 0!==i){const n=e.indexOf(i);t.checked?-1===n&&e.push(i):n>-1&&e.splice(n,1)}}else if(s&&Array.isArray(f)){const t=f;t.splice(0,t.length),e.forEach(e=>t.push(e))}else h.$value=e,this.Z(()=>{r.call(this.rt(),h)})}),this.p(t,{type:"model",property:e})}Rt(t,e){const i=this,n=y.createComment("x-if");t.parentNode?.insertBefore(n,t),t.Pt=n.parentElement||null;const s=[],o=t=>{if(t[l]===a){const e=y.createElement("div");return e.style[h]=p,e.appendChild(t.content.cloneNode(1)),{el:e,isTemplate:1}}return{el:t,isTemplate:0}},r=o(t),c=i.$t(e,t);s.push({el:r.el,test:c,isTemplate:r.isTemplate}),r.isTemplate||(r.el.zt=1);const f=[t];{let e=t.nextElementSibling;for(;e;){const t=e.hasAttribute("x-else"),n=e.hasAttribute("x-else-if");if(!t&&!n)break;if(e.hasAttribute("x-else-if")){const t=e.getAttribute("x-else-if")||"",n=o(e),r=i.$t((t||"").trim(),e);s.push({el:n.el,test:r,isTemplate:n.isTemplate}),n.isTemplate||(n.el.zt=1)}else{const t=o(e);s.push({el:t.el,test:null,isTemplate:t.isTemplate}),t.isTemplate||(t.el.zt=1)}e.removeAttribute("x-else"),e.removeAttribute("x-else-if"),f.push(e),e=e.nextElementSibling}}let d=-1;for(const t of f)t.parentNode&&t.parentNode.removeChild(t);const m=e=>{if(e<0)return;const o=s[e];o.el.zt||(i.ft(o.el),o.el.zt=1),t.It?.parentNode?.removeChild(t.It),o.el.parentNode||n.parentNode?.insertBefore(o.el,n.nextSibling),t.It=o.el,d=e},w=i.Mt(()=>{let t=-1;for(let e=0;e<s[u];e++){const i=s[e];if(!i.test||i.test()){t=e;break}}t!==d&&(-1!==d?((t,e)=>{if(t<0)return void(e&&e());const i=s[t];i.el.parentNode?(i.el.parentNode&&i.el.parentNode.removeChild(i.el),e&&e()):e&&e(),d=-1})(d,()=>m(t)):m(t))});i.p(t,{type:"if",expression:e,update:w})}Tt(t,e,n,s){const r=this,c=(n||"").trim(),h=r.Lt(c),f=s?{once:!!s.once,passive:!!s.passive,capture:!!s.capture}:void 0,l=!!s?.self,a=!!s?.prevent,u=!!s?.stop,d=!!s?.outside,p=!!s?.defer,w={enter:["enter"],esc:["escape","esc"],escape:["escape","esc"],space:[" ","space","spacebar"],tab:["tab"],backspace:["backspace"],delete:["delete","del"],del:["delete","del"],arrowup:["arrowup","up"],arrowdown:["arrowdown","down"],arrowleft:["arrowleft","left"],arrowright:["arrowright","right"],home:["home"],end:["end"],pageup:["pageup"],pagedown:["pagedown"]},v={ctrl:!!s?.ctrl,alt:!!s?.alt,shift:!!s?.shift,meta:!!s?.meta},b={left:0,middle:1,right:2},x=!!s?.single,_=!!s?.multi,g=s?o(s):[],$=[];for(const t of g){const e=w[t.toLowerCase()];e&&$.push(...e)}const M=[];for(const t of g){const e=b[t.toLowerCase()];void 0!==e&&M.push(e)}const E=$.length>0||v.ctrl||v.alt||v.shift||v.meta,k=M.length>0,A=x||_,R=e=>{const i=e.composedPath?e.composedPath():null,n=i&&i.length?i[0]:e.target;if(d){if(!n)return 0;if(t instanceof Node&&(t===n||t.contains(n)))return 0}if(l&&e.target!==t)return 0;if(A){if(!(e instanceof TouchEvent))return 0;{const t=e.touches.length;if(x&&1!==t)return 0;if(_&&t<2)return 0}}if(k){if(!(e instanceof MouseEvent))return 0;if(!M.includes(e.button))return 0}if(E){if(!(e instanceof KeyboardEvent))return 0;const t=(e.key||"").toLowerCase();if($.length>0&&!$.includes(t))return 0;if(v.ctrl&&!e.ctrlKey)return 0;if(v.alt&&!e.altKey)return 0;if(v.shift&&!e.shiftKey)return 0;if(v.meta&&!e.metaKey)return 0}return 1},S=!!c;let D=null;const O=r.rt();if(h){const e=r.Nt(h.paramsList,h.body,h.isBlock),i=h.paramsList.length?e=>h.paramsList.map((i,n)=>0===n?e:1===n?t:void 0):()=>[];D=n=>{const s=r.dt(n,t);e.call(O,s,...i(n))}}else if(S){const e=c.includes(";"),i=r.Ct(c,e);D=e=>{const n=r.dt(e,t),s=i.call(O,n);"function"==typeof s&&s.call(O,e)}}const T=t=>{if(R(t)&&(a&&"function"==typeof t.preventDefault&&t.preventDefault(),u&&"function"==typeof t.stopPropagation&&t.stopPropagation(),D)){if(p&&"function"==typeof i){const e=t;return void i(()=>r.Z(()=>D(e)))}r.Z(()=>D(t))}},F=!!this.framework.Bt().delegate&&m.includes(e);if(!d&&F){const i=this.framework.qt(t,e,{filter:t=>R(t),run:t=>T(t),once:!!s?.once,comp:this});this.J(i)}else{const i=d?t?.ownerDocument||y||document:t;r.H(i,e,T,f)}}Ct(t,e=0){const i=`${e?"s":"r"}:${t}`;let n=this.I.get(i);return n||(n=Function("ctx",`with(ctx){${e?t:`return (${t})`}}`),this.I.set(i,n)),n}$t(t,e){const i=this,n=i.Ct(t);return()=>this.Z(()=>n.call(i.rt(),i.dt(void 0,e)))}Lt(t){let e=t.match(/^\s*\(\s*([^)]*?)\s*\)\s*=>\s*([\s\S]+)$/);if(e||(e=t.match(/^\s*([a-zA-Z_$][a-zA-Z0-9_$]*)\s*=>\s*([\s\S]+)$/)),!e)return null;const i=(e[1]||"").split(",").map(t=>t.trim()).filter(Boolean),n=(e[2]||"").trim(),s=n.startsWith("{")&&n.endsWith("}");return{paramsList:i,body:s?n.slice(1,-1):n,isBlock:s}}Nt(t,e,i){return Function("ctx",...t,"with(ctx){ "+(i?e:"return ( "+e+" );")+" }")}Ut(i,n){if(Object.getPrototypeOf(i)!==Object.prototype&&!t(i))return i;const s=this;if(this.mt||(this.mt=new e),this.mt.has(i))return this.mt.get(i);const o=new Proxy(i,{get:(e,i,o)=>{if(t(e)){if(i===Symbol.iterator)return s.ot(n),Reflect.get(e,i,o);("length"===i||"string"==typeof i&&/^\d+$/.test(i))&&s.ot(n)}else s.ot(n);const r=Reflect.get(e,i,o);return t(e)&&"function"==typeof r&&["push","pop","shift","unshift","splice","reverse","copyWithin","fill"].includes(i)?function(...t){if(s.E)throw Error(`[x-tool] Mutation via '${n+""}.${i+""}()' is not allowed during computed evaluation.`);if(s.l)throw Error(`[x-tool] Mutation via '${n+""}.${i+""}()' is not allowed while component is frozen.`);const o=e,c=o.length,h=o[0],f=o[c-1],l=r.apply(e,t);return s.u||o.length===c&&o[0]===h&&o[o.length-1]===f||s.nt(n),l}:r&&"object"==typeof r?s.Ut(r,n):r},ownKeys:t=>Reflect.ownKeys(t),has:(t,e)=>Reflect.has(t,e),set:(t,e,i)=>{if(s.c)return 1;if(s.E)throw Error(`[x-tool] Mutation of '${n+""+("symbol"==typeof e?"":"."+e)}' is not allowed during computed evaluation.`);if(s.l)throw Error(`[x-tool] Mutation of '${n+""+("symbol"==typeof e?"":"."+e)}' is not allowed while component is frozen.`);if("symbol"==typeof e)return 1;const o=Reflect.has(t,e),r=o?Reflect.get(t,e):void 0;if(i&&"object"==typeof i&&(i=s.Ut(i,"symbol"==typeof e?n:n+"."+e)),!o){try{Reflect.defineProperty(t,e,{configurable:1,enumerable:1,writable:1,value:i})}catch{Reflect.set(t,e,i)}return s.nt(n),1}return r===i||(Reflect.set(t,e,i),s.u||s.nt(n)),1},deleteProperty:(t,e)=>{if(s.E)throw Error(`[x-tool] Deletion of '${n+""+("symbol"==typeof e?"":"."+e)}' is not allowed during computed evaluation.`);if(s.l)throw Error(`[x-tool] Deletion of '${n+""+("symbol"==typeof e?"":"."+e)}' is not allowed while component is frozen.`);const i=Reflect.deleteProperty(t,e);return i&&!s.u&&s.nt(n),i}});return this.mt.set(i,o),o}tt(e){const i=this;return new Proxy(e,{get:(t,e,n)=>{const s=Reflect.get(t,e,n);return e===Symbol.iterator?s:("symbol"!=typeof e&&i.ot(e),s&&"object"==typeof s?i.Ut(s,e):s)},ownKeys:t=>Reflect.ownKeys(t),has:(t,e)=>Reflect.has(t,e),set:(e,n,s,o)=>{if(i.c)return 1;if(i.l)return 1;if(i.E)throw Error(`[x-tool] Mutation of '${n+""}' is not allowed during computed evaluation.`);if(n===Symbol.iterator&&t(e))return s;const r=Reflect.get(e,n);if(Reflect.has(e,n))Reflect.set(e,n,s,o);else try{Reflect.defineProperty(e,n,{configurable:1,enumerable:1,writable:1,value:s})}catch{Reflect.set(e,n,s,o)}if(this.u||this.nt(n),this.w&&"$props"!==n){const t=e.$props;t&&(t[n]=s);const i=this.g[n];!i||this.v||this.u||(this.v=1,this.Z(()=>i.call(this.rt(),s,r)),this.v=0)}return 1}})}rt(t=1){const e={$log:()=>{},$destroy:()=>this.destroy(),$forceUpdate:()=>this.d(),$addCleanupFunction:t=>this.J(t),$nextTick:t=>t?(this.q.push(t),void(this.B||i(()=>{if(!this.B&&this.q.length){const t=this.q.splice(0,this.q.length);for(const e of t)this.Z(()=>e())}}))):new Promise(t=>{this.q.push(()=>t()),this.B||i(()=>{if(!this.B&&this.q.length){const t=this.q.splice(0,this.q.length);for(const e of t)this.Z(()=>e())}})}),$el:this.s,$id:this.i,$isMounted:this.r,$isDestroyed:this.c,$isSealed:this.u,$isFrozen:this.l,$parent:this.t,$children:this.x,$seal:(t=1)=>{this.y(!!t)},$mutate:t=>{const e=this.k;if(this.E)throw Error("[x-tool] $mutate cannot be used inside computed evaluation; computed getters must be pure.");this.k=0;try{return"function"==typeof t?t():void 0}finally{this.k=e,this.d()}}};let n=this.Y;return this.E&&(n=this.K),new Proxy(n,{get:(t,i)=>i in t?(this.ot(i),t[i]):i in this._?this.st(i):i in e?e[i]:this.et[i],set:(t,e,i)=>{if(this.E)throw Error(`[x-tool] Mutation of '${e+""}' is not allowed during computed evaluation.`);if(this.l)throw Error(`[x-tool] Mutation of '${e+""}' is not allowed while component is frozen.`);return this.Y[e]=i,1}})}dt(t,i){const n=this,s=i?this.jt(i):null,r=s?new Set(o(s)):new Set,c="undefined"!=typeof window?window:void 0,h="undefined"!=typeof document?document:void 0,f=this.framework.Bt(),l=!!f.sandboxExpressions,a=new Set((f.allowGlobals||[]).map(t=>t+"")),u=new e,d=t=>{if(!t)return t;if("function"!=typeof t.addEventListener)return t;const i=new e,s=(t,e)=>{try{return t+"|"+(void 0===e?"":"object"==typeof e?JSON.stringify(e):e+"")}catch{return t+"|"}};return new Proxy(t,{get(t,e,o){if("addEventListener"===e)return function(e,o,r){if(n.u||n.l)return;const c=n.O||"__anonymous__",h=s(e,r);let f=u.get(t);f||(f=new Map,u.set(t,f));let l=f.get(c);l||(l=new Map,f.set(c,l));const a=l.get(h);if(a){try{t.removeEventListener(e,a.handler,a.options)}catch{}try{a.remover&&a.remover()}catch{}l.delete(h)}t.addEventListener(e,o,r);const d=n.J(()=>{try{t.removeEventListener(e,o,r)}catch{}});d&&n.f.add(d);try{if("function"==typeof o&&d){let t=i.get(o);t||(t=new Map,i.set(o,t)),t.set(h,d)}}catch{}l.set(h,{handler:o,options:r,remover:d})};if("removeEventListener"===e)return function(e,n,o){try{t.removeEventListener(e,n,o)}catch{}const r=s(e,o);try{if("function"==typeof n){const t=i.get(n);if(t){const e=t.get(r);if(e){try{e()}catch{}t.delete(r)}0===t.size&&i.delete(n)}}}catch{}const c=u.get(t);if(c)for(const[t,e]of c){const i=e.get(r);if(i&&i.handler===n){try{i.remover&&i.remover()}catch{}e.delete(r),0===e.size&&c.delete(t);break}}};if("querySelector"===e)return function(e){const i=t.querySelector(e);return d(i)};if("querySelectorAll"===e)return function(e){const i=t.querySelectorAll(e);return Array.from(i).map(d)};if("getElementById"===e)return function(e){const i=t.getElementById(e);return d(i)};if("document"===e){const e=t.document;return d(e)||e}if("body"===e&&t===h){const e=t.body;return d(e)||e}if("defaultView"===e&&t===h){const e=t.defaultView;return d(e)||e}const r=t[e];if("function"==typeof r)try{return r.bind(t)}catch{}return r}})},y=new Map,p=new Map,m=new Map,w=(t,e)=>{if(!t)return;const i=function(...i){if(n.u||n.l)return{observe(){},disconnect(){},unobserve(){}};const s=new t(...i),o=n.O||"__anonymous__";let r="mutation"===e?n.j.mutation:"resize"===e?n.j.resize:n.j.intersection;const c=r.get(o);if(c){try{c.inst.disconnect()}catch{}try{c.remover&&c.remover()}catch{}}const h=n.J(()=>{try{s.disconnect()}catch{}});return h&&n.f.add(h),r.set(o,{inst:s,remover:h}),s};return i.prototype=t.prototype,i},v={$target:i||null,$event:t||null,...l&&!a.has("setTimeout")?{}:{setTimeout:(t,e,...i)=>{if(n.u||n.l)return;const s=n.O||"__anonymous__",o=n.T.get(s);if(o){try{c?.clearTimeout?.(o.id)}catch{}try{o.remover&&o.remover()}catch{}}const r=c?.setTimeout?.(t,e,...i);if(null!=r){const t=n.J(()=>{try{c?.clearTimeout?.(r)}catch{}});t&&n.f.add(t),y.set(r,t),n.T.set(s,{id:r,remover:t})}return r}},...l&&!a.has("clearTimeout")?{}:{clearTimeout:t=>{try{c?.clearTimeout?.(t)}catch{}finally{try{const e=y.get(t);e&&(e(),y.delete(t))}catch{}}}},...l&&!a.has("setInterval")?{}:{setInterval:(t,e,...i)=>{if(n.u||n.l)return;const s=n.O||"__anonymous__",o=n.F.get(s);if(o){try{c?.clearInterval?.(o.id)}catch{}try{o.remover&&o.remover()}catch{}}const r=c?.setInterval?.(t,e,...i);if(null!=r){const t=n.J(()=>{try{c?.clearInterval?.(r)}catch{}});t&&n.f.add(t),p.set(r,t),n.F.set(s,{id:r,remover:t})}return r}},...l&&!a.has("clearInterval")?{}:{clearInterval:t=>{try{c?.clearInterval?.(t)}catch{}finally{try{const e=p.get(t);e&&(e(),p.delete(t))}catch{}}}},...l&&!a.has("requestAnimationFrame")?{}:{requestAnimationFrame:t=>{if(n.u||n.l)return;const e=n.O||"__anonymous__",i=n.C.get(e);if(i){try{c?.cancelAnimationFrame?.(i.id)}catch{}try{i.remover&&i.remover()}catch{}}const s=c?.requestAnimationFrame?.(t);if(null!=s){const t=n.J(()=>{try{c?.cancelAnimationFrame?.(s)}catch{}});t&&n.f.add(t),m.set(s,t),n.C.set(e,{id:s,remover:t})}return s}},...l&&!a.has("cancelAnimationFrame")?{}:{cancelAnimationFrame:t=>{try{c?.cancelAnimationFrame?.(t)}catch{}finally{try{const e=m.get(t);e&&(e(),m.delete(t))}catch{}}}},...l&&!a.has("MutationObserver")?{}:{MutationObserver:w(c?.MutationObserver,"mutation")},...l&&!a.has("ResizeObserver")?{}:{ResizeObserver:w(c?.ResizeObserver,"resize")},...l&&!a.has("IntersectionObserver")?{}:{IntersectionObserver:w(c?.IntersectionObserver,"intersection")},...l&&!a.has("window")?{}:{window:d(c)},...l&&!a.has("document")?{}:{document:d(h)}};return new Proxy({},{get:(t,e)=>s&&e in s?s[e]:e in n.Y?n.Y[e]:e in n._?n.st(e):e in n.et?n.et[e]:e in v?v[e]:void 0,set:(t,e,i)=>(s&&r.has(e)?s[e]=i:n.Y[e]=i,1),has:(t,e)=>!(!s||!(e in s))||e in n.Y||e in n._||e in n.et||e in v})}Ot(t,e,i,n,s){const o=this,r=o.$t(i,t),c={type:"custom",expression:i,customDirective:n};n.bind&&o.Z(()=>n.bind(t,r(),i,o,s,r));const h=o.Mt(()=>{n.update&&o.Z(()=>n.update(t,r(),i,o,s,r))});c.update=h,o.p(t,c)}Et(e,i,n){const s=this,o=s.$t(n,e);if("class"===i){const t=e;if(!s.U.get(t)){const e=new Set,i=t.className||"";if(i)for(const t of i.split(/\s+/))t&&e.add(t);s.U.set(t,e)}}const r=e;let h=null;if(i in r)h=i;else{const t=i.replace(/-([a-z])/g,(t,e)=>e.toUpperCase());t in r?h=t:"readonly"===i.toLowerCase()&&"readOnly"in r&&(h="readOnly")}const f=!(!h||"boolean"!=typeof r[h]),l=!(!h||!(h in r)||"function"==typeof r[h]),a=!!b.Kt[i.toLowerCase()],u=s.Mt(()=>{const n=o();if("class"===i){const i=e,o=s.U.get(i);if("string"==typeof n)i.className=o&&o.size?[...o].join(" ")+(n?" "+n:""):n||"";else if(t(n))i.className=o&&o.size?[...o,...n.filter(Boolean)].join(" "):n.filter(Boolean).join(" ");else if(n&&"object"==typeof n){o&&o.size&&(i.className=[...o].join(" "));for(const t in n){const e=!!n[t];if(!t)continue;const s=t.split(/\s+/);for(let t=0;t<s.length;t++){const n=s[t];n&&i.classList.toggle(n,e)}}}else null==n&&o&&o.size?i.className=[...o].join(" "):null==n&&i.removeAttribute("class");return}if(i===c){const t=e;return"string"==typeof n?void(t.style.cssText=n):n&&"object"==typeof n?void Object.assign(t.style,n):void(null==n&&t.removeAttribute("style"))}if(f&&h||a){const t=!!n;return h&&f&&(r[h]=t),void(t?e.setAttribute(i,""):e.removeAttribute(i))}let u=null;if(n&&"object"==typeof n){const t=[];for(const e in n)n[e]&&t.push(e);u=t.length?t.join(" "):null}else null!=n&&(u=n+"");if(l&&h)if(null!==u)try{r[h]=u}catch(t){try{e.setAttribute(i,u)}catch{}}else e.removeAttribute(i);else null!==u?e.getAttribute(i)!==u&&e.setAttribute(i,u):e.hasAttribute(i)&&e.removeAttribute(i)});s.p(e,{type:"bind",expression:n,update:u})}jt(t){if(!t)return null;if(!t.parentElement){const e=t.It;if(e&&e.parentElement)t=e;else{const e=t.Pt;e&&(t=e)}}const e={};let i=t;for(;i;){const t=this.z.get(i);if(t&&Object.assign(e,t),i===this.element)break;i=i.parentElement}return o(e).length?e:null}Wt(t){for(const[e,i]of this.m)for(const n of i)(t===e||e instanceof Element&&t.contains(e))&&n.update&&n.update()}St(t,e){const i=this,o=e.trim().match(/^(?:\(\s*([^,\s]+)\s*(?:,\s*([^\)]+))?\s*\)|([^,\s]+))\s+(in|of)\s+(.+)$/);if(!o)return;const r=o[1]||o[3],c=o[2],f=o[5],u=y.createComment("x-for");let d;t.parentNode?.insertBefore(u,t),t[l]===a?(d=y.createElement("div"),d.style[h]=p,d.appendChild(t.content.cloneNode(1)),t.parentNode?.removeChild(t)):(d=t,t.parentNode?.removeChild(t));const m=u.parentElement||i.element,w=i.$t(f.trim(),m),v=[],b=(t,e)=>{const i={[r]:t};return c&&(i[c]=e),i},x={type:"for",expression:e},_=i.Mt(()=>{const t=i.Z(()=>{const t=w();if(s(t))return{list:t,keys:null};if("undefined"!=typeof Map&&t instanceof Map)return{list:n(t.values()),keys:n(t.keys())};if("undefined"!=typeof Set&&t instanceof Set)return{list:n(t.values()),keys:null};if(t&&"function"==typeof t[Symbol.iterator])return{list:n(t),keys:null};if(t&&"object"==typeof t){const e=Object.keys(t);return{list:e.map(e=>t[e]),keys:e}}return{list:[],keys:null}},{list:[],keys:null}),e=t.list,o=t.keys;if(v.length>e.length)for(;v.length>e.length;){const t=v.pop();t.parentNode&&t.parentNode.removeChild(t)}const r=Math.min(v.length,e.length);for(let t=0;t<r;t++){const n=v[t];i.z.set(n,b(e[t],o?o[t]:t)),i.Wt(n)}if(e.length>v.length){const t=y.createDocumentFragment(),n=v.length;for(let s=n;s<e.length;s++){const n=d.cloneNode(1);n.removeAttribute("x-for"),i.z.set(n,b(e[s],o?o[s]:s));try{i.ft(n)}catch{}t.appendChild(n),v.push(n)}const s=v[n-1]||u;s.parentNode&&s.parentNode.insertBefore(t,s.nextSibling)}},x);x.update=_,i.p(u,x)}ct(){const t=this;for(const e of t.m.values())for(const t of e)if((!d||!t.Ft)&&t.update)try{t.update()}catch(t){}}}return b.Kt={itemscope:1,formnovalidate:1,novalidate:1,default:1},new class{constructor(){this.Vt=new Map,this.Xt=new e,this.Zt=[],this.Gt={},this.Jt=new Map,this.Ht=new Map,this.Qt=new e,this.Yt=0,this.directive=(t,e)=>{if(t.startsWith(w+"-"))throw Error(`Custom directive names should not start with "${w}-". Use: XTool.directive("my-directive", ...)`);return this.Jt.set(t,e),this},this.registerComponent=t=>{if(!t||!t.name)throw Error("registerComponent requires a name");const e=t.name.toLowerCase();if(this.Ht.has(e))throw Error(`Component name "${e}" already registered`);return this.Ht.set(e,t),this},this.te=t=>this.Ht.get(t.toLowerCase()),this.Dt=t=>this.Jt.get(t),this.Bt=()=>this.Gt,this.ee=[],this.init=(t={})=>{this.Gt={container:"body",debug:0,staticDirectives:1,...t},"boolean"==typeof this.Gt.staticDirectives&&(d=this.Gt.staticDirectives);const e=this.Gt.prefix;w=e&&"string"==typeof e&&e[u]>0?e:"x";const i=async()=>{if(this.ie(),this.ee.length)try{await Promise.allSettled(this.ee)}catch{}this.ne();const t=y?.querySelector(this.Gt.container);t&&(this.se(t),this.Gt.delegate&&this.oe(t))};return y&&"loading"===y.readyState?y.addEventListener("DOMContentLoaded",()=>{i()}):y&&"complete"!==y.readyState&&"interactive"!==y.readyState||i(),this},this.re=new Map,this.ce=new Map,this.loadComponents=t=>{const e=t.map(t=>"string"==typeof t?{path:t,mode:"preload",name:void 0}:{path:t.path,mode:t.mode||"preload",name:t.name}),i=[];for(const t of e)if("defer"===t.mode){const e=this.he(t.path).catch(()=>{throw Error("load failed")});this.ee.push(e),i.push(e.then(()=>{}))}else if("lazy"===t.mode){const e=(t.name||t.path.split("/").pop()||"").replace(/\.(mjs|js|ts)(\?.*)?$/i,"").toLowerCase();if(e&&!this.ce.has(e)&&(this.ce.set(e,{path:t.path,status:"pending"}),y&&y.querySelector(`component[source="${e}"]`))){const t=this.ce.get(e),i=()=>{"pending"===t.status&&(t.status="loading",t.promise=this.he(t.path).then(()=>{t.status="loaded"}).catch(()=>{t.status="error"}).finally(()=>{try{this.ne()}catch{}}))};try{window.requestIdleCallback?window.requestIdleCallback(i,{timeout:2e3}):setTimeout(i,50)}catch{setTimeout(i,50)}}}else{const e=this.he(t.path).catch(()=>{throw Error("load failed")});i.push(e)}return Promise.allSettled(i).then(t=>{try{this.ne()}catch{}return{settled:t.length,failed:t.filter(t=>"rejected"===t.status).length}})},this.createComponent=t=>{const e=new b(this.fe(),t,this);return this.Vt.set(e.id,e),e.callBeforeMount(),e},this.ne=()=>{const t=y?.querySelector(this.Gt.container);if(!t)return;const e=t.querySelectorAll(`[${v("data")}]`);for(const t of e)this.lt(t)||this.le(t);const i=t.querySelectorAll("component[source]");for(const t of i)this.lt(t)||this.ae(t);if(this.ue(),0===e[u]&&!this.lt(t)){const e=n(this.Vt.values()),i=e[e[u]-1];i&&!i.isBound&&i.bindToElement(t)}},this.ue=()=>{if(this.Zt[u]){for(const t of this.Zt){let e,i=t.el.parentElement;for(;i&&!e;){const t=this.lt(i);t?e=t:i=i.parentElement}e&&t.comp.attachToParent(e)}for(const t of this.Zt)t.comp.completeBinding();this.Zt=[]}},this.le=(t,e)=>{const n=t.getAttribute(v("data"));let s={};if(n){t.removeAttribute(v("data"));try{if(e){let t={};try{t=e.rt?.()||{}}catch{t={}}s=Function("parent",`with(parent){ return (${n}) }`)(t)}else s=this.de(n);s=s.methods?{methods:s.methods,data:{...s}}:{data:{...s}},e&&(s.data.$parent=e)}catch(t){}}const o=this.createComponent(s);o.element=t,o.callBeforeMount(),this.at(o.element,o),this.Zt.push({el:t,comp:o});const r=t.getAttribute(v("init"));if(r){t.removeAttribute(v("init"));const e=o.X?.mounted;o.X.mounted=function(){if(e)try{e.call(this)}catch{}const t=Function("ctx","with(ctx){"+r+"} ");i(()=>{if(!o.isDestroyed&&o.element&&o.element.isConnected)try{const e=o.rt?.()||o.getContext?.()||{},i=t(e);if("function"==typeof i)try{i()}catch{}}catch{}})}}},this.fe=()=>"component_"+Date.now()+"_"+Math.random().toString(36).substring(2,9),this.de=t=>{try{return Function("return "+t.trim())()}catch{return{}}},this.wt=t=>{this.Vt.delete(t)},this.ye=()=>{},this.at=(t,e)=>{this.Xt.set(t,e)},this.pt=t=>{try{this.Xt.delete(t)}catch{}}}he(t,e=2,i=300){const n=this.re.get(t);if(n)return n;const s=this,o=(t,...e)=>t.reduce((t,i,n)=>t+i+(n<e.length?e[n]:""),""),r=n=>fetch(t,{cache:"no-cache"}).then(t=>{if(!t.ok)throw Error(t.status+" "+t.statusText);return t.text()}).then(e=>{Function("XTool","html",e+"\n//# sourceURL="+t)(s,o)}).catch(t=>{if(n>=e)throw t;const s=i*Math.pow(2,n);return new Promise(t=>setTimeout(t,s)).then(()=>r(n+1))}),c=r(0).finally(()=>{this.re.delete(t)});return this.re.set(t,c),c}ie(){if(!y)return;if("x"===w)return;const t="x-tool-initial-css-"+w;if(y.head&&!y.getElementById(t)){const e=y.createElement(c);e.id=t,e.textContent=`[${w}-show],[${w}-if],[${w}-else],[${w}-else-if],[${w}\\:show],[${w}\\:if],[${w}\\:else],[${w}\\:else-if]{display:none;}`,y.head.appendChild(e)}}se(t){this.pe||"undefined"==typeof MutationObserver||(this.pe=new MutationObserver(t=>{for(const e of t)if("childList"===e.type){for(let t=0;t<e.addedNodes.length;t++){const i=e.addedNodes[t];if(1!==i.nodeType)continue;const n=i;"COMPONENT"===n[l]&&n.getAttribute("source")&&!this.lt(n)&&this.ae(n)}for(let t=0;t<e.removedNodes.length;t++){const n=e.removedNodes[t];if(1!==n.nodeType)continue;const s=n;i(()=>{if(s.isConnected)return;const t=[s];for(;t.length;){const e=t.pop(),i=this.lt(e);if(i&&!i.isDestroyed)try{i.destroy()}catch{}let n=e.firstElementChild;for(;n;)t.push(n),n=n.nextElementSibling}})}}else if("attributes"===e.type){const t=e.target;if(t&&"COMPONENT"===t[l])if("source"===e.attributeName)this.me(t);else if("readonly"===e.attributeName){const e=this.lt(t);if(e)try{const i=t.hasAttribute("readonly");e.setFrozen(!!i)}catch{}}}this.ue()}),this.pe.observe(t,{childList:1,subtree:1,attributes:1,attributeFilter:["source","readonly"]}))}me(t){const e=(t.getAttribute("source")||"").trim(),i=this.lt(t);if(e){if(i&&!i.isDestroyed)try{i.destroy()}catch{}t.innerHTML="",this.ae(t)}else{if(i&&!i.isDestroyed)try{i.destroy()}catch{}t.innerHTML=""}}ae(t){const e=t.getAttribute("source");if(!e)return;let i,n=this.te(e);if(!n){const i=e.toLowerCase(),n=this.ce?.get(i);return void(n&&("pending"===n.status&&(n.status="loading",n.promise=this.he(n.path).then(()=>{n.status="loaded"}).catch(()=>{n.status="error"}).finally(()=>{try{this.ne()}catch{}})),n.promise?.then(()=>{try{this.te(e)&&this.ae(t)}catch{}})))}let s=t.parentElement;for(;s&&!i;){const t=this.lt(s);t?i=t:s=s.parentElement}let o=null,r=null,c=null;o||(o={});const h=t.getAttribute(v("prop"));if(h){if(c=h,i)try{r=Function("ctx","with(ctx){return ("+h+")}")(i.getContext(1))}catch{r=null}else try{r=Function("return ("+h+")")()}catch{r=null}if(r&&"object"==typeof r)for(const t in r)t in o||(o[t]=r[t]+"");t.removeAttribute(v("prop"))}let f,l={};if(n.makeData)try{l=n.makeData(o)||{}}catch{l={}}if(n.data)for(const t in n.data)l[t]=n.data[t];for(const t in o)t in l||(l[t]=o[t]);if(l.$props=o,"function"==typeof n.init)try{const t=n.init(o);f=t&&"object"==typeof t?t:void 0}catch{f=void 0}const a={data:l,methods:{...n.methods||{},...f?.methods||{}},computed:{...n.computed||{},...f?.computed||{}},propEffects:{...n.propEffects||{},...f?.propEffects||{}},mounted:f?.mounted||n.mounted,unmounted:f?.unmounted||n.unmounted,beforeMount:f?.beforeMount||n.beforeMount,beforeUnmount:f?.beforeUnmount||n.beforeUnmount,updated:f?.updated||n.updated,destroyed:f?.destroyed||n.destroyed,beforeDestroy:f?.beforeDestroy||n.beforeDestroy},u=this.createComponent(a);u.element=t;const d=[];for(;t.firstChild;){const e=t.firstChild;d.push(e),t.removeChild(e)}if(n.template){const e=e=>{t.innerHTML=e;const i=t.querySelectorAll("slot");if(i.length)for(const t of i){const e=t.getAttribute("name");let i=[];if(i=d.filter(e?t=>1===t.nodeType&&t.getAttribute("slot")===e:t=>1!==t.nodeType||!t.hasAttribute("slot")),i.length){const e=y.createDocumentFragment();for(const t of i)e.appendChild(t);t.parentNode?.replaceChild(e,t)}}},i=n.template;if("string"==typeof i)e(i);else if("function"==typeof i)try{const n=i();n&&"function"==typeof n.then?(t.innerHTML="",n.then(t=>{e(t||"");try{u.ht()}catch{}})):e((n||"")+"")}catch{t.innerHTML=""}else i&&"function"==typeof i.then&&(t.innerHTML="",i.then(t=>{e(t||"");try{u.ht()}catch{}}))}else for(const e of d)t.appendChild(e);this.at(t,u);try{const e=t.querySelectorAll(`[${v("data")}]`);for(const t of e)this.lt(t)||this.le(t,u)}catch{}if(this.Zt.push({el:t,comp:u}),c&&i)try{u.vt(c,i)}catch{}this.ue()}lt(t){return this.Xt.get(t)}observe(t){}oe(t){if(this.Yt)return;const e=t,i=t=>{let i=t.target;for(;i&&i!==e.parentElement&&!t.cancelBubble;){const e=this.Qt.get(i);if(e){const i=e.get(t.type);if(i&&i.length)for(const e of[...i])try{if(e.comp&&e.comp.isDestroyed){const t=i.indexOf(e);t>-1&&i.splice(t,1);continue}if((!e.filter||e.filter(t))&&(e.run(t),e.once)){const t=i.indexOf(e);t>-1&&i.splice(t,1)}}catch{}}i=i.parentElement}},n=["keydown","keyup"],s=["click","input","change"];for(const t of n)e.addEventListener(t,i,1);for(const t of s)e.addEventListener(t,i,0);this.Yt=1}qt(t,e,i){let n=this.Qt.get(t);n||(n=new Map,this.Qt.set(t,n));let s=n.get(e);return s||(s=[],n.set(e,s)),s.push(i),()=>{try{const n=this.Qt.get(t),s=n?.get(e);if(!s)return;const o=s.indexOf(i);o>-1&&s.splice(o,1)}catch{}}}}}();if("undefined"!=typeof window){const t=window;t.XTool=n,t.FyneJS=n}
//# sourceMappingURL=x-tool.min.js.map