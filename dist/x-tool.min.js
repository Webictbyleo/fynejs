"use strict";const t=Array.isArray,e=WeakMap,i=queueMicrotask,s=function(){const s=Array.from,n=t,o=Object.keys,r=()=>{},c="style",h="display",l="none",f="tagName",u="TEMPLATE",a="length";let d=1;const y="undefined"!=typeof document?document:null,p="contents",m=["click","input","change","keydown","keyup"];try{if(y&&y.head&&!y.getElementById("x-tool-initial-css")){const t=y.createElement(c);t.id="x-tool-initial-css",t.textContent="[x-show],[x-if],[x-else],[x-else-if],[x\\:show],[x\\:if],[x\\:else],[x\\:else-if]{display:none;}",y.head.appendChild(t)}}catch{}let w="x",b=new Map;const v=t=>{const e=b.get(t);if(e)return e;const i=`${w}-${t}`;return b.set(t,i),i};class x{attachToParent(t){this.t=t,t.e(this)}get id(){return this.i}get framework(){return this.s}get element(){return this.n}set element(t){this.n=t}get isBound(){return this.o}set isBound(t){this.o=t}get isMounted(){return this.r}set isMounted(t){this.r=t}get isDestroyed(){return this.c}set isDestroyed(t){this.c=t}h(){for(const t of this.l.values())for(const e of t.values())try{e()}catch{}this.l.clear()}f(){this.h()}setFrozen(t){if(t!==this.u)if(this.u=t,t)this.a=this.d,this.d=1,this.f();else{this.d=null!==this.a?this.a:0,this.a=null;try{this.y()}catch{}}}p(t){t!==this.d&&(this.d=t,t&&this.f())}m(t,e){const i=this.w.get(t)||[];i.push(e),this.w.set(t,i)}constructor(t,i,s){this.b=0,this.v=0,this.n=null,this.o=0,this.r=0,this.c=0,this.x=0,this.g=[],this.t=null,this.$={},this._={},this.M=new Map,this.E=new Map,this.A=0,this.k=0,this.R=new Set,this.F=0,this.w=new Map,this.C=new Set,this.D=new AbortController,this.l=new Map,this.S=new e,this.O=0,this.d=0,this.u=0,this.a=null,this.T=1,this.j=new Set,this.P=null,this.z=new e,this.I=new Map,this.L=new Map,this.B=null,this.N=0,this.q=[],this.U=null,this.K=null,this.W=new e,this.V={},this.X=null,this.Z=t=>{const e=this.G[t];"function"==typeof e&&this.H(()=>this.J(e,[]))},this.Q=t=>{if("function"!=typeof t)return;const e=()=>{try{t()}catch{}this.C.delete(e)};return this.C.add(e),()=>{this.C.delete(e)}},this.i=t,this.s=s,this.Y=i.methods||{},this.$=i.computed||{},this._=i.propEffects||{},this.F=!(!i.computed||!Object.keys(i.computed).length),this.G={mounted:i.mounted,unmounted:i.unmounted||i.destroyed,updated:i.updated,beforeMount:i.beforeMount,beforeUnmount:i.beforeUnmount||i.beforeDestroy},this.V=i.data||{},this.tt=this.et(this.V||{}),this.it=this.st()}callBeforeMount(){this.x||(this.Z("beforeMount"),this.x=1)}nt(t){if(this.isBound){const e=this;if(null!=e.U)try{cancelAnimationFrame(e.U)}catch{}if(0==this.T)return;const i=e.j,s=e.L.get(t);if(s)for(let t=0;t<s.length;t++)i.add(s[t]);e.U=requestAnimationFrame(()=>{e.M.clear();const t=e.U;if(e.U=null,null!=t)try{cancelAnimationFrame(t)}catch{}if(!e.isDestroyed&&!e.d){for(const t of i)e.H(t);i.clear(),!e.F&&d||e.y(),e.Z("updated")}})}}st(){const t={};for(const e in this.Y){const i=this.Y[e];t[e]=(...t)=>{const s=this.k,n=this.P;this.k=1,this.P=e;try{return this.H(()=>this.J(i,t))}finally{this.k=s,this.P=n}}}return t}ot(t){if(this.rt(t),this.M.has(t))return this.M.get(t);try{const e=this.$[t];this.A=1,this.E.set(t,new Set);const i=e.call(this.ct());return this.A=0,this.M.set(t,i),i}catch(t){return void(this.A=0)}}rt(t){if(!this.B)return;let e=this.L.get(t);e||(e=[],this.L.set(t,e)),e.includes(this.B)||e.push(this.B)}y(){this.d||this.u||this.c||this.N||(this.N=1,requestAnimationFrame(()=>{const t=this.K;if(this.K=null,null!=t)try{cancelAnimationFrame(t)}catch{}if(this.N=0,this.c||this.d)this.q&&this.q.length&&(this.q.length=0);else if(this.ht(),this.q&&this.q.length){const t=this.q.splice(0,this.q.length);for(const e of t)try{e()}catch{}}}))}H(t,e){try{return t()}catch(t){return e}}bindToElement(t){this.o||(this.n=t,this.x||this.callBeforeMount(),this.completeBinding())}getContext(t=1){return this.ct(t)}lt(){if(this.n){try{this.ft(this.n)}catch{}this.y()}}completeBinding(){!this.o&&this.n&&(this.s.ut(this.n)||this.s.at(this.n,this),this.o=1,this.r=1,this.ft(this.n),this.ht(),this.Z("mounted"))}e(t){this.g.includes(t)||this.g.push(t)}dt(t){const e=this.g.indexOf(t);e>-1&&this.g.splice(e,1)}J(t,e){try{const i=t+"";if(!/\[native code\]/.test(i)){let t=i.trim();return/^function[\s\(]/.test(t)||/^[\w\$_][\w\d\$_]*\s*=>/.test(t)||/^\(.*?\)\s*=>/.test(t)||(t="function "+t),Function("thisArg","argsArray","ctx","with(ctx){ const f = ("+t+"); return f.apply(thisArg, argsArray); }").call(void 0,this.ct(),e,this.yt(void 0,void 0))}}catch{}return t.apply(this.ct(),e)}destroy(){const t=this;if(!t.c){t.Z("beforeUnmount");for(const e of t.g)e.isDestroyed||e.destroy();t.t&&t.t.dt(t);for(const[e,i]of t.w)for(const s of i)if("custom"===s.type&&s.customDirective?.unbind)try{s.customDirective.unbind(e,t)}catch{r()}t.w.clear();try{t.D.abort()}catch{}if(t.D=new AbortController,t.h(),t.pt(),t.M.clear(),t.I.clear(),t.L.clear(),t.X&&t.mt)for(const e of t.X.L.values()){const i=e.indexOf(t.mt);i>-1&&e.splice(i,1)}if(t.n&&t.s.wt(t.n),null!=t.U){try{cancelAnimationFrame(t.U)}catch{}t.U=null}if(null!=t.K){try{cancelAnimationFrame(t.K)}catch{}t.K=null}t.Z("unmounted"),t.c=1,t.r=0,t.o=0,t.g=[],t.t=null,this.bt=new e,this.j.clear(),t.n=null,i(()=>t.s.vt(t.i)),this.tt={},this.V={},this.it={},this.$={},this._={},this.B=null}}xt(t,e){if(!t||!e)return;let i;this.X=e;try{i=Function("ctx","with(ctx){return ("+t+")}")}catch{return}const s=()=>{let t;e.B=s;try{const s=e.getContext(1);t=i(s)}catch{t=null}if(e.B=null,t&&"object"==typeof t){this.tt.$props=this.tt.$props||{},this.b=1;for(const e in t){const i=t[e];this.tt[e]!==i&&(this.tt[e]=i)}this.b=0}};this.mt=s,s()}pt(){for(const t of this.C)try{t()}catch{}this.C.clear()}gt(t,e,i,s){const n=this.D.signal;if("boolean"==typeof s)t.addEventListener(e,i,{capture:s,signal:n});else if(s){const o=s.signal&&s.signal!==n?s:{...s,signal:n};t.addEventListener(e,i,o)}else t.addEventListener(e,i,{signal:n})}$t(t){let e=this.S.get(t);return e||(e=(++this.O).toString(36),this.S.set(t,e)),e}ft(t){const e=this,i=(t,i=0)=>{if(!i&&(t.hasAttribute(v("data"))||this.s.ut(t)))return 0;const s="COMPONENT"===t[f],n=w+"-",o=w+":",r=[];let c=0,h=null;const l=t.getAttributeNames();for(let t=0;t<l.length;t++){const e=l[t];(e.startsWith(n)||e.startsWith(o))&&(r.push(e),c||e!==v("text")&&e!==v("html")||(c=1),h||e!==v("for")||(h=e))}if(r.length>0){if(h)return e._t(t,h,t.getAttribute(h)||""),0;for(const i of r)e._t(t,i,t.getAttribute(i)||"")}return c||e.Mt(t),i||!s};i(t,1),e.Et(t,i)}Mt(t){const e=Array.from(t.childNodes);for(const i of e){if(i.nodeType!==Node.TEXT_NODE)continue;const e=i,s=e.nodeValue||"";if(e.At||-1===s.indexOf("{{"))continue;const n=[];let o=0;for(;o<s.length;){if(92===s.charCodeAt(o)){let t=0;const e=o;for(;o<s.length&&92===s.charCodeAt(o);)t++,o++;if(s.startsWith("{{",o)){const i=s.indexOf("}}",o+2);if(-1===i){n.push({type:"lit",text:s.slice(e)});break}t>1&&n.push({type:"lit",text:"\\".repeat(t-1)}),n.push({type:"lit",text:s.slice(o,i+2)}),o=i+2;continue}n.push({type:"lit",text:s.slice(e,o)});continue}if(s.startsWith("{{",o)){const t=s.indexOf("}}",o+2);if(-1===t){n.push({type:"lit",text:s.slice(o)});break}const e=s.slice(o+2,t).trim();n.push(0===e.length?{type:"lit",text:"{{}}"}:{type:"expr",code:e}),o=t+2;continue}const t=s.indexOf("\\",o),e=s.indexOf("{{",o);let i=s.length;-1!==t&&t<i&&(i=t),-1!==e&&e<i&&(i=e),n.push({type:"lit",text:s.slice(o,i)}),o=i}if(!n.some(t=>"expr"===t.type)){e.At=1;const t=n.map(t=>t.text||"").join("");e.textContent!==t&&(e.textContent=t);continue}const r=[];for(const e of n)"expr"===e.type&&r.push(this.kt(e.code,t));e.At=1;const c=()=>{let t="",i=0;for(const e of n)if("lit"===e.type)t+=e.text;else{const e=r[i++]();t+=null==e?"":e+""}e.textContent!==t&&(e.textContent=t)},h={type:"text-interpolation",expression:s,update:void 0};this.m(t,h);const l=this.Rt(c,h);h.update=l}}Et(t,e){let i=t.firstElementChild;for(;i;){const t=i.nextElementSibling;e(i)&&this.Et(i,e),i=t}}_t(t,e,i){const s=this,n=e.startsWith(w+":"),o=e.slice(w.length+1);if(n||"class"===o||o===c)return t.removeAttribute(e),s.Ft(t,o,i);if("text"===o||"html"===o||"show"===o)return t.removeAttribute(e),s.Ct(t,i,o);if(!("model"===o?(t.removeAttribute(e),s.Dt(t,i),1):"if"===o?(t.removeAttribute(e),s.St(t,i),1):"for"===o&&(t.removeAttribute(e),s.Ot(t,i),1))&&o.indexOf(":")>-1){const[n,r]=o.split(":",2),[c,...h]=r.split("."),l=h.reduce((t,e)=>(e&&(t[e]=1),t),{});if("on"===n){t.removeAttribute(e);const n=s.framework.Tt(c);return n?s.jt(t,c,i,n,l):s.Pt(t,c,i,l)}return t.removeAttribute(e),s.Ft(t,c,i)}}Rt(t,e){const i=()=>{this.B=i;try{t()}finally{this.B=null}};if(i(),this.R.add(i),d&&e&&void 0===e.zt){let t=0;for(const e of this.L.values())if(e.includes(i)){t=1;break}e.zt=!t}return i}Ct(t,e,i){if("class"===i||i===c)return this.Ft(t,i,e);const s=this.kt(e,t);let n,o;"show"===i&&(n=t.style[h]!==l?t.style[h]:void 0);const r={type:i,expression:e,update:void 0,originalDisplay:n};this.m(t,r);const f=this.Rt(()=>{const e=s(),r=t;switch(i){case"text":r.textContent=e+"";break;case"html":r.innerHTML=(e||"")+"";break;case"show":const t=!!e;if(o===t)return;o=t,r.style[h]=t?n||"":l}},r);r.update=f}Dt(t,e){const i="checkbox"===t.type,s="number"===t.type||"range"===t.type,n="SELECT"===t.tagName&&1==t.multiple;Reflect.has(this.tt,e)||Reflect.defineProperty(this.tt,e,{configurable:1,enumerable:1,writable:1});const o=this.kt(e,t),r=this.It(e+" = $value",1),c=i?(()=>{if(t.hasAttribute("value"))return t.value;const e=this.Lt(t);if(e){const t=Object.keys(e);if(1===t.length)return e[t[0]]}return t.value})():void 0;this.Rt(()=>(e=>{if(i)if(Array.isArray(e)){const i=t.hasAttribute("value")?t.value:c;t.checked=null!=i?e.includes(i):0}else t.checked=!!e;else{if(n){const i=t,s=Array.isArray(e)?e:[];for(let t=0;t<i.options.length;t++){const e=i.options[t];e.selected=s.includes(e.value)}return}t.value=(e??(s?0:""))+""}})(o()));const h=this.yt(void 0,t),l=t.type;this.gt(t,"SELECT"===t[f]||"checkbox"===l||"radio"===l||"file"===l?"change":"input",()=>{const e=(()=>{if(i)return Array.isArray(o())&&void 0!==c?t.checked?c:void 0:t.hasAttribute("value")?t.checked?t.value:void 0:t.checked;if(n){const e=t,i=[];for(let t=0;t<e.options.length;t++){const s=e.options[t];s.selected&&i.push(s.value)}return i}return s?parseFloat(t.value)||0:t.value})(),l=this.H(()=>o());if(i&&Array.isArray(l)){const e=l,i=t.hasAttribute("value")?t.value:c;if(void 0!==i){const s=e.indexOf(i);t.checked?-1===s&&e.push(i):s>-1&&e.splice(s,1)}}else if(n&&Array.isArray(l)){const t=l;t.splice(0,t.length),e.forEach(e=>t.push(e))}else h.$value=e,this.H(()=>{r.call(this.ct(),h)})}),this.m(t,{type:"model",property:e})}St(t,e){const i=this,s=y.createComment("x-if");t.parentNode?.insertBefore(s,t),t.Bt=s.parentElement||null;const n=[],o=t=>{if(t[f]===u){const e=y.createElement("div");return e.style[h]=p,e.appendChild(t.content.cloneNode(1)),{el:e,isTemplate:1}}return{el:t,isTemplate:0}},r=o(t),c=i.kt(e,t);n.push({el:r.el,test:c,isTemplate:r.isTemplate}),r.isTemplate||(r.el.Nt=1);const l=[t];{let e=t.nextElementSibling;for(;e;){const t=e.hasAttribute("x-else"),s=e.hasAttribute("x-else-if");if(!t&&!s)break;if(e.hasAttribute("x-else-if")){const t=e.getAttribute("x-else-if")||"",s=o(e),r=i.kt((t||"").trim(),e);n.push({el:s.el,test:r,isTemplate:s.isTemplate}),s.isTemplate||(s.el.Nt=1)}else{const t=o(e);n.push({el:t.el,test:null,isTemplate:t.isTemplate}),t.isTemplate||(t.el.Nt=1)}e.removeAttribute("x-else"),e.removeAttribute("x-else-if"),l.push(e),e=e.nextElementSibling}}let d=-1;for(const t of l)t.parentNode&&t.parentNode.removeChild(t);const m=e=>{if(e<0)return;const o=n[e];o.el.Nt||(i.ft(o.el),o.el.Nt=1),t.qt?.parentNode?.removeChild(t.qt),o.el.parentNode||s.parentNode?.insertBefore(o.el,s.nextSibling),t.qt=o.el,d=e},w=i.Rt(()=>{let t=-1;for(let e=0;e<n[a];e++){const i=n[e];if(!i.test||i.test()){t=e;break}}t!==d&&(-1!==d?((t,e)=>{if(t<0)return void(e&&e());const i=n[t];i.el.parentNode?(i.el.parentNode&&i.el.parentNode.removeChild(i.el),e&&e()):e&&e(),d=-1})(d,()=>m(t)):m(t))});i.m(t,{type:"if",expression:e,update:w})}Pt(t,e,s,n){const r=this,c=(s||"").trim(),h=r.Ut(c),l=n?{once:!!n.once,passive:!!n.passive,capture:!!n.capture}:void 0,f=!!n?.self,u=!!n?.prevent,a=!!n?.stop,d=!!n?.outside,p=!!n?.defer,w={enter:["enter"],esc:["escape","esc"],escape:["escape","esc"],space:[" ","space","spacebar"],tab:["tab"],backspace:["backspace"],delete:["delete","del"],del:["delete","del"],arrowup:["arrowup","up"],arrowdown:["arrowdown","down"],arrowleft:["arrowleft","left"],arrowright:["arrowright","right"],home:["home"],end:["end"],pageup:["pageup"],pagedown:["pagedown"]},b={ctrl:!!n?.ctrl,alt:!!n?.alt,shift:!!n?.shift,meta:!!n?.meta},v={left:0,middle:1,right:2},x=!!n?.single,g=!!n?.multi,$=n?o(n):[],_=[];for(const t of $){const e=w[t.toLowerCase()];e&&_.push(...e)}const M=[];for(const t of $){const e=v[t.toLowerCase()];void 0!==e&&M.push(e)}const E=_.length>0||b.ctrl||b.alt||b.shift||b.meta,A=M.length>0,k=x||g,R=e=>{const i=e.composedPath?e.composedPath():null,s=i&&i.length?i[0]:e.target;if(d){if(!s)return 0;if(t instanceof Node&&(t===s||t.contains(s)))return 0}if(f&&e.target!==t)return 0;if(k){if(!(e instanceof TouchEvent))return 0;{const t=e.touches.length;if(x&&1!==t)return 0;if(g&&t<2)return 0}}if(A){if(!(e instanceof MouseEvent))return 0;if(!M.includes(e.button))return 0}if(E){if(!(e instanceof KeyboardEvent))return 0;const t=(e.key||"").toLowerCase();if(_.length>0&&!_.includes(t))return 0;if(b.ctrl&&!e.ctrlKey)return 0;if(b.alt&&!e.altKey)return 0;if(b.shift&&!e.shiftKey)return 0;if(b.meta&&!e.metaKey)return 0}return 1},F=!!c;let C=null;const D=r.ct();if(h){const e=r.Kt(h.paramsList,h.body,h.isBlock),i=h.paramsList.length?e=>h.paramsList.map((i,s)=>0===s?e:1===s?t:void 0):()=>[];C=s=>{const n=r.yt(s,t);e.call(D,n,...i(s))}}else if(F){const e=c.includes(";"),i=r.It(c,e);C=e=>{const s=r.yt(e,t),n=i.call(D,s);"function"==typeof n&&n.call(D,e)}}const S=t=>{if(R(t)&&(u&&"function"==typeof t.preventDefault&&t.preventDefault(),a&&"function"==typeof t.stopPropagation&&t.stopPropagation(),C)){if(p&&"function"==typeof i){const e=t;return void i(()=>r.H(()=>C(e)))}r.H(()=>C(t))}},O=!!this.framework.Wt().delegate&&m.includes(e);if(!d&&O){const i=this.framework.Vt(t,e,{filter:t=>R(t),run:t=>S(t),once:!!n?.once,comp:this});this.Q(i)}else{const i=d?t?.ownerDocument||y||document:t;r.gt(i,e,S,l)}}It(t,e=0){const i=`${e?"s":"r"}:${t}`;let s=this.I.get(i);return s||(s=Function("ctx",`with(ctx){${e?t:`return (${t})`}}`),this.I.set(i,s)),s}kt(t,e){const i=this,s=i.It(t);return()=>this.H(()=>s.call(i.ct(),i.yt(void 0,e)))}Ut(t){let e=t.match(/^\s*\(\s*([^)]*?)\s*\)\s*=>\s*([\s\S]+)$/);if(e||(e=t.match(/^\s*([a-zA-Z_$][a-zA-Z0-9_$]*)\s*=>\s*([\s\S]+)$/)),!e)return null;const i=(e[1]||"").split(",").map(t=>t.trim()).filter(Boolean),s=(e[2]||"").trim(),n=s.startsWith("{")&&s.endsWith("}");return{paramsList:i,body:n?s.slice(1,-1):s,isBlock:n}}Kt(t,e,i){return Function("ctx",...t,"with(ctx){ "+(i?e:"return ( "+e+" );")+" }")}Xt(i,s){if(Object.getPrototypeOf(i)!==Object.prototype&&!t(i))return i;const n=this;if(this.bt||(this.bt=new e),this.bt.has(i))return this.bt.get(i);const o=new Proxy(i,{get:(e,i,o)=>{if(t(e)){if(i===Symbol.iterator)return n.rt(s),Reflect.get(e,i,o);("length"===i||"string"==typeof i&&/^\d+$/.test(i))&&n.rt(s)}else n.rt(s);const r=Reflect.get(e,i,o);return t(e)&&"function"==typeof r&&["push","pop","shift","unshift","splice","reverse","copyWithin","fill","sort"].includes(i)?function(...t){if(n.A)throw Error(`[x-tool] Mutation via '${s+""}.${i+""}()' is not allowed during computed evaluation.`);if(n.u)throw Error(`[x-tool] Mutation via '${s+""}.${i+""}()' is not allowed while component is frozen.`);const o=e,c=o.length,h=o[0],l=o[c-1],f=r.apply(e,t);return n.d||o.length===c&&o[0]===h&&o[o.length-1]===l||n.nt(s),f}:r&&"object"==typeof r?n.Xt(r,s):r},ownKeys:t=>Reflect.ownKeys(t),has:(t,e)=>Reflect.has(t,e),set:(t,e,i)=>{if(n.c)return 1;if(n.A)throw Error(`[x-tool] Mutation of '${s+""+("symbol"==typeof e?"":"."+e)}' is not allowed during computed evaluation.`);if(n.u)throw Error(`[x-tool] Mutation of '${s+""+("symbol"==typeof e?"":"."+e)}' is not allowed while component is frozen.`);if("symbol"==typeof e)return 1;const o=Reflect.has(t,e),r=o?Reflect.get(t,e):void 0;if(i&&"object"==typeof i&&(i=n.Xt(i,"symbol"==typeof e?s:s+"."+e)),!o){try{Reflect.defineProperty(t,e,{configurable:1,enumerable:1,writable:1,value:i})}catch{Reflect.set(t,e,i)}return n.nt(s),1}return r===i||(Reflect.set(t,e,i),n.d||n.nt(s)),1},deleteProperty:(t,e)=>{if(n.A)throw Error(`[x-tool] Deletion of '${s+""+("symbol"==typeof e?"":"."+e)}' is not allowed during computed evaluation.`);if(n.u)throw Error(`[x-tool] Deletion of '${s+""+("symbol"==typeof e?"":"."+e)}' is not allowed while component is frozen.`);const i=Reflect.deleteProperty(t,e);return i&&!n.d&&n.nt(s),i}});return this.bt.set(i,o),o}et(e){const i=this;return new Proxy(e,{get:(t,e,s)=>{const n=Reflect.get(t,e,s);return e===Symbol.iterator?n:("symbol"!=typeof e&&i.rt(e),n&&"object"==typeof n?i.Xt(n,e):n)},ownKeys:t=>Reflect.ownKeys(t),has:(t,e)=>Reflect.has(t,e),set:(e,s,n,o)=>{if(i.c)return 1;if(i.u)return 1;if(i.A)throw Error(`[x-tool] Mutation of '${s+""}' is not allowed during computed evaluation.`);if(s===Symbol.iterator&&t(e))return n;const r=Reflect.get(e,s);if(Reflect.has(e,s))Reflect.set(e,s,n,o);else try{Reflect.defineProperty(e,s,{configurable:1,enumerable:1,writable:1,value:n})}catch{Reflect.set(e,s,n,o)}if(this.d||this.nt(s),this.b&&"$props"!==s){const t=e.$props;t&&(t[s]=n);const i=this._[s];!i||this.v||this.d||(this.v=1,this.H(()=>i.call(this.ct(),n,r)),this.v=0)}return 1}})}ct(t=1){const e={$log:()=>{},$destroy:()=>this.destroy(),$forceUpdate:()=>this.y(),$addCleanupFunction:t=>this.Q(t),$nextTick:t=>t?(this.q.push(t),void(this.N||i(()=>{if(!this.N&&this.q.length){const t=this.q.splice(0,this.q.length);for(const e of t)this.H(()=>e())}}))):new Promise(t=>{this.q.push(()=>t()),this.N||i(()=>{if(!this.N&&this.q.length){const t=this.q.splice(0,this.q.length);for(const e of t)this.H(()=>e())}})}),$el:this.n,$id:this.i,$isMounted:this.r,$isDestroyed:this.c,$isSealed:this.d,$isFrozen:this.u,$parent:this.t,$children:this.g,$seal:(t=1)=>{this.p(!!t)},$mutate:t=>{const e=this.k;if(this.T=0,this.A)throw Error("[x-tool] $mutate cannot be used inside computed evaluation; computed getters must be pure.");this.k=0;try{return"function"==typeof t?t():void 0}finally{this.k=e,this.T=1,this.y()}}};let s=this.tt;return this.A&&(s=this.V),new Proxy(s,{get:(t,i)=>i in t?(this.rt(i),t[i]):i in this.$?this.ot(i):i in e?e[i]:this.it[i],set:(t,e,i)=>{if(this.A)throw Error(`[x-tool] Mutation of '${e+""}' is not allowed during computed evaluation.`);if(this.u)throw Error(`[x-tool] Mutation of '${e+""}' is not allowed while component is frozen.`);return this.tt[e]=i,1}})}yt(t,e){const i=this,s=e?this.Lt(e):null,n=s?new Set(o(s)):new Set,r="undefined"!=typeof window?window:void 0,c="undefined"!=typeof document?document:void 0,h=this.framework.Wt(),l=!!h.sandboxExpressions,f=new Set((h.allowGlobals||[]).map(t=>t+"")),u=()=>this.P||"__anonymous__",a=(t,e)=>{const i=u();let s=this.l.get(i);s||(s=new Map,this.l.set(i,s));const n=s.get(t);if(n){try{n()}catch{}s.delete(t)}const o=e();if("function"==typeof o){const e=()=>{try{o()}finally{s?.delete(t)}};s.set(t,e),this.Q(e)}},d=t=>t&&"function"==typeof t.addEventListener?new Proxy(t,{get:(t,e)=>{if("addEventListener"===e)return(e,i,s)=>{if(this.d||this.u)return;t.addEventListener(e,i,s);const n="boolean"==typeof s?s:s?.capture?"1":"0",o="listener:"+this.$t(t)+":"+e+":"+n;a(o,()=>()=>{try{t.removeEventListener(e,i,s)}catch{}})};if("removeEventListener"===e)return(e,i,s)=>{try{t.removeEventListener(e,i,s)}catch{}};if("querySelector"===e)return e=>d(t.querySelector(e));if("querySelectorAll"===e)return e=>Array.from(t.querySelectorAll(e)).map(d);if("getElementById"===e)return e=>d(t.getElementById(e));if("document"===e){const e=t.document;return d(e)||e}if("defaultView"===e){const e=t.defaultView;return d(e)||e}if("body"===e){const e=t.body;return d(e)||e}const i=t[e];if("function"==typeof i)try{return i.bind(t)}catch{return i}return i}}):t,y=(t,e)=>{if(t)return function(...s){if(i.d||i.u)return{observe(){},disconnect(){},unobserve(){}};const n=new t(...s);return a("observer:"+e,()=>()=>{try{n.disconnect()}catch{}}),n}},p={$target:e||null,$event:t||null,...l&&!f.has("setTimeout")?{}:{setTimeout:(t,e,...i)=>{if(this.d||this.u||this.c)return;const s=r?.setTimeout?.(t,e,...i);return null!=s&&a("timeout",()=>()=>{try{r?.clearTimeout?.(s)}catch{}}),s}},...l&&!f.has("clearTimeout")?{}:{clearTimeout:t=>{try{r?.clearTimeout?.(t)}catch{}}},...l&&!f.has("setInterval")?{}:{setInterval:(t,e,...i)=>{if(this.d||this.u)return;const s=r?.setInterval?.(t,e,...i);return null!=s&&a("interval",()=>()=>{try{r?.clearInterval?.(s)}catch{}}),s}},...l&&!f.has("clearInterval")?{}:{clearInterval:t=>{try{r?.clearInterval?.(t)}catch{}}},...l&&!f.has("requestAnimationFrame")?{}:{requestAnimationFrame:t=>{if(this.d||this.u)return;const e=r?.requestAnimationFrame?.(t);return null!=e&&a("raf",()=>()=>{try{r?.cancelAnimationFrame?.(e)}catch{}}),e}},...l&&!f.has("cancelAnimationFrame")?{}:{cancelAnimationFrame:t=>{try{r?.cancelAnimationFrame?.(t)}catch{}}},...l&&!f.has("MutationObserver")?{}:{MutationObserver:y(r?.MutationObserver,"mutation")},...l&&!f.has("ResizeObserver")?{}:{ResizeObserver:y(r?.ResizeObserver,"resize")},...l&&!f.has("IntersectionObserver")?{}:{IntersectionObserver:y(r?.IntersectionObserver,"intersection")},...l&&!f.has("window")?{}:{window:d(r)},...l&&!f.has("document")?{}:{document:d(c)}};return new Proxy({},{get:(t,e)=>s&&e in s?s[e]:e in i.tt?i.tt[e]:e in i.$?i.ot(e):e in i.it?i.it[e]:e in p?p[e]:void 0,set:(t,e,o)=>(s&&n.has(e)?s[e]=o:i.tt[e]=o,1),has:(t,e)=>!(!s||!(e in s))||e in i.tt||e in i.$||e in i.it||e in p})}jt(t,e,i,s,n){const o=this,r=o.kt(i,t),c={type:"custom",expression:i,customDirective:s};s.bind&&o.H(()=>s.bind(t,r(),i,o,n,r));const h=o.Rt(()=>{s.update&&o.H(()=>s.update(t,r(),i,o,n,r))});c.update=h,o.m(t,c)}Ft(e,i,s){const n=this,o=n.kt(s,e);if("class"===i){const t=e;if(!n.W.get(t)){const e=new Set,i=t.className||"";if(i)for(const t of i.split(/\s+/))t&&e.add(t);n.W.set(t,e)}}const r=e;let h=null;if(i in r)h=i;else{const t=i.replace(/-([a-z])/g,(t,e)=>e.toUpperCase());t in r?h=t:"readonly"===i.toLowerCase()&&"readOnly"in r&&(h="readOnly")}const l=!(!h||"boolean"!=typeof r[h]),f=!(!h||!(h in r)||"function"==typeof r[h]),u=!!x.Zt[i.toLowerCase()],a=n.Rt(()=>{const s=o();if("class"===i){const i=e,o=n.W.get(i);if("string"==typeof s)i.className=o&&o.size?[...o].join(" ")+(s?" "+s:""):s||"";else if(t(s))i.className=o&&o.size?[...o,...s.filter(Boolean)].join(" "):s.filter(Boolean).join(" ");else if(s&&"object"==typeof s){o&&o.size&&(i.className=[...o].join(" "));for(const t in s){const e=!!s[t];if(!t)continue;const n=t.split(/\s+/);for(let t=0;t<n.length;t++){const s=n[t];s&&i.classList.toggle(s,e)}}}else null==s&&o&&o.size?i.className=[...o].join(" "):null==s&&i.removeAttribute("class");return}if(i===c){const t=e;return"string"==typeof s?void(t.style.cssText=s):s&&"object"==typeof s?void Object.assign(t.style,s):void(null==s&&t.removeAttribute("style"))}if(l&&h||u){const t=!!s;return h&&l&&(r[h]=t),void(t?e.setAttribute(i,""):e.removeAttribute(i))}let a=null;if(s&&"object"==typeof s){const t=[];for(const e in s)s[e]&&t.push(e);a=t.length?t.join(" "):null}else null!=s&&(a=s+"");if(f&&h)if(null!==a)try{r[h]=a}catch(t){try{e.setAttribute(i,a)}catch{}}else e.removeAttribute(i);else null!==a?e.getAttribute(i)!==a&&e.setAttribute(i,a):e.hasAttribute(i)&&e.removeAttribute(i)});n.m(e,{type:"bind",expression:s,update:a})}Lt(t){if(!t)return null;if(!t.parentElement){const e=t.qt;if(e&&e.parentElement)t=e;else{const e=t.Bt;e&&(t=e)}}const e={};let i=t;for(;i;){const t=this.z.get(i);if(t&&Object.assign(e,t),i===this.element)break;i=i.parentElement}return o(e).length?e:null}Gt(t){for(const[e,i]of this.w)for(const s of i)if((t===e||e instanceof Element&&t.contains(e))&&s.update){if(d&&s.zt)continue;s.update()}}Ot(t,e){const i=this,o=e.trim().match(/^(?:\(\s*([^,\s]+)\s*(?:,\s*([^\)]+))?\s*\)|([^,\s]+))\s+(in|of)\s+(.+)$/);if(!o)return;const r=o[1]||o[3],c=o[2],l=o[5],a=y.createComment("x-for");let d;t.parentNode?.insertBefore(a,t),t[f]===u?(d=y.createElement("div"),d.style[h]=p,d.appendChild(t.content.cloneNode(1)),t.parentNode?.removeChild(t)):(d=t,t.parentNode?.removeChild(t));const m=a.parentElement||i.element,w=i.kt(l.trim(),m),b=[],v=(t,e)=>{const i={[r]:t};return c&&(i[c]=e),i},x=new WeakMap;let g=0;const $=(t,e,i)=>{if(t&&"object"==typeof t){const e=(t=>{if(!t||"object"!=typeof t)return null;const e=t.id??t.i??t.key;if(null==e)return null;const i=typeof e;return"string"===i||"number"===i?"id:"+e:null})(t);if(e)return e;let i=x.get(t);return i||(i="o#"+ ++g,x.set(t,i)),i}const s="p#"+typeof t+":"+t,n=(i.get(s)||0)+1;return i.set(s,n),s+"#"+n},_={type:"for",expression:e},M=i.Rt(()=>{const t=i.H(()=>{const t=w();if(n(t))return{list:t,keys:null};if("undefined"!=typeof Map&&t instanceof Map)return{list:s(t.values()),keys:s(t.keys())};if("undefined"!=typeof Set&&t instanceof Set)return{list:s(t.values()),keys:null};if(t&&"function"==typeof t[Symbol.iterator])return{list:s(t),keys:null};if(t&&"object"==typeof t){const e=Object.keys(t);return{list:e.map(e=>t[e]),keys:e}}return{list:[],keys:null}},{list:[],keys:null}),e=t.list,o=t.keys,r=new Map,c=Array(e.length);for(let t=0;t<e.length;t++)c[t]=o?o[t]+"":$(e[t],0,r);const h=new Map;for(let t=0;t<b.length;t++){const e=b[t],i=e.Ht;i&&h.set(i,e)}const l=Array(e.length);for(let t=0;t<e.length;t++){const s=c[t],n=h.get(s);if(n){l[t]=n,i.z.set(n,v(e[t],o?o[t]:t));const r=e[t];n.Jt!==r&&(i.Gt(n),n.Jt=r),h.delete(s)}else{const s=d.cloneNode(1);s.removeAttribute("x-for"),i.z.set(s,v(e[t],o?o[t]:t));try{i.ft(s)}catch{}s.Jt=e[t],l[t]=s}l[t].Ht=s}for(const[,t]of h)t&&t.parentNode&&t.parentNode.removeChild(t);const f=a.parentNode;if(f){const t=b.map(t=>t.Ht);let e=t.length!==l.length;if(!e)for(let i=0;i<l.length;i++)if(t[i]!==l[i].Ht){e=1;break}if(e){for(let t=0;t<b.length;t++){const e=b[t];e.parentNode===f&&f.removeChild(e)}let t=a;for(let e=0;e<l.length;e++){const i=l[e];f.insertBefore(i,t.nextSibling),t=i}}else{let t=a;for(let e=0;e<l.length;e++){const i=l[e];t.nextSibling!==i&&f.insertBefore(i,t.nextSibling),t=i}}}b.length=0;for(let t=0;t<l.length;t++)b.push(l[t])},_);_.update=M,i.m(a,_)}ht(){const t=this;for(const e of t.w.values())for(const t of e)if((!d||!t.zt)&&t.update)try{t.update()}catch(t){}}}return x.Zt={itemscope:1,formnovalidate:1,novalidate:1,default:1,readonly:1},new class{constructor(){this.Qt=new Map,this.Yt=new e,this.te=[],this.ee={},this.ie=new Map,this.se=new Map,this.ne=new e,this.oe=0,this.directive=(t,e)=>{if(t.startsWith(w+"-"))throw Error(`Custom directive names should not start with "${w}-". Use: XTool.directive("my-directive", ...)`);return this.ie.set(t,e),this},this.registerComponent=t=>{if(!t||!t.name)throw Error("registerComponent requires a name");const e=t.name.toLowerCase();if(this.se.has(e))throw Error(`Component name "${e}" already registered`);return this.se.set(e,t),this},this.re=t=>this.se.get(t.toLowerCase()),this.Tt=t=>this.ie.get(t),this.Wt=()=>this.ee,this.ce=[],this.init=(t={})=>{this.ee={container:"body",debug:0,staticDirectives:1,...t},"boolean"==typeof this.ee.staticDirectives&&(d=this.ee.staticDirectives);const e=this.ee.prefix;w=e&&"string"==typeof e&&e[a]>0?e:"x",b.clear();const i=async()=>{if(this.he(),this.ce.length)try{await Promise.allSettled(this.ce)}catch{}this.le();const t=y?.querySelector(this.ee.container);t&&(this.fe(t),this.ee.delegate&&this.ue(t))};return y&&"loading"===y.readyState?y.addEventListener("DOMContentLoaded",()=>{i()}):y&&"complete"!==y.readyState&&"interactive"!==y.readyState||i(),this},this.ae=new Map,this.de=new Map,this.loadComponents=t=>{const e=t.map(t=>"string"==typeof t?{path:t,mode:"preload",name:void 0}:{path:t.path,mode:t.mode||"preload",name:t.name}),i=[];for(const t of e)if("defer"===t.mode){const e=this.ye(t.path).catch(()=>{throw Error("load failed")});this.ce.push(e),i.push(e.then(()=>{}))}else if("lazy"===t.mode){const e=(t.name||t.path.split("/").pop()||"").replace(/\.(mjs|js|ts)(\?.*)?$/i,"").toLowerCase();e&&!this.de.has(e)&&this.de.set(e,{path:t.path,status:0})}else{const e=this.ye(t.path).catch(()=>{throw Error("load failed")});i.push(e)}return Promise.allSettled(i).then(t=>{try{this.le()}catch{}return{settled:t.length,failed:t.filter(t=>"rejected"===t.status).length}})},this.createComponent=t=>{const e=new x(this.pe(),t,this);return this.Qt.set(e.id,e),e.callBeforeMount(),e},this.le=()=>{const t=y?.querySelector(this.ee.container);if(!t)return;const e=t.querySelectorAll(`[${v("data")}]`);for(const t of e)this.ut(t)||this.me(t);const i=t.querySelectorAll("component[source]");for(const t of i)this.ut(t)||this.we(t);if(this.be(),0===e[a]&&!this.ut(t)){const e=s(this.Qt.values()),i=e[e[a]-1];i&&!i.isBound&&i.bindToElement(t)}},this.be=()=>{if(this.te[a]){for(const t of this.te){let e,i=t.el.parentElement;for(;i&&!e;){const t=this.ut(i);t?e=t:i=i.parentElement}e&&t.comp.attachToParent(e)}for(const t of this.te)t.comp.completeBinding();this.te=[]}},this.me=(t,e)=>{const s=t.getAttribute(v("data"));let n={};if(s){t.removeAttribute(v("data"));try{if(e){let t={};try{t=e.ct?.()||{}}catch{t={}}n=Function("parent",`with(parent){ return (${s}) }`)(t)}else n=this.ve(s);n=n.methods?{methods:n.methods,data:{...n}}:{data:{...n}},e&&(n.data.$parent=e)}catch(t){}}const o=this.createComponent(n);o.element=t,o.callBeforeMount(),this.at(o.element,o),this.te.push({el:t,comp:o});const r=t.getAttribute(v("init"));if(r){t.removeAttribute(v("init"));const e=o.G?.mounted;o.G.mounted=function(){if(e)try{e.call(this)}catch{}const t=Function("ctx","with(ctx){"+r+"} ");i(()=>{if(!o.isDestroyed&&o.element&&o.element.isConnected)try{const e=o.ct?.()||o.getContext?.()||{},i=t(e);if("function"==typeof i)try{i()}catch{}}catch{}})}}},this.pe=()=>{const t=Date.now(),e=Math.random().toString(36).substring(2,15);return`component_${t}_${(this.Qt.size+1).toString(36)}_${e}`},this.ve=t=>{try{return Function("return "+t.trim())()}catch{return{}}},this.vt=t=>{this.Qt.delete(t)},this.xe=()=>{},this.at=(t,e)=>{this.Yt.set(t,e)},this.wt=t=>{try{this.Yt.delete(t)}catch{}}}ye(t,e=2,i=300){const s=this.ae.get(t);if(s)return s;const n=this,o=(t,...e)=>t.reduce((t,i,s)=>t+i+(s<e.length?e[s]:""),""),r=s=>fetch(t,{cache:"no-cache"}).then(t=>{if(!t.ok)throw Error(t.status+" "+t.statusText);return t.text()}).then(e=>{Function("XTool","html",e+"\n//# sourceURL="+t)(n,o)}).catch(t=>{if(s>=e)throw t;const n=i*Math.pow(2,s);return new Promise(t=>setTimeout(t,n)).then(()=>r(s+1))}),c=r(0).finally(()=>{this.ae.delete(t)});return this.ae.set(t,c),c}he(){if(!y)return;if("x"===w)return;const t="x-tool-initial-css-"+w;if(y.head&&!y.getElementById(t)){const e=y.createElement(c);e.id=t,e.textContent=`[${w}-show],[${w}-if],[${w}-else],[${w}-else-if],[${w}\\:show],[${w}\\:if],[${w}\\:else],[${w}\\:else-if]{display:none;}`,y.head.appendChild(e)}}fe(t){this.ge||"undefined"==typeof MutationObserver||(this.ge=new MutationObserver(t=>{for(const e of t)if("childList"===e.type){for(let t=0;t<e.addedNodes.length;t++){const i=e.addedNodes[t];if(1!==i.nodeType)continue;const s=i;"COMPONENT"===s[f]&&s.getAttribute("source")&&!this.ut(s)&&this.we(s)}for(let t=0;t<e.removedNodes.length;t++){const s=e.removedNodes[t];if(1!==s.nodeType)continue;const n=s;i(()=>{if(n.isConnected)return;const t=[n];for(;t.length;){const e=t.pop(),i=this.ut(e);if(i&&!i.isDestroyed)try{i.destroy()}catch{}let s=e.firstElementChild;for(;s;)t.push(s),s=s.nextElementSibling}})}}else if("attributes"===e.type){const t=e.target;if(t&&"COMPONENT"===t[f])if("source"===e.attributeName)this.$e(t);else if("readonly"===e.attributeName){const e=this.ut(t);if(e)try{const i=t.hasAttribute("readonly");e.setFrozen(!!i)}catch{}}}this.be()}),this.ge.observe(t,{childList:1,subtree:1,attributes:1,attributeFilter:["source","readonly"]}))}$e(t){const e=(t.getAttribute("source")||"").trim(),i=this.ut(t);if(e){if(i&&!i.isDestroyed)try{i.destroy()}catch{}t.innerHTML="",this.we(t)}else{if(i&&!i.isDestroyed)try{i.destroy()}catch{}t.innerHTML=""}}we(t){const e=t.getAttribute("source");if(!e)return;let i,s=this.re(e);if(!s){const i=e.toLowerCase(),s=this.de?.get(i);return void(s&&(0===s.status&&(s.status=1,s.promise=this.ye(s.path).then(()=>{s.status=2}).catch(()=>{s.status=3})),s.promise?.then(()=>{try{this.re(e)&&this.we(t)}catch{}})))}let n=t.parentElement;for(;n&&!i;){const t=this.ut(n);t?i=t:n=n.parentElement}let o=null,r=null,c=null;o||(o={});const h=t.getAttribute(v("prop"));if(h){if(c=h,i)try{r=Function("ctx","with(ctx){return ("+h+")}")(i.getContext(1))}catch{r=null}else try{r=Function("return ("+h+")")()}catch{r=null}if(r&&"object"==typeof r)for(const t in r)t in o||(o[t]=r[t]+"");t.removeAttribute(v("prop"))}let l,f={};if(s.makeData)try{f=s.makeData(o)||{}}catch{f={}}if(s.data)for(const t in s.data)f[t]=s.data[t];for(const t in o)t in f||(f[t]=o[t]);if(f.$props=o,"function"==typeof s.init)try{const t=s.init(o);l=t&&"object"==typeof t?t:void 0}catch{l=void 0}const u={data:f,methods:{...s.methods||{},...l?.methods||{}},computed:{...s.computed||{},...l?.computed||{}},propEffects:{...s.propEffects||{},...l?.propEffects||{}},mounted:l?.mounted||s.mounted,unmounted:l?.unmounted||s.unmounted,beforeMount:l?.beforeMount||s.beforeMount,beforeUnmount:l?.beforeUnmount||s.beforeUnmount,updated:l?.updated||s.updated,destroyed:l?.destroyed||s.destroyed,beforeDestroy:l?.beforeDestroy||s.beforeDestroy},a=this.createComponent(u);a.element=t;const d=Array.from(t.childNodes);if(d.length&&t.replaceChildren(),s.template){const e=e=>{t.innerHTML=e;const i=t.querySelectorAll("slot");if(i.length)for(const t of i){const e=t.getAttribute("name"),i=d.filter(e?t=>1===t.nodeType&&t.getAttribute("slot")===e:t=>1!==t.nodeType||!t.hasAttribute("slot"));i.length&&t.replaceWith(...i)}},i=s.template;if("string"==typeof i)e(i);else if("function"==typeof i)try{const s=i();s&&"function"==typeof s.then?(t.innerHTML="",s.then(t=>{e(t||"");try{a.lt()}catch{}})):e((s||"")+"")}catch{t.innerHTML=""}else i&&"function"==typeof i.then&&(t.innerHTML="",i.then(t=>{e(t||"");try{a.lt()}catch{}}))}else d.length&&t.append(...d);this.at(t,a);try{const e=t.querySelectorAll(`[${v("data")}]`);for(const t of e)this.ut(t)||this.me(t,a)}catch{}if(this.te.push({el:t,comp:a}),c&&i)try{a.xt(c,i)}catch{}this.be()}ut(t){return this.Yt.get(t)}observe(t){}ue(t){if(this.oe)return;const e=t,i=t=>{let i=t.target;for(;i&&i!==e.parentElement&&!t.cancelBubble;){const e=this.ne.get(i);if(e){const i=e.get(t.type);if(i&&i.length)for(const e of[...i])try{if(e.comp&&e.comp.isDestroyed){const t=i.indexOf(e);t>-1&&i.splice(t,1);continue}if((!e.filter||e.filter(t))&&(e.run(t),e.once)){const t=i.indexOf(e);t>-1&&i.splice(t,1)}}catch{}}i=i.parentElement}},s=["keydown","keyup"],n=["click","input","change"];for(const t of s)e.addEventListener(t,i,1);for(const t of n)e.addEventListener(t,i,0);this.oe=1}Vt(t,e,i){let s=this.ne.get(t);s||(s=new Map,this.ne.set(t,s));let n=s.get(e);return n||(n=[],s.set(e,n)),n.push(i),()=>{try{const s=this.ne.get(t),n=s?.get(e);if(!n)return;const o=n.indexOf(i);o>-1&&n.splice(o,1)}catch{}}}}}();if("undefined"!=typeof window){const t=window;t.XTool=s,t.FyneJS=s}
//# sourceMappingURL=x-tool.min.js.map