"use strict";const t=Array.isArray,e=WeakMap,i=function(){const i=Array.from,n=t,s=Object.keys,o=()=>{},r="style",c="display",h="none",f="tagName",l="TEMPLATE",u="length";let a=1;const d="undefined"!=typeof document?document:null,y="contents",p=["click","input","change","keydown","keyup"];try{if(d&&d.head&&!d.getElementById("x-tool-initial-css")){const t=d.createElement(r);t.id="x-tool-initial-css",t.textContent="[x-show],[x-if],[x-else],[x-else-if],[x\\:show],[x\\:if],[x\\:else],[x\\:else-if]{display:none;}",d.head.appendChild(t)}}catch{}let m="x";const w=t=>`${m}-${t}`;class v{attachToParent(t){this.t=t,t.e(this)}get id(){return this.i}get framework(){return this.n}get element(){return this.s}set element(t){this.s=t}get isBound(){return this.o}set isBound(t){this.o=t}get isMounted(){return this.r}set isMounted(t){this.r=t}get isDestroyed(){return this.c}set isDestroyed(t){this.c=t}h(t,e){const i=this.f.get(t)||[];i.push(e),this.f.set(t,i)}constructor(t,i,n){this.l=0,this.u=0,this.s=null,this.o=0,this.r=0,this.c=0,this.a=0,this.d=[],this.t=null,this.y={},this.p={},this.m=new Map,this.w=new Map,this.v=new Map,this.b=0,this.x=0,this._=new Set,this.g=0,this.f=new Map,this.M=new Set,this.$=null,this.k=new Map,this.E=new Map,this.A=new Map,this.D={mutation:new Map,resize:new Map,intersection:new Map},this.O=[],this.R=new e,this.S=new Map,this.C=new Map,this.T=null,this.j=0,this.F=[],this.P=new e,this.q=null,this.I=t=>{const e=this.N[t];"function"==typeof e&&this.B(()=>this.L(e,[]))},this.z=t=>{if("function"!=typeof t)return;const e=()=>{try{t()}catch{}try{this.M.delete(e)}catch{}};return this.M.add(e),()=>{try{this.M.delete(e)}catch{}}},this.U=(t,e,i,n)=>{t.addEventListener(e,i,n),this.O.push({element:t,event:e,handler:i,options:n})},this.i=t,this.n=n,this.K=i.methods||{},this.y=i.computed||{},this.p=i.propEffects||{},this.g=!(!i.computed||!Object.keys(i.computed).length),this.N={mounted:i.mounted,unmounted:i.unmounted||i.destroyed,updated:i.updated,beforeMount:i.beforeMount,beforeUnmount:i.beforeUnmount||i.beforeDestroy},this.W=this.V(i.data||{}),this.Z=this.G()}callBeforeMount(){this.a||(this.I("beforeMount"),this.a=1)}J(t){if(this.isBound){this.m.clear();const e=new Set,i=this.C.get(t);if(i)for(let t=0;t<i.length;t++)e.add(i[t]);for(const t of e)this.B(t);!this.g&&a||this.X(),this.I("updated")}}G(){const t={};for(const e in this.K){const i=this.K[e];t[e]=(...t)=>{const n=this.x,s=this.$;this.x=1,this.$=e;try{return this.B(()=>this.L(i,t))}finally{this.x=n,this.$=s}}}return t}H(t){if(this.Q(t),this.m.has(t))return this.m.get(t);try{const e=this.y[t];this.b=1;const i=this.w.get(t);if(i)for(const e of i){const i=this.v.get(e);i&&i.delete(t)}this.w.set(t,new Set);const n=e.call(this.Y());return this.b=0,this.m.set(t,n),n}catch{return void(this.b=0)}}Q(t){if(!this.T)return;let e=this.C.get(t);e||(e=[],this.C.set(t,e)),e.includes(this.T)||e.push(this.T)}X(){this.j||(this.j=1,requestAnimationFrame(()=>{if(this.j=0,this.tt(),this.F&&this.F.length){const t=this.F.splice(0,this.F.length);for(const e of t)try{e()}catch{}}}))}B(t,e){try{return t()}catch(t){return console.error(t),e}}bindToElement(t){this.o||(this.s=t,this.a||this.callBeforeMount(),this.completeBinding())}getContext(t=1){return this.Y(t)}et(){if(this.s){try{this.it(this.s)}catch{}this.X()}}completeBinding(){!this.o&&this.s&&(this.n.nt(this.s)||this.n.st(this.s,this),this.o=1,this.r=1,this.it(this.s),this.tt(),this.I("mounted"))}e(t){this.d.includes(t)||this.d.push(t)}ot(t){const e=this.d.indexOf(t);e>-1&&this.d.splice(e,1)}L(t,e){try{const i=t+"";if(!/\[native code\]/.test(i)){let t=i.trim();return/^function[\s\(]/.test(t)||/^[\w\$_][\w\d\$_]*\s*=>/.test(t)||/^\(.*?\)\s*=>/.test(t)||(t="function "+t),Function("thisArg","argsArray","ctx","with(ctx){ const f = ("+t+"); return f.apply(thisArg, argsArray); }").call(void 0,this.Y(),e,this.rt(void 0,void 0))}}catch{}return t.apply(this.Y(),e)}destroy(){const t=this;if(!t.c){t.I("beforeUnmount");for(const e of t.d)e.isDestroyed||e.destroy();t.t&&t.t.ot(t);for(const[e,i]of t.f)for(const n of i)if("custom"===n.type&&n.customDirective?.unbind)try{n.customDirective.unbind(e,t)}catch{o()}t.f.clear();for(const{element:e,event:i,handler:n,options:s}of t.O)e.removeEventListener(i,n,s);t.O=[];for(const e of Array.from(t.M))try{e()}catch{o()}if(t.M.clear(),t.m.clear(),t.S.clear(),t.C.clear(),t.q&&t.ct)for(const e of t.q.C.values()){const i=e.indexOf(t.ct);i>-1&&e.splice(i,1)}t.s&&t.n.ht(t.s),t.I("unmounted"),t.c=1,t.r=0,t.o=0,t.d=[],t.t=null,this.ft=new e,t.s=null,queueMicrotask(()=>t.n.lt(t.i))}}ut(t,e){if(!t||!e)return;let i;this.q=e;try{i=Function("ctx","with(ctx){return ("+t+")}")}catch{return}const n=()=>{let t;e.T=n;try{const n=e.getContext(1);t=i(n)}catch{t=null}if(e.T=null,t&&"object"==typeof t){this.W.$props=this.W.$props||{},this.l=1;for(const e in t){const i=t[e];this.W[e]!==i&&(this.W[e]=i)}this.l=0}};this.ct=n,n()}it(t){const e=this,i=(t,i=0)=>{if(!i&&(t.hasAttribute(w("data"))||this.n.nt(t)))return 0;const n="COMPONENT"===t[f],s=[];let o=0,r=null;for(const e of t.attributes){const t=e.name;(t.startsWith(m+"-")||t.startsWith(m+":"))&&(s.push(e),o||t!==w("text")&&t!==w("html")||(o=1),r||t!==w("for")||(r=e))}if(s.length>0){if(r)return e.at(t,r.name,r.value),0;for(const i of s)e.at(t,i.name,i.value)}return o||e.dt(t),i||!n};i(t,1),e.yt(t,i)}dt(t){const e=Array.from(t.childNodes);for(const i of e){if(i.nodeType!==Node.TEXT_NODE)continue;const e=i,n=e.nodeValue||"";if(e.pt||-1===n.indexOf("{{"))continue;const s=(e.parentElement?.tagName||"").toLowerCase(),o="code"===s||"pre"===s,r=[];let c=0;for(;c<n.length;){const t=n.indexOf("{{",c);if(-1===t){r.push({literal:n.slice(c)});break}let e=0;for(let i=t-1;i>=0&&92===n.charCodeAt(i);i--)e++;if(e>0){const i=t-e;i>c&&r.push({literal:n.slice(c,i)}),e>1&&r.push({literal:"\\".repeat(e-1)});const s=n.indexOf("}}",t+2);if(-1===s){r.push({literal:n.slice(t,n.length)}),c=n.length;break}r.push({literal:n.slice(t,s+2)}),c=s+2;continue}{t>c&&r.push({literal:n.slice(c,t)});const e=n.indexOf("}}",t+2);if(-1===e){r.push({literal:n.slice(t)}),c=n.length;break}const i=n.slice(t+2,e).trim();r.push(i?{expr:i}:{literal:""}),c=e+2;continue}}const h=r.some(t=>t.expr),f=r.some(t=>t.literal&&t.literal.includes("{{"));if(!h&&!f)continue;e.pt=1;const l=h&&!o?r.filter(t=>t.expr).map(e=>this.mt(e.expr,t)):[];let u=0;const a=()=>{u=0;let t="";for(const e of r)if(null!=e.literal)t+=e.literal;else if(e.expr)if(o)t+="{{ "+e.expr+" }}";else{const e=l[u++]();t+=null==e?"":e+""}e.textContent!==t&&(e.textContent=t)},d={type:"text-interpolation",expression:n,update:void 0};this.h(t,d);const y=this.wt(a,d);d.update=y}}yt(t,e){let i=t.firstElementChild;for(;i;){const t=i.nextElementSibling;e(i)&&this.yt(i,e),i=t}}at(t,e,i){const n=this,s=e.startsWith(m+":"),o=e.slice(m.length+1);if(s||"class"===o||o===r)return t.removeAttribute(e),n.vt(t,o,i);if("text"===o||"html"===o||"show"===o)return t.removeAttribute(e),n.bt(t,i,o);if(!("model"===o?(t.removeAttribute(e),n.xt(t,i),1):"if"===o?(t.removeAttribute(e),n._t(t,i),1):"for"===o&&(t.removeAttribute(e),n.gt(t,i),1))&&o.indexOf(":")>-1){const[s,r]=o.split(":",2),[c,...h]=r.split("."),f=h.reduce((t,e)=>(e&&(t[e]=1),t),{});if("on"===s){t.removeAttribute(e);const s=n.framework.Mt(c);return s?n.$t(t,c,i,s,f):n.kt(t,c,i,f)}return t.removeAttribute(e),n.vt(t,c,i)}}wt(t,e){const i=()=>{this.T=i;try{t()}finally{this.T=null}};if(i(),this._.add(i),a&&e&&void 0===e.Et){let t=0;for(const e of this.C.values())if(e.includes(i)){t=1;break}e.Et=!t}return i}bt(t,e,i){if("class"===i||i===r)return this.vt(t,i,e);const n=this.mt(e,t);let s,o;"show"===i&&(s=t.style[c]!==h?t.style[c]:void 0);const f={type:i,expression:e,update:void 0,originalDisplay:s};this.h(t,f);const l=this.wt(()=>{const e=n(),r=t;switch(i){case"text":r.textContent=e+"";break;case"html":r.innerHTML=(e||"")+"";break;case"show":const t=!!e;if(o===t)return;o=t,r.style[c]=t?s||"":h}},f);f.update=l}xt(t,e){const i="checkbox"===t.type,n="number"===t.type||"range"===t.type,s="SELECT"===t.tagName&&1==t.multiple;Reflect.has(this.W,e)||Reflect.defineProperty(this.W,e,{configurable:1,enumerable:1,writable:1});const o=this.mt(e,t),r=this.At(e+" = $value",1),c=i?(()=>{if(t.hasAttribute("value"))return t.value;const e=this.Dt(t);if(e){const t=Object.keys(e);if(1===t.length)return e[t[0]]}return t.value})():void 0;this.wt(()=>(e=>{if(i)if(Array.isArray(e)){const i=t.hasAttribute("value")?t.value:c;t.checked=null!=i?e.includes(i):0}else t.checked=!!e;else{if(s){const i=t,n=Array.isArray(e)?e:[];for(let t=0;t<i.options.length;t++){const e=i.options[t];e.selected=n.includes(e.value)}return}t.value=(e??(n?0:""))+""}})(o()));const h=this.rt(void 0,t),l=t.type;this.U(t,"SELECT"===t[f]||"checkbox"===l||"radio"===l||"file"===l?"change":"input",()=>{const e=(()=>{if(i)return Array.isArray(o())&&void 0!==c?t.checked?c:void 0:t.hasAttribute("value")?t.checked?t.value:void 0:t.checked;if(s){const e=t,i=[];for(let t=0;t<e.options.length;t++){const n=e.options[t];n.selected&&i.push(n.value)}return i}return n?parseFloat(t.value)||0:t.value})(),f=this.B(()=>o());if(i&&Array.isArray(f)){const e=f,i=t.hasAttribute("value")?t.value:c;if(void 0!==i){const n=e.indexOf(i);t.checked?-1===n&&e.push(i):n>-1&&e.splice(n,1)}}else if(s&&Array.isArray(f)){const t=f;t.splice(0,t.length),e.forEach(e=>t.push(e))}else h.$value=e,this.B(()=>{r.call(this.Y(),h)})}),this.h(t,{type:"model",property:e})}_t(t,e){const i=this,n=d.createComment("x-if");t.parentNode?.insertBefore(n,t),t.Ot=n.parentElement||null;const s=[],o=t=>{if(t[f]===l){const e=d.createElement("div");return e.style[c]=y,e.appendChild(t.content.cloneNode(1)),{el:e,isTemplate:1}}return{el:t,isTemplate:0}},r=o(t),h=i.mt(e,t);s.push({el:r.el,test:h,isTemplate:r.isTemplate}),r.isTemplate||(r.el.Rt=1);const a=[t];{let e=t.nextElementSibling;for(;e;){const t=e.hasAttribute("x-else"),n=e.hasAttribute("x-else-if");if(!t&&!n)break;if(e.hasAttribute("x-else-if")){const t=e.getAttribute("x-else-if")||"",n=o(e),r=i.mt((t||"").trim(),e);s.push({el:n.el,test:r,isTemplate:n.isTemplate}),n.isTemplate||(n.el.Rt=1)}else{const t=o(e);s.push({el:t.el,test:null,isTemplate:t.isTemplate}),t.isTemplate||(t.el.Rt=1)}e.removeAttribute("x-else"),e.removeAttribute("x-else-if"),a.push(e),e=e.nextElementSibling}}let p=-1;for(const t of a)t.parentNode&&t.parentNode.removeChild(t);const m=e=>{if(e<0)return;const o=s[e];o.el.Rt||(i.it(o.el),o.el.Rt=1),t.St?.parentNode?.removeChild(t.St),o.el.parentNode||n.parentNode?.insertBefore(o.el,n.nextSibling),t.St=o.el,p=e},w=i.wt(()=>{let t=-1;for(let e=0;e<s[u];e++){const i=s[e];if(!i.test||i.test()){t=e;break}}t!==p&&(-1!==p?((t,e)=>{if(t<0)return void(e&&e());const i=s[t];i.el.parentNode?(i.el.parentNode&&i.el.parentNode.removeChild(i.el),e&&e()):e&&e(),p=-1})(p,()=>m(t)):m(t))});i.h(t,{type:"if",expression:e,update:w})}kt(t,e,i,n){const o=this,r=(i||"").trim(),c=o.Ct(r),h=n?{once:!!n.once,passive:!!n.passive,capture:!!n.capture}:void 0,f=!!n?.self,l=!!n?.prevent,u=!!n?.stop,a=!!n?.outside,y=!!n?.defer,m={enter:["enter"],esc:["escape","esc"],escape:["escape","esc"],space:[" ","space","spacebar"],tab:["tab"],backspace:["backspace"],delete:["delete","del"],del:["delete","del"],arrowup:["arrowup","up"],arrowdown:["arrowdown","down"],arrowleft:["arrowleft","left"],arrowright:["arrowright","right"],home:["home"],end:["end"],pageup:["pageup"],pagedown:["pagedown"]},w={ctrl:!!n?.ctrl,alt:!!n?.alt,shift:!!n?.shift,meta:!!n?.meta},v={left:0,middle:1,right:2},b=!!n?.single,x=!!n?.multi,_=n?s(n):[],g=[];for(const t of _){const e=m[t.toLowerCase()];e&&g.push(...e)}const M=[];for(const t of _){const e=v[t.toLowerCase()];void 0!==e&&M.push(e)}const $=g.length>0||w.ctrl||w.alt||w.shift||w.meta,k=M.length>0,E=b||x,A=e=>{const i=e.composedPath?e.composedPath():null,n=i&&i.length?i[0]:e.target;if(a){if(!n)return 0;if(t instanceof Node&&(t===n||t.contains(n)))return 0}if(f&&e.target!==t)return 0;if(E){if(!(e instanceof TouchEvent))return 0;{const t=e.touches.length;if(b&&1!==t)return 0;if(x&&t<2)return 0}}if(k){if(!(e instanceof MouseEvent))return 0;if(!M.includes(e.button))return 0}if($){if(!(e instanceof KeyboardEvent))return 0;const t=(e.key||"").toLowerCase();if(g.length>0&&!g.includes(t))return 0;if(w.ctrl&&!e.ctrlKey)return 0;if(w.alt&&!e.altKey)return 0;if(w.shift&&!e.shiftKey)return 0;if(w.meta&&!e.metaKey)return 0}return 1},D=!!r;let O=null;const R=o.Y();if(c){const e=o.Tt(c.paramsList,c.body,c.isBlock),i=c.paramsList.length?e=>c.paramsList.map((i,n)=>0===n?e:1===n?t:void 0):()=>[];O=n=>{const s=o.rt(n,t);e.call(R,s,...i(n))}}else if(D){const e=r.includes(";"),i=o.At(r,e);O=e=>{const n=o.rt(e,t),s=i.call(R,n);"function"==typeof s&&s.call(R,e)}}const S=t=>{if(A(t)&&(l&&"function"==typeof t.preventDefault&&t.preventDefault(),u&&"function"==typeof t.stopPropagation&&t.stopPropagation(),O)){if(y&&"function"==typeof queueMicrotask){const e=t;return void queueMicrotask(()=>o.B(()=>O(e)))}o.B(()=>O(t))}},C=!!this.framework.jt().delegate&&p.includes(e);if(!a&&C){const i=this.framework.Ft(t,e,{filter:t=>A(t),run:t=>S(t),once:!!n?.once,comp:this});this.z(i)}else{const i=a?t?.ownerDocument||d||document:t;o.U(i,e,S,h)}}At(t,e=0){const i=`${e?"s":"r"}:${t}`;let n=this.S.get(i);return n||(n=Function("ctx",`with(ctx){${e?t:`return (${t})`}}`),this.S.set(i,n)),n}mt(t,e){const i=this,n=i.At(t);return()=>this.B(()=>n.call(i.Y(),i.rt(void 0,e)))}Ct(t){let e=t.match(/^\s*\(\s*([^)]*?)\s*\)\s*=>\s*([\s\S]+)$/);if(e||(e=t.match(/^\s*([a-zA-Z_$][a-zA-Z0-9_$]*)\s*=>\s*([\s\S]+)$/)),!e)return null;const i=(e[1]||"").split(",").map(t=>t.trim()).filter(Boolean),n=(e[2]||"").trim(),s=n.startsWith("{")&&n.endsWith("}");return{paramsList:i,body:s?n.slice(1,-1):n,isBlock:s}}Tt(t,e,i){return Function("ctx",...t,"with(ctx){ "+(i?e:"return ( "+e+" );")+" }")}Pt(i,n){if(Object.getPrototypeOf(i)!==Object.prototype&&!t(i))return i;const s=this;if(this.ft||(this.ft=new e),this.ft.has(i))return this.ft.get(i);const o=new Proxy(i,{get:(e,i,o)=>{if(t(e)){if(i===Symbol.iterator)return s.Q(n),Reflect.get(e,i,o);("length"===i||"string"==typeof i&&/^\d+$/.test(i))&&s.Q(n)}else s.Q(n);const r=Reflect.get(e,i,o);return t(e)&&"function"==typeof r&&["push","pop","shift","unshift","splice","sort","reverse","copyWithin","fill"].includes(i)?function(...t){if(s.b)throw Error(`[x-tool] Mutation via '${n+""}.${i+""}()' is not allowed during computed evaluation.`);const o=e,c=o.length,h=o[0],f=o[c-1],l=r.apply(e,t);return o.length===c&&o[0]===h&&o[o.length-1]===f||s.J(n),l}:r&&"object"==typeof r?s.Pt(r,n):r},ownKeys:t=>Reflect.ownKeys(t),has:(t,e)=>Reflect.has(t,e),set:(t,e,i)=>{if(s.c)return 1;if(s.b)throw Error(`[x-tool] Mutation of '${n+""+("symbol"==typeof e?"":"."+e)}' is not allowed during computed evaluation.`);if("symbol"==typeof e)return 1;const o=Reflect.has(t,e),r=o?Reflect.get(t,e):void 0;if(i&&"object"==typeof i&&(i=s.Pt(i,"symbol"==typeof e?n:n+"."+e)),!o){try{Reflect.defineProperty(t,e,{configurable:1,enumerable:1,writable:1,value:i})}catch{Reflect.set(t,e,i)}return s.J(n),1}return r===i||(Reflect.set(t,e,i),s.J(n)),1},deleteProperty:(t,e)=>{if(s.b)throw Error(`[x-tool] Deletion of '${n+""+("symbol"==typeof e?"":"."+e)}' is not allowed during computed evaluation.`);return Reflect.deleteProperty(t,e)}});return this.ft.set(i,o),o}V(e){const i=this;return new Proxy(e,{get:(t,e,n)=>{const s=Reflect.get(t,e,n);return e===Symbol.iterator?s:("symbol"!=typeof e&&i.Q(e),s&&"object"==typeof s?i.Pt(s,e):s)},ownKeys:t=>Reflect.ownKeys(t),has:(t,e)=>Reflect.has(t,e),set:(e,n,s,o)=>{if(i.c)return 1;if(i.b)throw Error(`[x-tool] Mutation of '${n+""}' is not allowed during computed evaluation.`);if(n===Symbol.iterator&&t(e))return s;const r=Reflect.get(e,n);if(s&&"object"==typeof s&&(s=i.Pt(s,n)),r===s)return 1;if(Reflect.has(e,n))Reflect.set(e,n,s,o);else try{Reflect.defineProperty(e,n,{configurable:1,enumerable:1,writable:1,value:s})}catch{Reflect.set(e,n,s,o)}if(this.J(n),this.l&&"$props"!==n){const t=e.$props;t&&(t[n]=s);const i=this.p[n];i&&!this.u&&(this.u=1,this.B(()=>i.call(this.Y(),s,r)),this.u=0)}return 1}})}Y(t=1){const e={$log:()=>{},$destroy:()=>this.destroy(),$forceUpdate:()=>this.X(),$addCleanupFunction:t=>this.z(t),$nextTick:t=>t?(this.F.push(t),void(this.j||queueMicrotask(()=>{if(!this.j&&this.F.length){const t=this.F.splice(0,this.F.length);for(const e of t)this.B(()=>e())}}))):new Promise(t=>{this.F.push(()=>t()),this.j||queueMicrotask(()=>{if(!this.j&&this.F.length){const t=this.F.splice(0,this.F.length);for(const e of t)this.B(()=>e())}})}),$el:this.s,$id:this.i,$isMounted:this.r,$isDestroyed:this.c,$parent:this.t,$children:this.d,$mutate:t=>{const e=this.x;if(this.b)throw Error("[x-tool] $mutate cannot be used inside computed evaluation; computed getters must be pure.");this.x=0;try{return"function"==typeof t?t():void 0}finally{this.x=e,this.X()}}};return new Proxy(this.W,{get:(t,i)=>i in t?(this.Q(i),t[i]):i in this.y?this.H(i):i in e?e[i]:this.Z[i],set:(t,e,i)=>{if(this.b)throw Error(`[x-tool] Mutation of '${e+""}' is not allowed during computed evaluation.`);return this.W[e]=i,1}})}rt(t,i){const n=this,o=i?this.Dt(i):null,r=o?new Set(s(o)):new Set,c="undefined"!=typeof window?window:void 0,h="undefined"!=typeof document?document:void 0,f=this.framework.jt(),l=!!f.sandboxExpressions,u=new Set((f.allowGlobals||[]).map(t=>t+"")),a=new e,d=t=>{if(!t)return t;if("function"!=typeof t.addEventListener)return t;const i=new e,s=(t,e)=>{try{return t+"|"+(void 0===e?"":"object"==typeof e?JSON.stringify(e):e+"")}catch{return t+"|"}};return new Proxy(t,{get(t,e,o){if("addEventListener"===e)return function(e,o,r){const c=n.$||"__anonymous__",h=s(e,r);let f=a.get(t);f||(f=new Map,a.set(t,f));let l=f.get(c);l||(l=new Map,f.set(c,l));const u=l.get(h);if(u){try{t.removeEventListener(e,u.handler,u.options)}catch{}try{u.remover&&u.remover()}catch{}l.delete(h)}t.addEventListener(e,o,r);const d=n.z(()=>{try{t.removeEventListener(e,o,r)}catch{}});try{if("function"==typeof o&&d){let t=i.get(o);t||(t=new Map,i.set(o,t)),t.set(h,d)}}catch{}l.set(h,{handler:o,options:r,remover:d})};if("removeEventListener"===e)return function(e,n,o){try{t.removeEventListener(e,n,o)}catch{}const r=s(e,o);try{if("function"==typeof n){const t=i.get(n);if(t){const e=t.get(r);if(e){try{e()}catch{}t.delete(r)}0===t.size&&i.delete(n)}}}catch{}const c=a.get(t);if(c)for(const[t,e]of c){const i=e.get(r);if(i&&i.handler===n){try{i.remover&&i.remover()}catch{}e.delete(r),0===e.size&&c.delete(t);break}}};if("querySelector"===e)return function(e){const i=t.querySelector(e);return d(i)};if("querySelectorAll"===e)return function(e){const i=t.querySelectorAll(e);return Array.from(i).map(d)};if("getElementById"===e)return function(e){const i=t.getElementById(e);return d(i)};if("document"===e){const e=t.document;return d(e)||e}if("body"===e&&t===h){const e=t.body;return d(e)||e}if("defaultView"===e&&t===h){const e=t.defaultView;return d(e)||e}const r=t[e];if("function"==typeof r)try{return r.bind(t)}catch{}return r}})},y=new Map,p=new Map,m=new Map,w=(t,e)=>{if(!t)return;const i=function(...i){const s=new t(...i),o=n.$||"__anonymous__";let r="mutation"===e?n.D.mutation:"resize"===e?n.D.resize:n.D.intersection;const c=r.get(o);if(c){try{c.inst.disconnect()}catch{}try{c.remover&&c.remover()}catch{}}const h=n.z(()=>{try{s.disconnect()}catch{}});return r.set(o,{inst:s,remover:h}),s};return i.prototype=t.prototype,i},v={$target:i||null,$event:t||null,...l&&!u.has("setTimeout")?{}:{setTimeout:(t,e,...i)=>{const s=n.$||"__anonymous__",o=n.k.get(s);if(o){try{c?.clearTimeout?.(o.id)}catch{}try{o.remover&&o.remover()}catch{}}const r=c?.setTimeout?.(t,e,...i);if(null!=r){const t=n.z(()=>{try{c?.clearTimeout?.(r)}catch{}});y.set(r,t),n.k.set(s,{id:r,remover:t})}return r}},...l&&!u.has("clearTimeout")?{}:{clearTimeout:t=>{try{c?.clearTimeout?.(t)}catch{}finally{try{const e=y.get(t);e&&(e(),y.delete(t))}catch{}}}},...l&&!u.has("setInterval")?{}:{setInterval:(t,e,...i)=>{const s=n.$||"__anonymous__",o=n.E.get(s);if(o){try{c?.clearInterval?.(o.id)}catch{}try{o.remover&&o.remover()}catch{}}const r=c?.setInterval?.(t,e,...i);if(null!=r){const t=n.z(()=>{try{c?.clearInterval?.(r)}catch{}});p.set(r,t),n.E.set(s,{id:r,remover:t})}return r}},...l&&!u.has("clearInterval")?{}:{clearInterval:t=>{try{c?.clearInterval?.(t)}catch{}finally{try{const e=p.get(t);e&&(e(),p.delete(t))}catch{}}}},...l&&!u.has("requestAnimationFrame")?{}:{requestAnimationFrame:t=>{const e=n.$||"__anonymous__",i=n.A.get(e);if(i){try{c?.cancelAnimationFrame?.(i.id)}catch{}try{i.remover&&i.remover()}catch{}}const s=c?.requestAnimationFrame?.(t);if(null!=s){const t=n.z(()=>{try{c?.cancelAnimationFrame?.(s)}catch{}});m.set(s,t),n.A.set(e,{id:s,remover:t})}return s}},...l&&!u.has("cancelAnimationFrame")?{}:{cancelAnimationFrame:t=>{try{c?.cancelAnimationFrame?.(t)}catch{}finally{try{const e=m.get(t);e&&(e(),m.delete(t))}catch{}}}},...l&&!u.has("MutationObserver")?{}:{MutationObserver:w(c?.MutationObserver,"mutation")},...l&&!u.has("ResizeObserver")?{}:{ResizeObserver:w(c?.ResizeObserver,"resize")},...l&&!u.has("IntersectionObserver")?{}:{IntersectionObserver:w(c?.IntersectionObserver,"intersection")},...l&&!u.has("window")?{}:{window:d(c)},...l&&!u.has("document")?{}:{document:d(h)}};return new Proxy({},{get:(t,e)=>o&&e in o?o[e]:e in n.W?n.W[e]:e in n.y?n.H(e):e in n.Z?n.Z[e]:e in v?v[e]:void 0,set:(t,e,i)=>(o&&r.has(e)?o[e]=i:n.W[e]=i,1),has:(t,e)=>!(!o||!(e in o))||e in n.W||e in n.y||e in n.Z||e in v})}$t(t,e,i,n,s){const o=this,r=o.mt(i,t),c={type:"custom",expression:i,customDirective:n};n.bind&&o.B(()=>n.bind(t,r(),i,o,s,r));const h=o.wt(()=>{n.update&&o.B(()=>n.update(t,r(),i,o,s,r))});c.update=h,o.h(t,c)}vt(e,i,n){const s=this,o=s.mt(n,e);if("class"===i){const t=e;if(!s.P.get(t)){const e=new Set,i=t.className||"";if(i)for(const t of i.split(/\s+/))t&&e.add(t);s.P.set(t,e)}}const c=e;let h=null;if(i in c)h=i;else{const t=i.replace(/-([a-z])/g,(t,e)=>e.toUpperCase());t in c?h=t:"readonly"===i.toLowerCase()&&"readOnly"in c&&(h="readOnly")}const f=!(!h||"boolean"!=typeof c[h]),l=!(!h||!(h in c)||"function"==typeof c[h]),u=!!v.qt[i.toLowerCase()],a=s.wt(()=>{const n=o();if("class"===i){const i=e,o=s.P.get(i);if("string"==typeof n)i.className=o&&o.size?[...o].join(" ")+(n?" "+n:""):n||"";else if(t(n))i.className=o&&o.size?[...o,...n.filter(Boolean)].join(" "):n.filter(Boolean).join(" ");else if(n&&"object"==typeof n){o&&o.size&&(i.className=[...o].join(" "));for(const t in n){const e=!!n[t];if(!t)continue;const s=t.split(/\s+/);for(let t=0;t<s.length;t++){const n=s[t];n&&i.classList.toggle(n,e)}}}else null==n&&o&&o.size?i.className=[...o].join(" "):null==n&&i.removeAttribute("class");return}if(i===r){const t=e;return"string"==typeof n?void(t.style.cssText=n):n&&"object"==typeof n?void Object.assign(t.style,n):void(null==n&&t.removeAttribute("style"))}if(f&&h||u){const t=!!n;return h&&f&&(c[h]=t),void(t?e.setAttribute(i,""):e.removeAttribute(i))}let a=null;if(n&&"object"==typeof n){const t=[];for(const e in n)n[e]&&t.push(e);a=t.length?t.join(" "):null}else null!=n&&(a=n+"");if(l&&h)if(null!==a)try{c[h]=a}catch(t){try{e.setAttribute(i,a)}catch{}}else e.removeAttribute(i);else null!==a?e.getAttribute(i)!==a&&e.setAttribute(i,a):e.hasAttribute(i)&&e.removeAttribute(i)});s.h(e,{type:"bind",expression:n,update:a})}Dt(t){if(!t)return null;if(!t.parentElement){const e=t.St;if(e&&e.parentElement)t=e;else{const e=t.Ot;e&&(t=e)}}const e={};let i=t;for(;i;){const t=this.R.get(i);if(t&&Object.assign(e,t),i===this.element)break;i=i.parentElement}return s(e).length?e:null}It(t){for(const[e,i]of this.f)for(const n of i)(t===e||e instanceof Element&&t.contains(e))&&n.update&&n.update()}gt(t,e){const s=this,o=e.trim().match(/^(?:\(\s*([^,\s]+)\s*(?:,\s*([^\)]+))?\s*\)|([^,\s]+))\s+(in|of)\s+(.+)$/);if(!o)return;const r=o[1]||o[3],h=o[2],u=o[5],a=d.createComment("x-for");let p;t.parentNode?.insertBefore(a,t),t[f]===l?(p=d.createElement("div"),p.style[c]=y,p.appendChild(t.content.cloneNode(1)),t.parentNode?.removeChild(t)):(p=t,t.parentNode?.removeChild(t));const m=a.parentElement||s.element,w=s.mt(u.trim(),m),v=[],b=(t,e)=>{const i={[r]:t};return h&&(i[h]=e),i},x={type:"for",expression:e},_=s.wt(()=>{const t=s.B(()=>{const t=w();if(n(t))return{list:t,keys:null};if("undefined"!=typeof Map&&t instanceof Map)return{list:i(t.values()),keys:i(t.keys())};if("undefined"!=typeof Set&&t instanceof Set)return{list:i(t.values()),keys:null};if(t&&"function"==typeof t[Symbol.iterator])return{list:i(t),keys:null};if(t&&"object"==typeof t){const e=Object.keys(t);return{list:e.map(e=>t[e]),keys:e}}return{list:[],keys:null}},{list:[],keys:null}),e=t.list,o=t.keys;if(v.length>e.length)for(;v.length>e.length;){const t=v.pop();t.parentNode&&t.parentNode.removeChild(t)}const r=Math.min(v.length,e.length);for(let t=0;t<r;t++){const i=v[t];s.R.set(i,b(e[t],o?o[t]:t)),s.It(i)}if(e.length>v.length){const t=d.createDocumentFragment(),i=v.length;for(let n=i;n<e.length;n++){const i=p.cloneNode(1);i.removeAttribute("x-for"),s.R.set(i,b(e[n],o?o[n]:n));try{s.it(i)}catch{}t.appendChild(i),v.push(i)}const n=v[i-1]||a;n.parentNode&&n.parentNode.insertBefore(t,n.nextSibling)}},x);x.update=_,s.h(a,x)}tt(){const t=this;for(const e of t.f.values())for(const t of e)if((!a||!t.Et)&&t.update)try{t.update()}catch(t){}}}return v.qt={itemscope:1,formnovalidate:1,novalidate:1,default:1},new class{constructor(){this.Nt=new Map,this.Bt=new e,this.Lt=[],this.zt={},this.Ut=new Map,this.Kt=new Map,this.Wt=new e,this.Vt=0,this.directive=(t,e)=>{if(t.startsWith(m+"-"))throw Error(`Custom directive names should not start with "${m}-". Use: XTool.directive("my-directive", ...)`);return this.Ut.set(t,e),this},this.registerComponent=t=>{if(!t||!t.name)throw Error("registerComponent requires a name");const e=t.name.toLowerCase();if(this.Kt.has(e))throw Error(`Component name "${e}" already registered`);return this.Kt.set(e,t),this},this.Zt=t=>this.Kt.get(t.toLowerCase()),this.Mt=t=>this.Ut.get(t),this.jt=()=>this.zt,this.init=(t={})=>{this.zt={container:"body",debug:0,staticDirectives:1,...t},"boolean"==typeof this.zt.staticDirectives&&(a=this.zt.staticDirectives);const e=this.zt.prefix;if(m=e&&"string"==typeof e&&e[u]>0?e:"x",d&&"loading"===d.readyState)d.addEventListener("DOMContentLoaded",()=>{this.Gt(),this.Jt();const t=d?.querySelector(this.zt.container);t&&(this.Xt(t),this.zt.delegate&&this.Ht(t))});else if(!d||"complete"===d.readyState||"interactive"===d.readyState){this.Gt(),this.Jt();const t=d?.querySelector(this.zt.container);t&&(this.Xt(t),this.zt.delegate&&this.Ht(t))}return this},this.createComponent=t=>{const e=new v(this.Qt(),t,this);return this.Nt.set(e.id,e),e.callBeforeMount(),e},this.Jt=()=>{const t=d?.querySelector(this.zt.container);if(!t)return;const e=t.querySelectorAll(`[${w("data")}]`);for(const t of e)this.nt(t)||this.Yt(t);const n=t.querySelectorAll("component[source]");for(const t of n)this.nt(t)||this.te(t);if(this.ee(),0===e[u]&&!this.nt(t)){const e=i(this.Nt.values()),n=e[e[u]-1];n&&!n.isBound&&n.bindToElement(t)}},this.ee=()=>{if(this.Lt[u]){for(const t of this.Lt){let e,i=t.el.parentElement;for(;i&&!e;){const t=this.nt(i);t?e=t:i=i.parentElement}e&&t.comp.attachToParent(e)}for(const t of this.Lt)t.comp.completeBinding();this.Lt=[]}},this.Yt=(t,e)=>{const i=t.getAttribute(w("data"));let n={};if(i){t.removeAttribute(w("data"));try{if(e){let t={};try{t=e.Y?.()||{}}catch{t={}}n=Function("parent",`with(parent){ return (${i}) }`)(t)}else n=this.ie(i);n=n.methods?{methods:n.methods,data:{...n}}:{data:{...n}},e&&(n.data.$parent=e)}catch(t){}}const s=this.createComponent(n);s.element=t,s.callBeforeMount(),this.st(s.element,s),this.Lt.push({el:t,comp:s});const o=t.getAttribute(w("init"));if(o){t.removeAttribute(w("init"));const e=s.N?.mounted;s.N.mounted=function(){if(e)try{e.call(this)}catch{}const t=Function("ctx","with(ctx){"+o+"} ");queueMicrotask(()=>{if(!s.isDestroyed&&s.element&&s.element.isConnected)try{const e=s.Y?.()||s.getContext?.()||{},i=t(e);if("function"==typeof i)try{i()}catch{}}catch{}})}}},this.Qt=()=>"component_"+Date.now()+"_"+Math.random().toString(36).substring(2,9),this.ie=t=>{try{return Function("return "+t.trim())()}catch{return{}}},this.lt=t=>{this.Nt.delete(t)},this.ne=()=>{},this.st=(t,e)=>{this.Bt.set(t,e)},this.ht=t=>{try{this.Bt.delete(t)}catch{}}}Gt(){if(!d)return;if("x"===m)return;const t="x-tool-initial-css-"+m;if(d.head&&!d.getElementById(t)){const e=d.createElement(r);e.id=t,e.textContent=`[${m}-show],[${m}-if],[${m}-else],[${m}-else-if],[${m}\\:show],[${m}\\:if],[${m}\\:else],[${m}\\:else-if]{display:none;}`,d.head.appendChild(e)}}Xt(t){this.se||"undefined"==typeof MutationObserver||(this.se=new MutationObserver(t=>{for(const e of t)if("childList"===e.type){for(let t=0;t<e.addedNodes.length;t++){const i=e.addedNodes[t];if(1!==i.nodeType)continue;const n=i;"COMPONENT"===n[f]&&n.getAttribute("source")&&!this.nt(n)&&this.te(n)}for(let t=0;t<e.removedNodes.length;t++){const i=e.removedNodes[t];if(1!==i.nodeType)continue;const n=i;queueMicrotask(()=>{if(n.isConnected)return;const t=[n];for(;t.length;){const e=t.pop(),i=this.nt(e);if(i&&!i.isDestroyed)try{i.destroy()}catch{}let n=e.firstElementChild;for(;n;)t.push(n),n=n.nextElementSibling}})}}else if("attributes"===e.type){const t=e.target;t&&"COMPONENT"===t[f]&&"source"===e.attributeName&&this.oe(t)}this.ee()}),this.se.observe(t,{childList:1,subtree:1,attributes:1,attributeFilter:["source"]}))}oe(t){const e=(t.getAttribute("source")||"").trim(),i=this.nt(t);if(e){if(i&&!i.isDestroyed)try{i.destroy()}catch{}t.innerHTML="",this.te(t)}else{if(i&&!i.isDestroyed)try{i.destroy()}catch{}t.innerHTML=""}}te(t){const e=t.getAttribute("source");if(!e)return;const i=this.Zt(e);if(!i)return;let n,s=t.parentElement;for(;s&&!n;){const t=this.nt(s);t?n=t:s=s.parentElement}let o=null,r=null,c=null;o||(o={});const h=t.getAttribute(w("prop"));if(h){if(c=h,n)try{r=Function("ctx","with(ctx){return ("+h+")}")(n.getContext(1))}catch{r=null}else try{r=Function("return ("+h+")")()}catch{r=null}if(r&&"object"==typeof r)for(const t in r)t in o||(o[t]=r[t]+"");t.removeAttribute(w("prop"))}let f,l={};if(i.makeData)try{l=i.makeData(o)||{}}catch{l={}}if(i.data)for(const t in i.data)l[t]=i.data[t];for(const t in o)t in l||(l[t]=o[t]);if(l.$props=o,"function"==typeof i.init)try{const t=i.init(o);f=t&&"object"==typeof t?t:void 0}catch{f=void 0}const u={data:l,methods:{...i.methods||{},...f?.methods||{}},computed:{...i.computed||{},...f?.computed||{}},propEffects:{...i.propEffects||{},...f?.propEffects||{}},mounted:f?.mounted||i.mounted,unmounted:f?.unmounted||i.unmounted,beforeMount:f?.beforeMount||i.beforeMount,beforeUnmount:f?.beforeUnmount||i.beforeUnmount,updated:f?.updated||i.updated,destroyed:f?.destroyed||i.destroyed,beforeDestroy:f?.beforeDestroy||i.beforeDestroy},a=this.createComponent(u);a.element=t;const y=[];for(;t.firstChild;){const e=t.firstChild;y.push(e),t.removeChild(e)}if(i.template){const e=e=>{t.innerHTML=e;const i=t.querySelectorAll("slot");if(i.length)for(const t of i){const e=t.getAttribute("name");let i=[];if(i=y.filter(e?t=>1===t.nodeType&&t.getAttribute("slot")===e:t=>1!==t.nodeType||!t.hasAttribute("slot")),i.length){const e=d.createDocumentFragment();for(const t of i)e.appendChild(t);t.parentNode?.replaceChild(e,t)}}},n=i.template;if("string"==typeof n)e(n);else if("function"==typeof n)try{const i=n();i&&"function"==typeof i.then?(t.innerHTML="",i.then(t=>{e(t||"");try{a.et()}catch{}})):e((i||"")+"")}catch{t.innerHTML=""}else n&&"function"==typeof n.then&&(t.innerHTML="",n.then(t=>{e(t||"");try{a.et()}catch{}}))}else for(const e of y)t.appendChild(e);this.st(t,a);try{const e=t.querySelectorAll(`[${w("data")}]`);for(const t of e)this.nt(t)||this.Yt(t,a)}catch{}if(this.Lt.push({el:t,comp:a}),c&&n)try{a.ut(c,n)}catch{}this.ee()}nt(t){return this.Bt.get(t)}observe(t){}Ht(t){if(this.Vt)return;const e=t,i=t=>{let i=t.target;for(;i&&i!==e.parentElement&&!t.cancelBubble;){const e=this.Wt.get(i);if(e){const i=e.get(t.type);if(i&&i.length)for(const e of[...i])try{if(e.comp&&e.comp.isDestroyed){const t=i.indexOf(e);t>-1&&i.splice(t,1);continue}if((!e.filter||e.filter(t))&&(e.run(t),e.once)){const t=i.indexOf(e);t>-1&&i.splice(t,1)}}catch{}}i=i.parentElement}},n=["keydown","keyup"],s=["click","input","change"];for(const t of n)e.addEventListener(t,i,1);for(const t of s)e.addEventListener(t,i,0);this.Vt=1}Ft(t,e,i){let n=this.Wt.get(t);n||(n=new Map,this.Wt.set(t,n));let s=n.get(e);return s||(s=[],n.set(e,s)),s.push(i),()=>{try{const n=this.Wt.get(t),s=n?.get(e);if(!s)return;const o=s.indexOf(i);o>-1&&s.splice(o,1)}catch{}}}}}();if("undefined"!=typeof window){const t=window;t.XTool=i,t.FyneJS=i}
//# sourceMappingURL=x-tool.min.js.map