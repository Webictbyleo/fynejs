import t from"./src/strip-ts";import{caseKebabToCamel as e}from"./src/util";const n=Array.isArray,i=WeakMap,s=queueMicrotask,o="boolean"==typeof __FEAT_EXT_DIRECTIVES__?__FEAT_EXT_DIRECTIVES__:1,r=function(){const r=t=>{try{t()}catch{}},c=t=>(t||"").trim(),f=Array.from,l=n,h=Object.keys,a="style",u="display",p="none",d="tagName",y="TEMPLATE",w="length",m="source",v="readonly";let b=1;const g="undefined"!=typeof document?document:null,_="contents",x=["click","input","change","keydown","keyup"];try{if(g&&g.head&&!g.getElementById("x-tool-initial-css")){const t=g.createElement(a);t.id="x-tool-initial-css",t.textContent="[x-show],[x-if],[x-else],[x-else-if],[x\\:show],[x\\:if],[x\\:else],[x\\:else-if]{display:none;}",g.head.appendChild(t)}}catch{}let $="x",S=new Map;const M=t=>{const e=S.get(t);if(e)return e;const n=`${$}-${t}`;return S.set(t,n),n};class E{attachToParent(t){this.t=t,t.e(this)}get id(){return this.n}get framework(){return this.i}get element(){return this.s}set element(t){this.s=t}get isBound(){return this.o}set isBound(t){this.o=t}get isMounted(){return this.r}set isMounted(t){this.r=t}get isDestroyed(){return this.c}set isDestroyed(t){this.c=t}f(){for(const t of this.l.values())for(const e of t.values())r(e);this.l.clear()}h(){this.f()}a(t,e){const n=t;let i=e in n?e:null;if(!i){const t=e.replace(/-([a-z])/g,(t,e)=>e.toUpperCase());i=t in n?t:"readonly"===e.toLowerCase()&&"readOnly"in n?"readOnly":null}return{elAny:n,propName:i,isBooleanProp:!(!i||"boolean"!=typeof n[i]),hasNonFunctionProp:!(!i||"function"==typeof n[i]),isKnownBooleanAttr:!!E.u[e.toLowerCase()]}}p(t,e,n,i){const{elAny:s,propName:o,isBooleanProp:r,hasNonFunctionProp:c,isKnownBooleanAttr:f}=i;if(r&&o||f){const i=!!n;return o&&r&&(s[o]=i),void(i?t.setAttribute(e,""):t.removeAttribute(e))}let l=null;if(n&&"object"==typeof n){const t=[];for(const e in n)n[e]&&t.push(e);l=t.length?t.join(" "):null}else null!=n&&(l=String(n));if(c&&o)if(null!==l)try{s[o]=l}catch{try{t.setAttribute(e,l)}catch{}}else t.removeAttribute(e);else null!==l?t.getAttribute(e)!==l&&t.setAttribute(e,l):t.removeAttribute(e)}d(t,e){const n=$+"-",i=$+":",s=[];let o=0,r=null;const c=t.getAttributeNames();for(let t=0;t<c.length;t++){const f=c[t];(f.startsWith(n)||f.startsWith(i)||f.startsWith("@"))&&(e?.skipRootFor&&f===M("for")||(s.push(f),o||f!==M("text")&&f!==M("html")||(o=1),r||f!==M("for")||(r=f)))}return{names:s,hasTextOrHtml:o,forName:r}}setFrozen(t){if(t!==this.w)if(this.w=t,t)this.m=this.v,this.v=1,this.h();else{null!==this.m?this.v=this.m:this.v=0,this.m=null;try{this.b()}catch{}}}g(t){t!==this.v&&(this.v=t,t&&this.h())}_(t,e){const n=this.$.get(t)||[];n.push(e),this.$.set(t,n)}constructor(t,e,n){this.S=0,this.M=0,this.s=null,this.o=0,this.r=0,this.c=0,this.E=0,this.O=[],this.t=null,this.T={},this.A={},this.R=new Map,this.k=new Map,this.F=[],this.D=0,this.j=0,this.C=new Set,this.N=0,this.$=new Map,this.P=new Set,this.I=new AbortController,this.l=new Map,this.L=new i,this.B=0,this.v=0,this.w=0,this.m=null,this.U=1,this.z=new Set,this.K=null,this.q=new i,this.X=new Map,this.H=new Map,this.W=null,this.V=0,this.Z=[],this.G=null,this.J=null,this.Q=new i,this.Y={},this.tt=null,this.et=t=>{const e=this.nt[t];if("function"==typeof e&&this.it(()=>this.st(e,[])),"mounted"===t&&this.ot){const t=this.ot;if(this.isDestroyed||!this.element||!this.element.isConnected)return;const e=()=>{const e=c(t),n=this.rt(e),i=this.ct();if(n){const t=this.ft(n.paramsList,n.body,n.isBlock),e=n.paramsList.length?[this.element]:[],s=t.call(this.lt(void 0,this.element||void 0),i,...e.slice(0,n.paramsList.length));return void("function"==typeof s&&this.ht(s))}const s=this.at(e,-1!==e.indexOf(";")).call(i,this.lt(void 0,this.element||void 0));"function"==typeof s&&this.ht(s)};this.it(()=>this.st(e,[]))}},this.ht=t=>{if("function"!=typeof t)return;const e=()=>{try{t()}catch{}this.P.delete(e)};return this.P.add(e),()=>{this.P.delete(e)}},this.n=t,this.i=n,this.ut=e.methods||{},this.T=this.pt(e.computed||{}),this.A=e.propEffects||{},this.A&&Object.keys(this.A).length&&(this.A=this.dt()),this.N=!(!e.computed||!Object.keys(e.computed).length),this.nt={mounted:e.mounted,unmounted:e.unmounted||e.destroyed,updated:e.updated,beforeMount:e.beforeMount,beforeUnmount:e.beforeUnmount||e.beforeDestroy},this.Y=this.yt(e.data||{}),this.wt=this.mt(this.Y||{}),this.vt=this.bt()}yt(t,e){if(null===t||"object"!=typeof t)return t;const i=e||new WeakMap;if(i.has(t))return i.get(t);if(n(t)){const e=[];i.set(t,e);for(let n=0;n<t.length;n++)e[n]=this.yt(t[n],i);return e}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp)return new RegExp(t.source,t.flags);if("undefined"!=typeof Map&&t instanceof Map){const e=new Map;return i.set(t,e),t.forEach((t,n)=>{e.set(this.yt(n,i),this.yt(t,i))}),e}if("undefined"!=typeof Set&&t instanceof Set){const e=new Set;return i.set(t,e),t.forEach(t=>e.add(this.yt(t,i))),e}const s=Object.getPrototypeOf(t);if(s===Object.prototype||null===s){const e=Object.create(s);i.set(t,e);for(const n of Object.keys(t))e[n]=this.yt(t[n],i);return e}return t}callBeforeMount(){this.E||(this.et("beforeMount"),this.E=1)}gt(t){if(!this.isBound)return;const e=this;if(null!=e.G&&(r(()=>cancelAnimationFrame(e.G)),e.G=null),0==this.U)return;const n=e.z,i=e.H.get(t);if(i)for(let t=0;t<i.length;t++)n.add(i[t]);if(e.k.size){const i=[t],s=new Set,o=new Set;let r=0;for(;r<i.length;){const t=i[r++];if(!s.has(t)){s.add(t);for(const[n,s]of e.k.entries())s.has(t)&&!o.has(n)&&(o.add(n),i.push(n))}}for(const t of o){const i=e.H.get(t);if(i)for(let t=0;t<i.length;t++)n.add(i[t]);e.R.delete(t)}}e.G=requestAnimationFrame(()=>{if(e.R.clear(),e.G=null,!e.isDestroyed&&!e.v){for(const t of n)e.it(t);n.clear(),i?.length||!e.N&&b||e.b(),e.et("updated")}})}bt(){return this._t(this.ut,"methods")}pt(t){return this._t(t,"computed")}dt(){return this._t(this.A||{},"prop")}_t(t,e){const n={},i=t=>{try{if(!(t=>/\[native code\]/.test(String(t)))(t)){let e=String(t).trim();/^function[\s\(]/.test(e)||/^[\w\$_][\w\d\$_]*\s*=>/.test(e)||/^\(.*?\)\s*=>/.test(e)||(e="function "+e);const n=new Function("ctx",`with(ctx){ const f = (${e}); return f.apply(this, []); }`);return()=>{const t=this.ct();return n.call(t,t)}}}catch{}return()=>t.call(this.ct())};for(const s in t||{}){const o=t[s];"function"==typeof o&&(n[s]="computed"===e?i(o):"methods"===e?(...t)=>{const e=this.j,n=this.K;this.j=1,this.K=s;try{return this.it(()=>this.st(o,t))}finally{this.j=e,this.K=n}}:(t,e)=>{const n=this.K,i=this.M;this.K=`prop:${s}`,this.M=1;try{return this.it(()=>this.st(o,[t,e]))}finally{this.M=i,this.K=n}})}return n}xt(t){if(this.$t(t),this.R.has(t))return this.R.get(t);this.D=1,this.F.push(t),this.k.set(t,new Set);try{const e=this.T[t],n="function"==typeof e?e():void 0;return this.F.pop(),this.D=this.F.length>0,this.R.set(t,n),n}catch(t){return this.F.pop(),void(this.D=this.F.length>0)}}$t(t){const e=this.W;if(!e)return;let n=this.H.get(t);n||(n=[],this.H.set(t,n)),n.includes(e)||n.push(e);const i=this.F.length;if(this.D&&i){const e=this.F[i-1];let n=this.k.get(e);n||(n=new Set,this.k.set(e,n)),n.add(t)}}b(){this.v||this.w||this.c||this.V||(this.V=1,requestAnimationFrame(()=>{if(this.J=null,this.V=0,this.c||this.v)this.Z?.length&&(this.Z.length=0);else if(this.St(),this.Z?.length){const t=this.Z.splice(0);for(const e of t)r(e)}}))}it(t,e){try{return t()}catch(t){return e}}bindToElement(t){this.o||(this.s=t,this.E||this.callBeforeMount(),this.completeBinding())}getContext(t=1){return this.ct(t)}Mt(){if(this.s){try{this.Et(this.s)}catch{}this.b()}}completeBinding(){!this.o&&this.s&&(this.i.Ot(this.s)||this.i.Tt(this.s,this),this.o=1,this.r=1,this.Et(this.s),this.St(),this.et("mounted"))}e(t){this.O.includes(t)||this.O.push(t)}At(t){const e=this.O.indexOf(t);e>-1&&this.O.splice(e,1)}Rt(t){this.ot=t||void 0}st(t,e){try{const n=String(t);if(!/\[native code\]/.test(n)){let t=n.trim();/^function[\s\(]/.test(t)||/^[\w\$_][\w\d\$_]*\s*=>/.test(t)||/^\(.*?\)\s*=>/.test(t)||(t="function "+t);const i=new Function("thisArg","argsArray","ctx","with(ctx){ const f = ("+t+"); return f.apply(thisArg, argsArray); }"),s=this.ct();return i.call(s,s,e,this.lt(void 0,void 0))}}catch{}return t.apply(this.ct(),e)}destroy(){const t=this;if(!t.c){t.et("beforeUnmount");for(const e of t.O)e.isDestroyed||e.destroy();t.t&&t.t.At(t);for(const[e,n]of t.$)for(const i of n)"custom"===i.type&&i.customDirective?.unbind&&r(()=>i.customDirective.unbind(e,t));t.$.clear();try{t.I.abort()}catch{}if(t.I=new AbortController,t.f(),t.kt(),t.R.clear(),t.X.clear(),t.H.clear(),t.tt&&t.Ft)for(const e of t.tt.H.values()){const n=e.indexOf(t.Ft);n>-1&&e.splice(n,1)}t.s&&t.i.Dt(t.s),t.i.jt(t),null!=t.G&&(r(()=>cancelAnimationFrame(t.G)),t.G=null),null!=t.J&&(r(()=>cancelAnimationFrame(t.J)),t.J=null),t.et("unmounted"),t.c=1,t.r=0,t.o=0,t.O=[],t.t=null,t.Ct=new i,t.z.clear(),t.s=null,s(()=>t.i.Nt(t.n)),t.wt={},t.Y={},t.vt={},t.T={},t.A={},t.W=null}}Pt(t,e){if(!t||!e)return;let n;this.tt=e;try{n=new Function("ctx","with(ctx){return ("+t+")}")}catch{return}const i=()=>{let t;e.W=i;try{const i=e.getContext(1);t=n(i)}catch{t=null}if(e.W=null,t&&"object"==typeof t){this.wt.$props=this.wt.$props||{},this.S=1;for(const e in t){const n=t[e];this.wt[e]!==n&&(this.wt[e]=n)}this.S=0}};this.Ft=i,i()}kt(){for(const t of this.P)r(t);this.P.clear()}It(t,e,n,i){const s=this.I.signal;if("boolean"==typeof i)t.addEventListener(e,n,{capture:i,signal:s});else if(i){const o=i.signal&&i.signal!==s?i:{...i,signal:s};t.addEventListener(e,n,o)}else t.addEventListener(e,n,{signal:s})}Lt(t){let e=this.L.get(t);return e||(e=(++this.B).toString(36),this.L.set(t,e)),e}Et(t){const e=this,n=(t,n=0)=>{if(!n&&(t.hasAttribute(M("data"))||this.i.Ot(t)))return 0;const i="COMPONENT"===t[d],{names:s,hasTextOrHtml:o,forName:r}=e.d(t);if(s.length>0){if(r)return e.Bt(t,r,t.getAttribute(r)||""),0;for(const n of s)e.Bt(t,n,t.getAttribute(n)||"")}return o||e.Ut(t),n||!i};n(t,1),e.zt(t,n)}Ut(t){if(!o)return;const e=Array.from(t.childNodes);for(const n of e){if(n.nodeType!==Node.TEXT_NODE)continue;const e=n,i=e.nodeValue||"";if(e.Kt||-1===i.indexOf("{{"))continue;const s=[];let o=0;for(;o<i.length;){if(92===i.charCodeAt(o)){let t=0;const e=o;for(;o<i.length&&92===i.charCodeAt(o);)t++,o++;if(i.startsWith("{{",o)){const n=i.indexOf("}}",o+2);if(-1===n){s.push({type:"lit",text:i.slice(e)});break}t>1&&s.push({type:"lit",text:"\\".repeat(t-1)}),s.push({type:"lit",text:i.slice(o,n+2)}),o=n+2;continue}s.push({type:"lit",text:i.slice(e,o)});continue}if(i.startsWith("{{",o)){const t=i.indexOf("}}",o+2);if(-1===t){s.push({type:"lit",text:i.slice(o)});break}const e=i.slice(o+2,t).trim();0===e.length?s.push({type:"lit",text:"{{}}"}):s.push({type:"expr",code:e}),o=t+2;continue}const t=i.indexOf("\\",o),e=i.indexOf("{{",o);let n=i.length;-1!==t&&t<n&&(n=t),-1!==e&&e<n&&(n=e),s.push({type:"lit",text:i.slice(o,n)}),o=n}if(!s.some(t=>"expr"===t.type)){e.Kt=1;const t=s.map(t=>t.text||"").join("");e.textContent!==t&&(e.textContent=t);continue}const r=[];for(const e of s)"expr"===e.type&&r.push(this.qt(e.code,t));e.Kt=1;const c=()=>{let t="",n=0;for(const e of s)if("lit"===e.type)t+=e.text;else{const e=r[n++]();t+=null==e?"":String(e)}e.textContent!==t&&(e.textContent=t)},f={type:"text-interpolation",expression:i,update:void 0};this._(t,f);const l=this.Xt(c,f);f.update=l}}zt(t,e){let n=t.firstElementChild;for(;n;){const t=n.nextElementSibling;e(n)&&this.zt(n,e),n=t}}Bt(t,e,n){const i=this,s=e.startsWith("@"),r=e.startsWith($+":"),c=s?"on:"+e.slice(1):e.slice($.length+1);if(!s&&(r||"class"===c||c===a))return t.removeAttribute(e),i.Ht(t,c,n);if(o&&!s&&("transition"===c||c.startsWith("transition."))){let s;return c.startsWith("transition.")&&(s=c.slice(11).split(".").filter(Boolean).reduce((t,e)=>(t[e]=1,t),{})),t.removeAttribute(e),i.Wt(t,n,void 0,s)}if(!s&&("text"===c||"html"===c||"show"===c))return i.Vt(t,n,c,e);if(!s&&"ref"===c)return t.removeAttribute(e),i.Zt(t,n);if(!(s||"model"!==c?"if"===c?(t.removeAttribute(e),i.Gt(t,n),1):"for"===c&&(t.removeAttribute(e),i.Jt(t,n),1):(t.removeAttribute(e),i.Qt(t,n),1))&&(s||c.indexOf(":")>-1)){const[r,f]=c.split(":",2),[l,...h]=f.split("."),a=h.reduce((t,e)=>(e&&(t[e]=1),t),{});if(!s&&"COMPONENT"===t[d]&&"prop"===r)return;if("on"===r){t.removeAttribute(e);const s=i.framework.Yt(l);return s?i.te(t,l,n,s,a):i.ee(t,l,n,a)}if("transition"===r&&o){t.removeAttribute(e);const s={enter:"enter","enter-from":"enterFrom","enter-to":"enterTo",leave:"leave","leave-from":"leaveFrom","leave-to":"leaveTo","enter-start":"enterFrom","enter-end":"enterTo","leave-start":"leaveFrom","leave-end":"leaveTo"}[l]||"toggle";return i.Wt(t,n,s,a)}return"intersect"===r&&o?(t.removeAttribute(e),i.ne(t,n,a,l)):(t.removeAttribute(e),i.Ht(t,l,n))}}Zt(t,e){if(!o)return;const n=c(e);if(!n)return;this.framework.ie(this,n,t);const i={type:"ref",expression:e};this._(t,i)}se(t){if(!t||!o)return;let e=this.framework.oe(this,t);if(!e&&this.t){let n=this.t;for(;n&&(e=n.framework.oe(n,t),!e&&n.t);)n=n.t}if(e){if(e.size>1){const t=[];return e.forEach(e=>t.push(e)),t}return e.values().next().value}}ne(t,e,n,i){if(!o)return;const s=c(e),r=this.re(s,t,e=>[e,t]),f=t=>{r&&r(t)},l=!!n.once;let h="0px";for(const t in n)if(t.startsWith("rootMargin-")){h=t.slice(11);break}const a="enter"===i?{cb:(t,e)=>f({entry:t,...e}),once:l}:void 0,u="leave"===i?{cb:(t,e)=>f({entry:t,...e}),once:l}:void 0,p=this.framework.ce(t,h,a,u),d={type:"intersect",expression:e};this._(t,d),this.ht(()=>{try{p()}catch{}})}Xt(t,e){const n=()=>{this.W=n;try{t()}finally{this.W=null}};if(n(),this.C.add(n),b&&e&&void 0===e.fe){let t=0;for(const e of this.H.values())if(e.includes(n)){t=1;break}e.fe=!t}return n}Wt(t,e,n,i){if(!o)return;let s=t.le||null;const r=c(e);if(r)try{const e=this.qt(r,t),i=this.it(()=>e());if(s||(s={}),i&&"object"==typeof i)for(const t in i)s[t]=i[t];else"string"==typeof i&&(n?s[n]=i:s.toggle=i)}catch{}if(i&&(i.after||i.end)){const e=r;if(e){const i=this.re(e,t,e=>[e,t]),o=t=>{i&&this.it(()=>i(t))};"enter"===n||"enterFrom"===n||"enterTo"===n?s.afterEnterRunner=o:"leave"===n||"leaveFrom"===n||"leaveTo"===n?s.afterLeaveRunner=o:s.afterRunner=o}}s||(s={}),t.le=s,this._(t,{type:"transition",expression:e})}he(t,e,n,i){if(!o)return e?n?t.style.setProperty("display",n,"important"):t.style.removeProperty("display"):t.style.setProperty("display",p,"important"),void(i&&i());const s=t.le,r="important";if(!s)return e?n?t.style.setProperty("display",n,r):t.style.removeProperty("display"):t.style.setProperty("display",p,r),void(i&&i());const c=t.ae;if(c&&"function"==typeof c.cancel)try{c.cancel()}catch{}const f="number"==typeof s.duration?s.duration:150,l="string"==typeof s.easing?s.easing:"ease",h=e=>{e&&e.split(/\s+/).forEach(e=>e&&t.classList.add(e))},a=e=>{e&&e.split(/\s+/).forEach(e=>e&&t.classList.remove(e))},u=e=>{try{const n="undefined"!=typeof window&&window.getComputedStyle?window.getComputedStyle(t):null;if(!n)return e;const i=t=>t?t.split(",").map(t=>t.trim()).filter(Boolean).map(t=>{if(t.endsWith("ms"))return parseFloat(t);if(t.endsWith("s"))return 1e3*parseFloat(t);const e=parseFloat(t);return isNaN(e)?0:e}):[];let s=((t,e)=>{const n=Math.max(t.length,e.length);let i=0;for(let s=0;s<n;s++){const n=(t[s%t.length]||0)+(e[s%e.length]||0);n>i&&(i=n)}return i})(i(n.transitionDuration||""),i(n.transitionDelay||""));const o=i(n.animationDuration||""),r=i(n.animationDelay||""),c=(n.animationIterationCount||"").split(",").map(t=>t.trim()).map(t=>"infinite"===t?0:parseFloat(t)||1),f=Math.max(o.length,r.length,c.length);let l=0;for(let t=0;t<f;t++){const e=o[t%o.length]||0,n=r[t%r.length]||0,i=c[t%c.length]||1;if(0===i)continue;const s=n+e*i;s>l&&(l=s)}const h=Math.max(s,l);return h>0?h:e}catch{return e}},d=[],y=(e,n)=>{let i=0;const s=()=>{i||(i=1,n(),(()=>{for(;d.length;)try{d.pop()()}catch{}})())},o=()=>s();t.addEventListener("transitionend",o,{once:1,capture:1}),t.addEventListener("animationend",o,{once:1,capture:1});const r=setTimeout(s,e+50);var c;c=()=>{try{t.removeEventListener("transitionend",o)}catch{}try{t.removeEventListener("animationend",o)}catch{}clearTimeout(r)},d.push(c)},w=(e,n)=>{const i={el:t,phase:e,config:{...s,duration:n??u(f),easing:l}};try{"enter"===e?"function"==typeof s.afterEnterRunner?s.afterEnterRunner(i):"function"==typeof s.afterRunner&&s.afterRunner(i):"function"==typeof s.afterLeaveRunner?s.afterLeaveRunner(i):"function"==typeof s.afterRunner&&s.afterRunner(i)}catch{}},m=e=>{const o="enter"===e,c=o?s.enter:s.leave,l=o?s.enterFrom:s.leaveFrom,d=o?s.enterTo:s.leaveTo;if(o&&(n?t.style.setProperty("display",n,r):t.style.removeProperty("display")),!c&&!l&&!d)return 0;h(c),h(l),t.offsetWidth,a(l),h(d);const m=u(f);return y(m,()=>{a(c),a(d),o||t.style.setProperty("display",p,r),i&&i(),w(e,m)}),t.ae={cancel:()=>{a(c),a(l),a(d),o||t.style.setProperty("display",p,r),i&&i()}},1},v=e=>{const s="enter"===e,o=t.style.transition,c=t.style.opacity;s?(n?t.style.setProperty("display",n,r):t.style.removeProperty("display"),t.style.setProperty("opacity","0",r)):t.style.setProperty("opacity","1",r),t.offsetWidth;const h=u(f);t.style.setProperty("transition",`opacity ${h}ms ${l}`,r),s?t.style.setProperty("opacity","1",r):t.style.setProperty("opacity","0",r),y(h,()=>{o?t.style.setProperty("transition",o,r):t.style.removeProperty("transition"),c?t.style.setProperty("opacity",c,r):t.style.removeProperty("opacity"),s||t.style.setProperty("display",p,r),i&&i(),w(e,h)}),t.ae={cancel:()=>{o?t.style.setProperty("transition",o,r):t.style.removeProperty("transition"),c?t.style.setProperty("opacity",c,r):t.style.removeProperty("opacity"),s||t.style.setProperty("display",p,r),i&&i()}}};if("string"!=typeof s.toggle)e?m("enter")||v("enter"):m("leave")||v("leave");else if(e){n?t.style.setProperty("display",n,r):t.style.removeProperty("display"),h(s.toggle);const e=u(f);y(e,()=>{i&&i(),w("enter",e)}),t.ae={cancel:()=>{i&&i()}}}else{a(s.toggle);const e=u(f);y(e,()=>{t.style.setProperty("display",p,r),i&&i(),w("leave",e)}),t.ae={cancel:()=>{t.style.setProperty("display",p,r),i&&i()}}}}Vt(t,e,n,i){if("class"===n||n===a)return this.Ht(t,n,e);const s=this.qt(e,t);let o,r,c=i?null!==t.getAttribute(i):0;if("show"===n){const e=t;o=e.style[u]!==p?e.style[u]:void 0}const f={type:n,expression:e,update:void 0,originalDisplay:o};this._(t,f);const l=this.Xt(()=>{const e=s(),f=t;switch(c&&i&&(t.removeAttribute(i),c=0),n){case"text":f.textContent=String(e);break;case"html":f.innerHTML=String(e||"");break;case"show":const t=!!e;if(r===t)return;r=t,this.he(f,t,o)}},f);f.update=l}Qt(t,e){const n="checkbox"===t.type,i="number"===t.type||"range"===t.type,s="SELECT"===t.tagName&&1==t.multiple;e in this.wt||(this.wt[e]=void 0);const o=this.qt(e,t),r=this.at(`${e} = $value`,1),c=n?(()=>{if(t.hasAttribute("value"))return t.value;const e=this.ue(t);if(e){const t=Object.keys(e);if(1===t.length)return e[t[0]]}return t.value})():void 0;this.Xt(()=>(e=>{if(n)if(Array.isArray(e)){const n=t.hasAttribute("value")?t.value:c;t.checked=null!=n?e.includes(n):0}else t.checked=!!e;else{if(s){const n=t,i=Array.isArray(e)?e:[],s=n.options;for(let t=0;t<s.length;t++)s[t].selected=i.includes(s[t].value);return}t.value=String(e??(i?0:""))}})(o()));const f=this.lt(void 0,t),l=t.type,h="SELECT"===t[d]||"checkbox"===l||"radio"===l||"file"===l?"change":"input";this.It(t,h,()=>{const e=(()=>{if(n){const e=o();return Array.isArray(e)&&void 0!==c?t.checked?c:void 0:t.hasAttribute("value")?t.checked?t.value:void 0:t.checked}if(s){const e=[],n=t.options;for(let t=0;t<n.length;t++)n[t].selected&&e.push(n[t].value);return e}return i?parseFloat(t.value)||0:t.value})(),l=this.it(()=>o());if(n&&Array.isArray(l)){const e=t.hasAttribute("value")?t.value:c;if(void 0!==e){const n=l.indexOf(e);t.checked?-1===n&&l.push(e):n>-1&&l.splice(n,1)}}else s&&Array.isArray(l)?l.splice(0,l.length,...e):(f.$value=e,this.it(()=>{r.call(this.ct(),f)}))}),this._(t,{type:"model",property:e})}Gt(t,e){const n=this,i=g.createComment("x-if");t.parentNode?.insertBefore(i,t),t.pe=i.parentElement||null;const s=[],o=t=>{if(t[d]===y){const e=g.createElement("div");return e.style[u]=_,e.appendChild(t.content.cloneNode(1)),{el:e,isTemplate:1}}return{el:t,isTemplate:0}},r=o(t),f=r.el.style[u]!==p?r.el.style[u]:void 0,l=n.qt(e,t);s.push({el:r.el,test:l,isTemplate:r.isTemplate,originalDisplay:f}),r.isTemplate||(r.el.de=1);const h=[t];{let e=t.nextElementSibling;for(;e;){const t=e.hasAttribute(M("else")),i=e.hasAttribute(M("else-if"));if(!t&&!i)break;if(e.hasAttribute(M("else-if"))){const t=e.getAttribute(M("else-if"))||"",i=o(e),r=i.el.style[u]!==p?i.el.style[u]:void 0,f=n.qt(c(t),e);s.push({el:i.el,test:f,isTemplate:i.isTemplate,originalDisplay:r}),i.isTemplate||(i.el.de=1)}else{const t=o(e),n=t.el.style[u]!==p?t.el.style[u]:void 0;s.push({el:t.el,test:null,isTemplate:t.isTemplate,originalDisplay:n}),t.isTemplate||(t.el.de=1)}e.removeAttribute(M("else")),e.removeAttribute(M("else-if")),h.push(e),e=e.nextElementSibling}}let a=-1;for(const t of h)t.parentNode&&t.parentNode.removeChild(t);const m=e=>{if(e<0)return;const o=s[e];o.el.de||(n.Et(o.el),o.el.de=1),t.ye?.parentNode?.removeChild(t.ye),o.el.parentNode||i.parentNode?.insertBefore(o.el,i.nextSibling),t.ye=o.el,n.he(o.el,1,o.originalDisplay);try{n.framework.we(o.el,n)}catch{}a=e},v=n.Xt(()=>{let t=-1;for(let e=0;e<s[w];e++){const n=s[e];if(!n.test||n.test()){t=e;break}}t!==a&&(-1!==a?((t,e)=>{if(t<0)return void(e&&e());const i=s[t];i.el.parentNode?n.he(i.el,0,i.originalDisplay,()=>{i.el.parentNode&&i.el.parentNode.removeChild(i.el),e&&e()}):e&&e(),a=-1})(a,()=>m(t)):m(t))});n._(t,{type:"if",expression:e,update:v})}ee(t,e,n,i){const o=this,r=c(n),f=i?{once:!!i.once,passive:!!i.passive,capture:!!i.capture}:void 0,l=!!i?.self,a=!!i?.prevent,u=!!i?.stop,p=!!i?.outside,d=!!i?.window,y=!!i?.defer,w={enter:["enter"],esc:["escape","esc"],escape:["escape","esc"],space:[" ","space","spacebar"],tab:["tab"],backspace:["backspace"],delete:["delete","del"],del:["delete","del"],arrowup:["arrowup","up"],arrowdown:["arrowdown","down"],arrowleft:["arrowleft","left"],arrowright:["arrowright","right"],home:["home"],end:["end"],pageup:["pageup"],pagedown:["pagedown"]},m={ctrl:!!i?.ctrl,alt:!!i?.alt,shift:!!i?.shift,meta:!!i?.meta},v={left:0,middle:1,right:2},b=!!i?.single,_=!!i?.multi,$=i?h(i):[],S=[];for(const t of $){const e=w[t.toLowerCase()];e&&S.push(...e)}const M=[];for(const t of $){const e=v[t.toLowerCase()];void 0!==e&&M.push(e)}const E=S.length>0||m.ctrl||m.alt||m.shift||m.meta,O=M.length>0,T=b||_,A=e=>{const n=e.composedPath?e.composedPath():null,i=n&&n.length?n[0]:e.target;if(p){if(!i)return 0;if(t instanceof Node&&(t===i||t.contains(i)))return 0}if(l&&e.target!==t)return 0;if(T){if(!(e instanceof TouchEvent))return 0;{const t=e.touches.length;if(b&&1!==t)return 0;if(_&&t<2)return 0}}if(O){if(!(e instanceof MouseEvent))return 0;if(!M.includes(e.button))return 0}if(E){if(!(e instanceof KeyboardEvent))return 0;const t=(e.key||"").toLowerCase();if(S.length>0&&!S.includes(t))return 0;const{ctrlKey:n,altKey:i,shiftKey:s,metaKey:o}=e;if(m.ctrl&&!n||m.alt&&!i||m.shift&&!s||m.meta&&!o)return 0}return 1},R=o.re(r,t,e=>[e,t]),k=t=>{if(A(t)&&(a&&t.preventDefault(),u&&t.stopPropagation(),R)){if(y&&"function"==typeof s){const e=t;return void s(()=>o.it(()=>R(e)))}o.it(()=>R(t))}},F=!!this.framework.me().delegate&&x.includes(e);if(p||d||!F){const n=d?"undefined"!=typeof window?window:t:p?t?.ownerDocument||g||document:t;o.It(n,e,k,f)}else{const n=this.framework.ve(t,e,{filter:t=>A(t),run:t=>k(t),once:!!i?.once,comp:this});this.ht(n)}}at(t,e=0){const n=`${e?"s":"r"}:${t}`;let i=this.X.get(n);if(!i){try{i=new Function("ctx",`with(ctx){${e?t:`return (${t})`}}`)}catch{t=JSON.stringify(t),i=new Function("ctx",`with(ctx){${e?t:`return (${t})`}}`)}this.X.set(n,i)}return i}qt(t,e){const n=this,i=n.at(t);return()=>this.it(()=>i.call(n.ct(),n.lt(void 0,e)))}rt(t){let e=t.match(/^\s*\(\s*([^)]*?)\s*\)\s*=>\s*([\s\S]+)$/);if(e||(e=t.match(/^\s*([a-zA-Z_$][a-zA-Z0-9_$]*)\s*=>\s*([\s\S]+)$/)),!e)return null;const n=(e[1]||"").split(",").map(t=>t.trim()).filter(Boolean),i=c(e[2]),s=i.startsWith("{")&&i.endsWith("}");return{paramsList:n,body:s?i.slice(1,-1):i,isBlock:s}}ft(t,e,n){return new Function("ctx",...t,"with(ctx){ "+(n?e:"return ( "+e+" );")+" }")}re(t,e,n){const i=this,s=c(t);if(!s)return null;const o=i.rt(s),r=i.ct();if(o){const{paramsList:t,body:s,isBlock:c}=o,f=i.ft(t,s,c);return s=>{const o=i.lt(s,e),c=n(s);i.it(()=>f.call(r,o,...c.slice(0,t.length)))}}const f=s.includes(";"),l=i.at(s,f);return t=>{const n=i.lt(t,e),s=l.call(r,n);if("function"==typeof s)try{s.call(r,t)}catch{}}}be(t,e){if(this.D)throw new Error(`[x-tool] Mutation via '${String(t)}.${e}()' is not allowed during computed evaluation.`);if(this.w)throw new Error(`[x-tool] Mutation via '${String(t)}.${e}()' is not allowed while component is frozen.`)}ge(t,e){const s=n(t),o="undefined"!=typeof Set&&t instanceof Set,c="undefined"!=typeof Map&&t instanceof Map;if(!(Object.getPrototypeOf(t)===Object.prototype||s||o||c))return t;const f=this;if(this.Ct||(this.Ct=new i),this.Ct.has(t))return this.Ct.get(t);const l=(t,n,i)=>function(...s){if(f.be(e,t),i){const t=this,i=t.length,o=t[0],r=t[i-1],c=n.apply(this,s);return f.v||t.length===i&&t[0]===o&&t[t.length-1]===r||f.gt(e),c}{const i=this.size,o="set"===t?this.has(s[0]):0,r=n.apply(this,s);return f.v||this.size===i&&("set"!==t||o)||f.gt(e),r}},h=new Proxy(t,{get:(t,n,i)=>{const r=o||c;if(s){if((n===Symbol.iterator||"length"===n||"string"==typeof n&&/^\d+$/.test(n))&&(f.$t(e),n===Symbol.iterator))return Reflect.get(t,n,i)}else r&&"size"!==n&&n!==Symbol.iterator&&"keys"!==n&&"values"!==n&&"entries"!==n||f.$t(e);const h=Reflect.get(t,n,i);if(r&&"function"==typeof h&&(n===Symbol.iterator||"keys"===n||"values"===n||"entries"===n))return function(...e){return h.apply(t,e)};if("function"==typeof h){if(s&&["push","pop","shift","unshift","splice","reverse","copyWithin","fill","sort"].includes(n))return l(String(n),h,1).bind(t);if(o&&("add"===n||"delete"===n||"clear"===n))return l(String(n),h,0).bind(t);if(c&&("set"===n||"delete"===n||"clear"===n))return l(String(n),h,0).bind(t)}return h&&"object"==typeof h?f.ge(h,e):h},ownKeys:Reflect.ownKeys,has:Reflect.has,set:(t,n,i)=>{if(f.c||"symbol"==typeof n)return 1;const s=String(e)+"."+String(n);if(f.D)throw new Error(`[x-tool] Mutation of '${s}' is not allowed during computed evaluation.`);if(f.w)throw new Error(`[x-tool] Mutation of '${s}' is not allowed while component is frozen.`);const o=Reflect.has(t,n),c=o?Reflect.get(t,n):void 0;return i&&"object"==typeof i&&(i=f.ge(i,String(e)+"."+String(n))),o?(c===i||(Reflect.set(t,n,i),f.v||f.gt(e)),1):(r(()=>Reflect.defineProperty(t,n,{configurable:1,enumerable:1,writable:1,value:i})),Reflect.has(t,n)||Reflect.set(t,n,i),f.gt(e),1)},deleteProperty:(t,n)=>{const i=String(e)+("symbol"==typeof n?"":"."+String(n));if(f.D)throw new Error(`[x-tool] Deletion of '${i}' is not allowed during computed evaluation.`);if(f.w)throw new Error(`[x-tool] Deletion of '${i}' is not allowed while component is frozen.`);const s=Reflect.deleteProperty(t,n);return s&&!f.v&&f.gt(e),s}});return this.Ct.set(t,h),h}mt(t){const e=this;return new Proxy(t,{get:(t,n,i)=>{const s=Reflect.get(t,n,i);return n===Symbol.iterator?s:("symbol"!=typeof n&&e.$t(n),s&&"object"==typeof s?e.ge(s,n):s)},ownKeys:t=>Reflect.ownKeys(t),has:(t,e)=>Reflect.has(t,e),set:(t,i,s,o)=>{if(e.c)return 1;if(e.w)return 1;if(e.D)throw new Error(`[x-tool] Mutation of '${String(i)}' is not allowed during computed evaluation.`);if(i===Symbol.iterator&&n(t))return s;const r=Reflect.get(t,i);if(Reflect.has(t,i))Reflect.set(t,i,s,o);else try{Reflect.defineProperty(t,i,{configurable:1,enumerable:1,writable:1,value:s})}catch{Reflect.set(t,i,s,o)}if(this.v||this.gt(i),this.S&&"$props"!==i){const e=t.$props;e&&(e[i]=s);const n=this.A[i];n&&!this.v&&n(s,r)}return 1}})}ct(t=1){const e=this,n={$log:()=>{},$destroy:()=>e.destroy(),$forceUpdate:()=>e.b(),$addCleanupFunction:t=>e.ht(t),$nextTick:t=>t?(e.Z.push(t),void(e.V||s(()=>{if(!e.V&&e.Z.length){const t=e.Z.splice(0,e.Z.length);for(const n of t)e.it(()=>n())}}))):new Promise(t=>{e.Z.push(()=>t()),e.V||s(()=>{if(!e.V&&e.Z.length){const t=e.Z.splice(0,e.Z.length);for(const n of t)e.it(()=>n())}})}),$el:e.s,$id:e.n,...o?{$refs:new Proxy({},{get:(t,n)=>n?e.se(n):null}),$ref:(t,n)=>{if(void 0===n)return e.se(t);e.i.ie(e,t,n)}}:{},$isMounted:e.r,$isDestroyed:e.c,$isSealed:e.v,$isFrozen:e.w,$parent:e.t,$children:e.O,$seal:(t=1)=>{e.g(!!t)},$mutate:t=>{const n=e.j;if(e.U=0,e.D)throw new Error("[x-tool] $mutate cannot be used inside computed evaluation; computed getters must be pure.");e.j=0;try{return"function"==typeof t?t():void 0}finally{e.j=n,e.U=1,e.b()}}};let i=e.wt;return e.D&&(i=e.Y),new Proxy(i,{get:(t,i)=>i in t?(e.$t(i),t[i]):i in e.T?e.xt(i):i in n?n[i]:e.vt[i],set:(t,n,i)=>{if(e.D)throw new Error(`[x-tool] Mutation of '${String(n)}' is not allowed during computed evaluation.`);if(e.w)throw new Error(`[x-tool] Mutation of '${String(n)}' is not allowed while component is frozen.`);return e.wt[n]=i,1}})}lt(t,e){const n=this,i=e?this.ue(e):null,s="undefined"!=typeof window?window:void 0,r="undefined"!=typeof document?document:void 0,c=this.framework.me(),f=!!c.sandboxExpressions,l=new Set((c.allowGlobals||[]).map(t=>String(t))),h=()=>this.K||"__anonymous__",a=(t,e)=>{const n=h();let i=this.l.get(n);i||(i=new Map,this.l.set(n,i));const s=i.get(t);if(s){try{s()}catch{}i.delete(t)}const o=e();if("function"==typeof o){const e=()=>{try{o()}finally{i?.delete(t)}};i.set(t,e),this.ht(e)}},u=t=>t&&"function"==typeof t.addEventListener?new Proxy(t,{get:(t,e)=>{if("addEventListener"===e)return(e,n,i)=>{if(this.v||this.w)return;t.addEventListener(e,n,i);const s="boolean"==typeof i?i:i?.capture?"1":"0",o="listener:"+this.Lt(t)+":"+e+":"+s;a(o,()=>()=>{try{t.removeEventListener(e,n,i)}catch{}})};if("removeEventListener"===e)return(e,n,i)=>{try{t.removeEventListener(e,n,i)}catch{}};if("querySelector"===e)return e=>u(t.querySelector(e));if("querySelectorAll"===e)return e=>Array.from(t.querySelectorAll(e)).map(u);if("getElementById"===e)return e=>u(t.getElementById(e));if("document"===e){const e=t.document;return u(e)||e}if("defaultView"===e){const e=t.defaultView;return u(e)||e}if("body"===e){const e=t.body;return u(e)||e}const n=t[e];if("function"==typeof n)try{return n.bind(t)}catch{return n}return n}}):t,p=(t,e)=>{if(t)return function(...i){if(n.v||n.w)return{observe(){},disconnect(){},unobserve(){}};const s=new t(...i);return a("observer:"+e,()=>()=>{try{s.disconnect()}catch{}}),s}},d={$target:e||null,$event:t||null,...o?{$refs:new Proxy({},{get:(t,e)=>e?n.se(e):null}),$ref:(t,e)=>{if(void 0===e)return n.se(t);n.i.ie(n,t,e)}}:{},...this.framework._e()?{location:new Proxy(s?.location||location,{get:(t,e)=>t[e],set:(t,e,n)=>{if("href"===String(e)){try{this.framework.xe(String(n),1,"program")}catch{location.href=String(n)}return 1}try{location[e]=n}catch{}return 1}})}:{},...f&&!l.has("setTimeout")?{}:{setTimeout:(t,e,...n)=>{if(this.v||this.w||this.c)return;const i=s?.setTimeout?.(t,e,...n);return null!=i&&a("timeout",()=>()=>{try{s?.clearTimeout?.(i)}catch{}}),i}},...f&&!l.has("clearTimeout")?{}:{clearTimeout:t=>{try{s?.clearTimeout?.(t)}catch{}}},...f&&!l.has("setInterval")?{}:{setInterval:(t,e,...n)=>{if(this.v||this.w)return;const i=s?.setInterval?.(t,e,...n);return null!=i&&a("interval",()=>()=>{try{s?.clearInterval?.(i)}catch{}}),i}},...f&&!l.has("clearInterval")?{}:{clearInterval:t=>{try{s?.clearInterval?.(t)}catch{}}},...f&&!l.has("requestAnimationFrame")?{}:{requestAnimationFrame:t=>{if(this.v||this.w)return;const e=s?.requestAnimationFrame?.(t);return null!=e&&a("raf",()=>()=>{try{s?.cancelAnimationFrame?.(e)}catch{}}),e}},...f&&!l.has("cancelAnimationFrame")?{}:{cancelAnimationFrame:t=>{try{s?.cancelAnimationFrame?.(t)}catch{}}},...f&&!l.has("MutationObserver")?{}:{MutationObserver:p(s?.MutationObserver,"mutation")},...f&&!l.has("ResizeObserver")?{}:{ResizeObserver:p(s?.ResizeObserver,"resize")},...f&&!l.has("IntersectionObserver")?{}:{IntersectionObserver:p(s?.IntersectionObserver,"intersection")},...f&&!l.has("window")?{}:{window:u(s)},...f&&!l.has("document")?{}:{document:u(r)}};return new Proxy({},{get:(t,e)=>i&&e in i?i[e]:e in n.wt?n.wt[e]:e in n.T?n.xt(e):e in n.vt?n.vt[e]:e in d?d[e]:void 0,set:(t,e,s)=>{if(i){let t=i;for(;t;){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]=s,1;t=Object.getPrototypeOf(t)}}return n.wt[e]=s,1},has:(t,e)=>!(!i||!(e in i))||e in n.wt||e in n.T||e in n.vt||e in d})}te(t,e,n,i,s){const o=this,r=o.qt(n,t),c={type:"custom",expression:n,customDirective:i};i.bind&&o.it(()=>i.bind(t,r(),n,o,s,r));const f=o.Xt(()=>{i.update&&o.it(()=>i.update(t,r(),n,o,s,r))});c.update=f,o._(t,c)}Ht(t,e,i){const s=this,o=s.qt(i,t),r="http://www.w3.org/2000/svg"===t.namespaceURI;if("class"===e){const e=t;if(!s.Q.get(e)){const n=new Set,i=r?t.getAttribute("class")||"":t.className||"";if(i)for(const t of i.split(/\s+/))t&&n.add(t);s.Q.set(e,n)}}const c=s.a(t,e),f=s.Xt(()=>{const i=o();if("class"===e){const e=s.Q.get(t);if("string"==typeof i){const n=e&&e.size?[...e].join(" ")+(i?" "+i:""):i||"";r?n?t.setAttribute("class",n):t.removeAttribute("class"):t.className=n}else if(n(i)){const n=i.filter(Boolean),s=(e&&e.size?[...e,...n]:n).join(" ");r?s?t.setAttribute("class",s):t.removeAttribute("class"):t.className=s}else if(i&&"object"==typeof i){if(e&&e.size){const n=[...e].join(" ");r?n?t.setAttribute("class",n):t.removeAttribute("class"):t.className=n}const n=t;for(const t in i){const e=!!i[t];if(!t)continue;const s=t.split(/\s+/);for(let t=0;t<s.length;t++){const i=s[t];i&&n.classList?.toggle(i,e)}}}else if(null==i&&e&&e.size){const n=[...e].join(" ");r?n?t.setAttribute("class",n):t.removeAttribute("class"):t.className=n}else null==i&&t.removeAttribute("class");return}if(e===a){const e=t;if("string"==typeof i)return void(e.style.cssText=i);if(i&&"object"==typeof i){for(const t in i){const n=i[t],s=t.startsWith("--")?t:t.replace(/[A-Z]/g,t=>"-"+t.toLowerCase());null!=n?e.style.setProperty(s,String(n)):e.style.removeProperty(s)}return}return void(null==i&&e.removeAttribute("style"))}s.p(t,e,i,c)});s._(t,{type:"bind",expression:i,update:f})}ue(t){if(!t)return null;if(!t.parentElement){const e=t.ye;if(e&&e.parentElement)t=e;else{const e=t.pe;e&&(t=e)}}let e=t;for(;e;){const t=e.$e;if(t)return t;e=e.parentElement}const n={};for(e=t;e;){const t=this.q.get(e);if(t&&Object.assign(n,t),e===this.element)break;e=e.parentElement}return h(n).length?n:null}Se(t,e){if(o)for(const[n,i]of this.$)for(const s of i)if((t===n||n instanceof Element&&t.contains(n))&&s.update){if(b&&s.fe&&!e)continue;s.update()}}Me(t,e){const n=new RegExp("(^|[^$\\w])"+e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")+"([^$\\w]|$)");for(const[e,i]of this.$)if(t===e||e instanceof Element&&t.contains(e))for(const t of i){if(!t.update)continue;const e=t.expression||"";n.test(e)&&t.update()}}Ee(t){if(!o)return;const e=[];for(const[n,i]of this.$)if(t===n||n instanceof Element&&t.contains(n)){for(const t of i)if("custom"===t.type&&t.customDirective?.unbind)try{t.customDirective.unbind(n,this)}catch{}e.push(n)}if(e.length)for(const t of e)this.$.delete(t)}Jt(t,e){if(!o)return;const n=this,i=e.trim().match(/^(?:\(\s*([^,\s]+)\s*(?:,\s*([^\)]+))?\s*\)|([^,\s]+))\s+(in|of)\s+(.+)$/);if(!i)return;const s=i[1]||i[3],r=i[2],c=i[5],h=M("key"),a=t.getAttribute(h)||null;a&&t.removeAttribute(h);const p=g.createComment("x-for");let w;t.parentNode?.insertBefore(p,t),t[d]===y?(w=g.createElement("div"),w.style[u]=_,w.appendChild(t.content.cloneNode(1)),t.parentNode?.removeChild(t)):(w=t,t.parentNode?.removeChild(t));const m=p.parentElement||n.element,v=n.qt(c.trim(),m),b=a?n.at(a):null,x=M("for"),$=M("key"),S=M("text"),E=M("html"),O=M("data"),T=(t,e)=>{for(let i=0;i<e.length;i++){const s=e[i],o=this.Oe(t,s.path);if(s.forName){const t=o.getAttribute(s.forName)||"";n.Bt(o,s.forName,t);continue}for(let t=0;t<s.directiveNames.length;t++){const e=s.directiveNames[t],i=o.getAttribute(e)||"";e!==$&&n.Bt(o,e,i)}s.hasTextOrHtml||n.Ut(o)}},A=(t=>{const e=[],i=(t,s,o)=>{if(!o&&t.hasAttribute(O))return;const r="COMPONENT"===t[d],c=n.d(t,{skipRootFor:o}),f=c.names.filter(t=>t!==$&&(!o||t!==x)),l=c.names.includes(S)||c.names.includes(E),h=c.forName;if(f.length){if(h)return void e.push({path:s,directiveNames:[h],hasTextOrHtml:l,forName:h});e.push({path:s,directiveNames:f,hasTextOrHtml:l})}else l||e.push({path:s,directiveNames:[],hasTextOrHtml:l});if(r)return;let a=0,u=t.firstElementChild;for(;u;){const t=u.nextElementSibling;i(u,s.concat(a),0),a++,u=t}};return i(t,[],1),e})(w),R=[],k=(t,e,n)=>{const i=n||{};return i[s]=t,r&&(i[r]=e),i},F=new WeakMap;let D=0;const j=t=>{if(t&&"object"==typeof t){const e=(t=>{if(!t||"object"!=typeof t)return null;const e=t.id??t.n??t.key;if(null==e)return null;const n=typeof e;return"string"===n||"number"===n?"id:"+String(e):null})(t);if(e)return e;let n=F.get(t);return n||(n="o#"+ ++D,F.set(t,n)),n}return"p#"+typeof t+":"+String(t)},C=(t,e)=>{if(!b)return null;try{const i=n.lt(void 0,m),o=Object.create(i);o[s]=t,r&&(o[r]=e);const c=b.call(n.ct(),o),f=typeof c;return"string"===f||"number"===f?c:null!=c?String(c):null}catch{return null}},N={type:"for",expression:e},P=n.Xt(()=>{const t=n.it(()=>{const t=v();if(l(t))return{list:t,keys:null,src:t};const e=t&&Object.prototype.toString.call(t);if("undefined"!=typeof Map&&(t instanceof Map||"[object Map]"===e||t&&"function"==typeof t.get&&"function"==typeof t.set&&"function"==typeof t.keys))return{list:f(t.values()),keys:f(t.keys()),src:t};if("undefined"!=typeof Set&&(t instanceof Set||"[object Set]"===e||t&&"function"==typeof t.add&&"function"==typeof t.has&&"function"==typeof t.values))return{list:f(t.values()),keys:null,src:t};if(t&&"function"==typeof t[Symbol.iterator])return{list:f(t),keys:null,src:t};if(t&&"object"==typeof t){const e=Object.keys(t);return{list:e.map(e=>t[e]),keys:e,src:t}}return{list:[],keys:null,src:null}},{list:[],keys:null,src:null}),e=t.list,i=t.keys,s=new Map,o=new Map;for(let t=0;t<R.length;t++){const e=R[t],n=e.Te,i=e.Ae;if(i){let t=o.get(i);t||(t=[],o.set(i,t)),t.push(e)}else n&&s.set(n,e)}const c=new Array(e.length),u=p.parentNode;for(let t=0;t<e.length;t++){const f=e[t],l=i?i[t]:t;let u,p;const d=b?C(f,l):null;if(null!=d){p="k:"+String(d);const t=s.get(p);t&&(u=t,s.delete(p))}if(!u){const t=j(f);if(t&&t.startsWith("o#")||t&&t.startsWith("id:")){p=t;const e=s.get(t);e&&(u=e,s.delete(t))}else if(t&&t.startsWith("p#")){const e=t,n=o.get(e);n&&n.length&&(u=n.shift()),u&&(p=u.Te),u&&(u.Ae=e)}}if(u){const t=u.$e,e=u.Re,i=u.ke,s=k(f,l,t);u.$e=s,n.q.set(u,s);let o=0;i!==f&&(o=1,u.ke=f);const c=!!r&&e!==l;c&&(o=1,u.Re=l),o&&(c&&r?n.Me(u,r):n.Se(u))}else{const t=w.cloneNode(1);t.removeAttribute("x-for"),a&&t.removeAttribute(h);const e=k(f,l,{});t.$e=e,t.ke=f,r&&(t.Re=l),n.q.set(t,e);try{T(t,A)}catch{}try{n.framework.we(t,n)}catch{}u=t,u.Te=void 0!==p?p:"n#"+ ++D}p&&(u.Te=p);const y=a||f&&"object"==typeof f?void 0:"p#"+typeof f+":"+String(f);u.Ae=y,c[t]=u}for(const[,t]of s)t&&t.parentNode&&(n.Ee(t),t.parentNode.removeChild(t));for(const[,t]of o)for(const e of t)e&&e.parentNode&&(n.Ee(e),e.parentNode.removeChild(e));if(u){const t=new Map;for(let e=0;e<R.length;e++){const n=R[e].Te;void 0!==n&&t.set(n,e)}const e=new Array(c.length);for(let n=0;n<c.length;n++){const i=c[n].Te,s=t.has(i)?t.get(i):-1;e[n]=s}const{lisMask:n}=this.Fe(e),i=R.length?R[R.length-1].nextSibling:p.nextSibling;let s=null;for(let t=c.length-1;t>=0;t--){const o=c[t],r=s??i;-1===e[t]?u.insertBefore(o,r):n[t]||u.insertBefore(o,r),s=o}}R.length=0;for(let t=0;t<c.length;t++)R.push(c[t])},N);N.update=P,n._(p,N)}Oe(t,e){if(!o)return t;let n=t;for(let t=0;t<e.length;t++){let i=0,s=n.firstElementChild;for(;s&&i<e[t];)s=s.nextElementSibling,i++;n=s||n}return n}Fe(t){if(!o)return{lisMask:[],lisLen:0};const e=new Array(t.length),n=[],i=[];for(let s=0;s<t.length;s++){const o=t[s];if(o<0){e[s]=-1;continue}let r=0,c=n.length;for(;r<c;){const e=r+c>>1;t[n[e]]<o?r=e+1:c=e}r===n.length?n.push(s):n[r]=s,e[s]=r>0?n[r-1]:-1,i[r]=s}const s=n.length,r=new Array(t.length).fill(0);let c=s?n[s-1]:-1;for(;c>=0;)r[c]=1,c=e[c];return{lisMask:r,lisLen:s}}St(){const t=this;for(const e of t.$.values())for(const t of e)if((!b||!t.fe)&&t.update)try{t.update()}catch(t){ReferenceError}}}return E.u={itemscope:1,formnovalidate:1,novalidate:1,default:1,readonly:1},new class{constructor(){this.De=new Map,this.je=new i,this.Ce=[],this.Ne={},this.Pe=new Map,this.Ie=null,this.Le=new Map,this.Be=new i,this.Ue=0,this.ze=new Set,this.Ke="",this.qe=new Map,this.Xe=new i,this.He=new i,this.oe=(t,e)=>{const n=this.Xe.get(t);return n?.get(e)},this.ie=(t,e,n)=>{if(!o)return;let i=this.Xe.get(t);i||(i=new Map,this.Xe.set(t,i));let s=i.get(e);s||(s=new Set,i.set(e,s)),s.has(n)||(s.add(n),n instanceof Element!=0&&this.He.set(n,()=>{s.delete(n),0===s.size&&i.delete(e),0===i.size&&this.Xe.delete(t)}))},this.We=t=>{const e=this.He.get(t);e&&(e(),this.He.delete(t))},this.jt=t=>{this.Xe.delete(t)},this.directive=(t,e)=>{if(t.startsWith($+"-"))throw new Error(`Custom directive names should not start with "${$}-". Use: XTool.directive("my-directive", ...)`);return this.Pe.set(t,e),this},this.registerComponent=t=>{if(!t||!t.name)throw new Error("registerComponent requires a name");const e=t.name.toLowerCase();return this.Le.has(e)||this.Le.set(e,t),this},this.Ve=t=>this.Le.get(t.toLowerCase()),this.Yt=t=>this.Pe.get(t),this.me=()=>this.Ne,this.Ze=[],this.init=(t={})=>{const e={container:"body",debug:0,staticDirectives:1,router:{enabled:0,transitionName:"route"}};this.Ne={...e,...t,router:{...e.router,...t.router||{}}},"boolean"==typeof this.Ne.staticDirectives&&(b=this.Ne.staticDirectives);const n=this.Ne.prefix;$=n&&"string"==typeof n&&n[w]>0?n:"x",S.clear();const i=async()=>{if(this.Ge(),this.Ze.length)try{await Promise.allSettled(this.Ze)}catch{}this.Je();const t=g?.querySelector(this.Ne.container);t&&(this.Qe(t),this.Ne.delegate&&this.Ye(t),this._e()&&this.tn(t));try{this.Ke=this.en(location.href)}catch{}};return g&&"loading"===g.readyState?g.addEventListener("DOMContentLoaded",()=>{i()}):g&&"complete"!==g.readyState&&"interactive"!==g.readyState||i(),this},this.nn=new Map,this.in=new Map,this.loadComponents=t=>{const e=t.map(t=>"string"==typeof t?{path:t,mode:"preload",name:void 0}:{path:t.path,mode:t.mode||"preload",name:t.name}),n=[];for(const t of e)if("defer"===t.mode){const e=this.sn(t.path).catch(()=>{throw new Error("load failed")});this.Ze.push(e),n.push(e.then(()=>{}))}else if("lazy"===t.mode){const e=(t.name||t.path.split("/").pop()||"").replace(/\.(mjs|js|ts)(\?.*)?$/i,"").toLowerCase();e&&!this.in.has(e)&&this.in.set(e,{path:t.path,status:0})}else{const e=this.sn(t.path).catch(()=>{throw new Error("load failed")});n.push(e)}return Promise.allSettled(n).then(t=>{try{this.Je()}catch{}return{settled:t.length,failed:t.filter(t=>"rejected"===t.status).length}})},this.createComponent=t=>{const e=new E(this.on(),t,this);return this.De.set(e.id,e),e.callBeforeMount(),e},this.Je=()=>{const t=g?.querySelector(this.Ne.container);if(!t)return;const e=M("data");t.hasAttribute(e)&&!this.Ot(t)&&this.rn(t,void 0);const n=t.querySelectorAll(`[${e}]`);for(const t of n)this.Ot(t)||this.rn(t);const i=t.querySelectorAll("component[source]");for(const t of i)this.Ot(t)||this.cn(t);if(this.fn(),0===n[w]&&!this.Ot(t)){const e=f(this.De.values()),n=e[e[w]-1];n&&!n.isBound&&n.bindToElement(t)}},this.fn=()=>{if(!this.Ce[w])return;const t=[],e=[],n=this.Ne.container?g?.querySelector(this.Ne.container):null;for(const i of this.Ce){if(!i.el.isConnected){t.push(i);continue}let s,o=i.el.parentElement;for(;o&&!s;){const t=this.Ot(o);t?s=t:o=o.parentElement}s?(i.comp.attachToParent(s),e.push(i.comp)):n&&(n===i.el||n.contains(i.el))?e.push(i.comp):t.push(i)}for(const t of e)t.completeBinding();this.Ce=t},this.rn=(t,e)=>{const n=t.getAttribute(M("data"));let i={};if(n){t.removeAttribute(M("data"));try{if(e){let t={};if(e.ct)try{t=e.ct()}catch{}i=new Function("parent",`with(parent){ return (${n}) }`)(t)}else i=this.ln(n);const t=Object.getOwnPropertyDescriptors(i),s={},o={};for(const e in t){const n=t[e];"function"==typeof n.get?s[e]=n.get:"value"in n&&(o[e]=n.value)}const r=o.methods||i.methods,c=i.methods,f=r?{methods:c,data:o}:{data:o};h(s).length&&(f.computed=s),e&&(f.data.$parent=e),i=f}catch(t){}}const s=this.createComponent(i),o=t.getAttribute(M("init"))||void 0;o&&t.removeAttribute(M("init")),this.hn(t,s,{callBeforeMount:1,xInitExpr:o})},this.on=()=>{const t=Date.now(),e=Math.random().toString(36).substring(2,15);return`component_${t}_${(this.De.size+1).toString(36)}_${e}`},this.we=(t,e)=>{try{const n=[];"COMPONENT"===t[d]&&t.hasAttribute("source")&&n.push(t);const i=t.querySelectorAll("component[source]");for(const t of i)n.push(t);for(const t of n)this.Ot(t)||this.cn(t,e)}catch{}},this.ln=t=>{try{return new Function("return "+t.trim())()}catch{return{}}},this.Nt=t=>{this.De.delete(t)},this.an=()=>{},this.Tt=(t,e)=>{this.je.set(t,e)},this.Dt=t=>{try{this.je.delete(t)}catch{}}}_e(){const t=this.Ne;return!!t.router?.enabled}un(){const t=this.Ne;return t.router?.transitionName??"route"}pn(t){try{const e=new URL(t,g?.baseURI||location.href),n=new URL(location.href);return e.origin===n.origin}catch{return 0}}dn(t){try{const e="string"==typeof t?new URL(t,g?.baseURI||location.href):t,n=new URL(location.href);return e.origin===n.origin&&e.pathname===n.pathname&&e.search===n.search}catch{return 0}}en(t){const e="string"==typeof t?new URL(t,g?.baseURI||location.href):t;return`${e.origin}${e.pathname}${e.search}`}yn(t){try{if(!t||"#"===t)return 0;const e=decodeURIComponent(t.replace(/^#/,"")),n=g.getElementById(e)||g.querySelector(`[name="${CSS.escape(e)}"]`);if(n)return n.scrollIntoView({block:"start",behavior:"instant"}),1}catch{}return 0}tn(t){const e=this;if(t.addEventListener("click",n=>{const i=n;if(i.defaultPrevented||i.metaKey||i.ctrlKey||i.shiftKey||i.altKey)return;let s=i.target;for(;s&&s!==t&&"A"!==s.tagName;)s=s.parentElement;if(!s||"A"!==s.tagName||s.hasAttribute("download"))return;const o=s,r=o.getAttribute("href");if(!r||r.startsWith("#"))return;const c=o.getAttribute("target");if(c&&"_blank"===c.toLowerCase())return;if(!e.pn(r))return;const f=new URL(r,location.href);e.dn(f)||(i.preventDefault(),e.xe(f.toString(),1,"link").catch(()=>{location.assign(f.toString())}))}),this.Ne.router?.prefetchOnHover){const n=n=>{let i=n.target;for(;i&&i!==t&&"A"!==i.tagName;)i=i.parentElement;if(!i||"A"!==i.tagName||i.hasAttribute("download"))return;const s=i.getAttribute("href");s&&!s.startsWith("#")&&(t=>{try{if(!e.pn(t))return}catch{return}const n=new URL(t,location.href);if(e.dn(n))return;n.hash="";const i=n.toString();if(e.ze.has(i))return;const s=g?.head?.querySelector(`link[rel="prefetch"][href="${CSS.escape(i)}"]`);if(s)e.ze.add(i);else try{const t=g.createElement("link");t.setAttribute("rel","prefetch"),t.setAttribute("as","document"),t.setAttribute("href",i),g.head.appendChild(t),e.ze.add(i)}catch{}})(s)};t.addEventListener("mouseover",n,{passive:1}),t.addEventListener("touchstart",n,{passive:1})}window.addEventListener("popstate",()=>{e.xe(location.href,0,"popstate").catch(()=>{})})}async xe(t,e,n="program"){if(!this._e())return Promise.resolve();if(!this.pn(t))return void location.assign(t);const i=new URL(t),s=this.en(i);if("popstate"!==n){if(this.dn(i))return void(location.href=t)}else if(this.Ke&&s===this.Ke)return void this.yn(i.hash);const o=location.href;try{if(0==await(this.Ne.router?.before?.(t,o,{source:n})))return}catch(e){try{this.Ne.router?.error?.(e,t,o)}catch{}return}const c=this.Ke||this.en(o);this.qe.set(c,{x:window.scrollX||0,y:window.scrollY||0});try{const c=await this.wn(t);e&&history.pushState({},"",t),await this.mn(c),this.Ke=s,r(()=>{if("popstate"===n){const t=this.qe.get(s);t?window.scrollTo(t.x,t.y):this.yn(i.hash)||window.scrollTo(0,0)}else this.yn(i.hash)||window.scrollTo(0,0)});try{await(this.Ne.router?.after?.(t,o,{source:n}))}catch{}}catch(e){if(e&&("XToolRedirect"===e.name||"XToolRedirect"===e.message))return;r(()=>this.Ne.router?.error?.(e,t,o));try{location.assign(t)}catch{r(()=>location.href=t)}}}async wn(t){const e=await fetch(t,{credentials:"same-origin",cache:"default",redirect:"follow"});if(e.redirected){const t=e.url;try{location.assign(t)}catch{r(()=>location.href=t)}const n=new Error("XToolRedirect");throw n.name="XToolRedirect",n.url=t,n}if(!e.ok)throw new Error(e.status+" "+e.statusText);return await e.text()}async mn(t){const e=(new DOMParser).parseFromString(t,"text/html"),n=e.head,i=n?.querySelector("title"),s=()=>{if(i){const t=i.textContent||"";document.title!==t&&(document.title=t)}const t=this.Ne.container||"body",n=g.querySelector(t),s=e.querySelector(t);n&&s?this.vn(n,s):g.body.innerHTML=s?s.innerHTML:e.body.innerHTML,this.je.delete(n),this.Je();const o=g?.querySelector(this.Ne.container);o&&(this.Qe(o),this.Ne.delegate&&this.Ye(o))},o=document.startViewTransition?.bind(document);if(o&&this.me().router?.transitionName){const t=this.Ne.container||"body",e=g.querySelector(t),n=e&&e.style.getPropertyValue("view-transition-name")||"";r(()=>{e&&e.style.setProperty("view-transition-name",this.un())});try{const t=o(s);await t.finished}finally{try{e&&(n?e.style.setProperty("view-transition-name",n):e.style.removeProperty("view-transition-name"))}catch{}}}else s()}bn(t,e){const n=t.getAttributeNames();for(let i=0;i<n.length;i++){const s=n[i];e.hasAttribute(s)||t.removeAttribute(s)}const i=e.getAttributeNames();for(let n=0;n<i.length;n++){const s=i[n],o=e.getAttribute(s);t.getAttribute(s)!==o&&t.setAttribute(s,o)}}gn(t,e){const n=t.getAttributeNames(),i=e.getAttributeNames();if(n.length!==i.length)return 0;const s=new Map;for(let e=0;e<n.length;e++){const i=n[e];s.set(i,t.getAttribute(i))}for(let t=0;t<i.length;t++){const n=i[t];if(!s.has(n))return 0;if(s.get(n)!==e.getAttribute(n))return 0}return 1}_n(t){const e=t.tagName;return"IFRAME"===e&&t.hasAttribute("src")||"COMPONENT"===e&&t.hasAttribute("source")?1:0}vn(t,e){if(t.nodeName!==e.nodeName||this._n(e))return void t.replaceWith(e.cloneNode(1));if(this.bn(t,e),!t.firstChild&&!e.firstChild)return;const n=Array.from(t.childNodes),i=Array.from(e.childNodes),s=i.length;for(let e=0;e<s;e++){const s=i[e],o=n[e];if(o)if(s.nodeType===o.nodeType)if(3===s.nodeType){const t=o,e=s;t.data!==e.data&&(t.data=e.data)}else if(1===s.nodeType){const t=o,e=s;if(this._n(e))try{t.replaceWith(e.cloneNode(1))}catch{}else if(t.nodeName===e.nodeName&&this.gn(t,e))this.vn(t,e);else try{t.replaceWith(e.cloneNode(1))}catch{}}else try{o.replaceWith(s.cloneNode(1))}catch{}else try{o.replaceWith(s.cloneNode(1))}catch{}else t.appendChild(s.cloneNode(1))}if(n.length>s)for(let e=n.length-1;e>=s;e--){const n=t.childNodes[e];try{t.removeChild(n)}catch{}}}sn(e,n=2,i=300){const s=this.nn.get(e);if(s)return s;const o=this,r=/\.ts?$/.test(new URL(e,g?.baseURI||location.href).pathname),c=(t,...e)=>t.reduce((t,n,i)=>t+n+(i<e.length?e[i]:""),"")+"\n",f=s=>fetch(e,{cache:"no-cache"}).then(t=>{if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}).then(n=>{r&&(n=t(n));const i=n+`\n//# sourceURL=${e}`;try{new Function("XTool","html",i)(o,c)}catch(t){}}).catch(t=>{if(s>=n)throw t;const e=i*Math.pow(2,s);return new Promise(t=>setTimeout(t,e)).then(()=>f(s+1))}),l=f(0).finally(()=>{this.nn.delete(e)});return this.nn.set(e,l),l}Ge(){if(!g)return;if("x"===$)return;const t=`x-tool-initial-css-${$}`;if(g.head&&!g.getElementById(t)){const e=g.createElement(a);e.id=t,e.textContent=`[${$}-show],[${$}-if],[${$}-else],[${$}-else-if],[${$}\\:show],[${$}\\:if],[${$}\\:else],[${$}\\:else-if]{display:none;}`,g.head.appendChild(e)}}Qe(t){this.xn||"undefined"==typeof MutationObserver||(this.xn=new MutationObserver(t=>{for(const e of t)if("childList"===e.type){for(let t=0;t<e.addedNodes.length;t++){const n=e.addedNodes[t];if(1!==n.nodeType)continue;const i=n;"COMPONENT"===i[d]&&i.getAttribute(m)&&!this.Ot(i)&&this.cn(i)}for(let t=0;t<e.removedNodes.length;t++){const n=e.removedNodes[t];if(1!==n.nodeType)continue;const i=n;s(()=>{if(i.isConnected)return;this.We(i);const t=[i];for(;t.length;){const e=t.pop(),n=this.Ot(e);if(n&&!n.isDestroyed)try{this.jt(n),n.destroy()}catch{}let i=e.firstElementChild;for(;i;)t.push(i),i=i.nextElementSibling}})}}else if("attributes"===e.type){const t=e.target;if(t&&"COMPONENT"===t[d])if(e.attributeName===m)this.$n(t);else if(e.attributeName===v){const e=this.Ot(t);if(e)try{const n=t.hasAttribute(v);e.setFrozen(!!n)}catch{}}}this.fn()}),this.xn.observe(t,{childList:1,subtree:1,attributes:1,attributeFilter:[m,v]}))}Sn(t){if(!o)return null;if("undefined"==typeof IntersectionObserver)return null;this.Mn||(this.Mn=new Map),this.En||(this.En=new i);const e=t||"0px";let n=this.Mn.get(e);return n||(n=new IntersectionObserver(t=>{for(const e of t){const t=e.target,n=this.En.get(t);if(!n)continue;const i=!!e.isIntersecting,s=!!n.visible;if(n.visible=i,i&&!s){const t=n.enter||[];for(let n=0;n<t.length;n++)r(()=>t[n].cb(e,{phase:"enter",visible:i,before:s}));t.length&&(n.enter=t.filter(t=>!t.once))}else if(!i&&s){const t=n.leave||[];for(let n=0;n<t.length;n++)r(()=>t[n].cb(e,{phase:"leave",visible:i,before:s}));t.length&&(n.leave=t.filter(t=>!t.once))}}},{root:null,rootMargin:e}),this.Mn.set(e,n),n)}ce(t,e,n,s){if(!o)return()=>{};const c=this.Sn(e);if(!c)return()=>{};this.En||(this.En=new i);let f=this.En.get(t);return f||(f={rootMargin:e},this.En.set(t,f)),n&&n.cb&&(f.enter||(f.enter=[])).push({cb:n.cb,once:!!n.once}),s&&s.cb&&(f.leave||(f.leave=[])).push({cb:s.cb,once:!!s.once}),r(()=>c.observe(t)),()=>{r(()=>c.unobserve(t))}}$n(t){const e=c(t.getAttribute("source")),n=this.Ot(t);if(e){if(n&&!n.isDestroyed)try{n.destroy()}catch{}t.innerHTML="",this.cn(t)}else{if(n&&!n.isDestroyed)try{n.destroy()}catch{}t.innerHTML=""}}hn(t,e,n){e.element=t,n?.callBeforeMount&&r(()=>e.callBeforeMount()),this.Tt(e.element,e),this.Ce.push({el:t,comp:e}),n?.xInitExpr&&e.Rt(n.xInitExpr)}cn(t,n){const i=t.getAttribute("source");if(!i)return;let s=this.Ve(i);if(!s){const e=i.toLowerCase(),n=this.in?.get(e);return void(n&&(0===n.status&&(n.status=1,n.promise=this.sn(n.path).then(()=>{n.status=2}).catch(()=>{n.status=3})),n.promise?.then(()=>{r(()=>{this.Ve(i)&&this.cn(t)})})))}let o=n;if(!o){let e=t.parentElement;for(;e&&!o;){const t=this.Ot(e);t?o=t:e=e.parentElement}}let c=null,f=null,l=null;c||(c={});const h=t.getAttribute(M("prop")),a=M("prop")+":",u={},p=t=>{if(!t)return t;const n=t.toLowerCase();return(t=>{if(!t)return null;for(const e of Object.keys(t))if(e.toLowerCase()===n)return e;return null})(s?.propEffects)||(t.includes("-")?e(t):t)};for(const e of Array.from(t.attributes)){const n=e.name;if(n.startsWith(a)){const i=p(n.substring(a.length));i&&(u[i]=e.value),t.removeAttribute(n)}}if(h){if(l=h,o)try{f=new Function("ctx","with(ctx){return ("+h+")}")(o.getContext(1))}catch{f=null}else try{f=new Function("return ("+h+")")()}catch{f=null}if(f&&"object"==typeof f)for(const t in f)t in c||(c[t]=f[t]);t.removeAttribute(M("prop"))}if(Object.keys(u).length){const t={};for(const[e,n]of Object.entries(u)){let i;if(o)try{i=new Function("ctx","with(ctx){return ("+n+")}")(o.getContext(1))}catch{i=void 0}else try{i=new Function("return ("+n+")")()}catch{i=void 0}t[e]=i,e in c||(c[e]=String(i))}const e=f?{...f}:{};f={...e};for(const n in t)n in e||(f[n]=t[n]);const n=Object.keys(t).filter(t=>!(t in e));if(n.length)if(l&&/}\s*$/.test(l.trim())){const t=l.trim(),e=t.lastIndexOf("}");if(e>-1){const i=t.slice(0,e),s=/{\s*$/.test(i)?0:1,o=n.map(t=>`${t}: ${u[t]}`).join(", ");l=i+(s?", ":" ")+o+"}"}}else l="{ "+n.map(t=>`${t}: ${u[t]}`).join(", ")+" }";else if(!l){const t=Object.keys(u);t.length&&(l="{ "+t.map(t=>`${t}: ${u[t]}`).join(", ")+" }")}}let d,y={};if(s.makeData&&r(()=>{const t=s.makeData(c);t&&(y=t)}),s.data)for(const t in s.data)y[t]=s.data[t];if(f&&"object"==typeof f)for(const t in f)y[t]=f[t];else for(const t in c)y[t]=c[t];if(y.$props=c,"function"==typeof s.init)try{const t=s.init(c);d=t&&"object"==typeof t?t:void 0}catch{d=void 0}const w={data:y,methods:{...s.methods||{},...d?.methods||{}},computed:{...s.computed||{},...d?.computed||{}},propEffects:{...s.propEffects||{},...d?.propEffects||{}},mounted:d?.mounted||s.mounted,unmounted:d?.unmounted||s.unmounted,beforeMount:d?.beforeMount||s.beforeMount,beforeUnmount:d?.beforeUnmount||s.beforeUnmount,updated:d?.updated||s.updated,destroyed:d?.destroyed||s.destroyed,beforeDestroy:d?.beforeDestroy||s.beforeDestroy},m=this.createComponent(w),v=Array.from(t.childNodes);if(v.length&&t.replaceChildren(),s.template){const e=e=>{t.innerHTML=e;const n=t.querySelectorAll("slot");if(n.length)for(const t of n){const e=t.getAttribute("name"),n=e?v.filter(t=>1===t.nodeType&&t.getAttribute("slot")===e):v.filter(t=>1!==t.nodeType||!t.hasAttribute("slot"));n.length&&t.replaceWith(...n)}},n=s.template;if("string"==typeof n)e(n);else if("function"==typeof n)try{const i=n();i&&"function"==typeof i.then?(t.innerHTML="",i.then(t=>{e(t||""),r(()=>m.Mt())})):e(String(i||""))}catch{t.innerHTML=""}else n&&"function"==typeof n.then&&(t.innerHTML="",n.then(t=>{e(t||""),r(()=>m.Mt())}))}else v.length&&t.append(...v);this.hn(t,m,{callBeforeMount:0});try{const e=t.querySelectorAll(`[${M("data")}]`);for(const t of e)this.Ot(t)||this.rn(t,m)}catch{}try{this.we(t,m)}catch{}l&&o&&r(()=>m.Pt(l,o)),this.fn()}Ot(t){return this.je.get(t)}observe(t){}Ye(t){if(this.Ue)return;const e=t,n=t=>{let n=t.target;for(;n&&n!==e.parentElement&&!t.cancelBubble;){const e=this.Be.get(n);if(e){const n=e.get(t.type);if(n&&n.length)for(const e of[...n])try{if(e.comp&&e.comp.isDestroyed){const t=n.indexOf(e);t>-1&&n.splice(t,1);continue}if((!e.filter||e.filter(t))&&(e.run(t),e.once)){const t=n.indexOf(e);t>-1&&n.splice(t,1)}}catch{}}n=n.parentElement}},i=["keydown","keyup"],s=["click","input","change"];for(const t of i)e.addEventListener(t,n,1);for(const t of s)e.addEventListener(t,n,0);this.Ue=1}ve(t,e,n){let i=this.Be.get(t);i||(i=new Map,this.Be.set(t,i));let s=i.get(e);return s||(s=[],i.set(e,s)),s.push(n),()=>{try{const i=this.Be.get(t),s=i?.get(e);if(!s)return;const o=s.indexOf(n);o>-1&&s.splice(o,1)}catch{}}}}}();if("undefined"!=typeof window){const t=window;t.XTool=r,t.FyneJS=r}